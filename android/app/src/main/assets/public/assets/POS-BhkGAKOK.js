const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/items-jQwjfGOh.js","assets/firebase-vendor-Xl_GeJX1.js","assets/index-CKK7GlfE.js","assets/ui-vendor-xs3J0kw7.js","assets/react-vendor-BVrHFBWf.js","assets/capacitor-vendor-Be0kW8mJ.js","assets/router-vendor-DDng8bu2.js","assets/utils-vendor-DglL0U6P.js","assets/index-CXWmK9jD.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,a=(e,t)=>{for(var r in t||(t={}))i.call(t,r)&&o(e,r,t[r]);if(n)for(var r of n(t))s.call(t,r)&&o(e,r,t[r]);return e},l=(e,n)=>t(e,r(n)),c=(e,t,r)=>new Promise((n,i)=>{var s=e=>{try{a(r.next(e))}catch(Re){i(Re)}},o=e=>{try{a(r.throw(e))}catch(Re){i(Re)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,o);a((r=r.apply(e,t)).next())});import{j as d,m as h,K as u,N as f,Z as g,O as m,h as p,k as w,b as A,S as C,Q as y,c as E,P as _,V as S,W as I,e as N,Y as T,_ as b,$ as x,X as D,a0 as M,a1 as R,a2 as v,a3 as O,a4 as P,a5 as B,a6 as L,a7 as k,a8 as j,D as F,J as U,T as H,a9 as V,aa as z,ab as G,p as Y,ac as W,ad as X,ae as Z,B as Q}from"./ui-vendor-xs3J0kw7.js";import{r as q,d as K,g as $}from"./react-vendor-BVrHFBWf.js";import{_ as J}from"./capacitor-vendor-Be0kW8mJ.js";import{u as ee,f as te}from"./utils-vendor-DglL0U6P.js";import{f as re}from"./notifications-tOheaLyS.js";import{b as ne,d as ie,m as se,q as oe,r as ae,w as le,n as ce,t as de,T as he,v as ue,s as fe}from"./firebase-vendor-Xl_GeJX1.js";import{d as ge,b as me,a as pe}from"./index-CKK7GlfE.js";import{g as we,a as Ae}from"./enhancedItems-BBwCbrpj.js";import{A as Ce}from"./AnimatedCard-D-urSkxU.js";import{R as ye,B as Ee,C as _e,X as Se,Y as Ie,T as Ne,a as Te,P as be,c as xe,d as De}from"./chart-vendor-BwNApLFi.js";import"./router-vendor-DDng8bu2.js";function Me(e,t){for(var r=0;r<t.length;r++){const n=t[r];if("string"!=typeof n&&!Array.isArray(n))for(const t in n)if("default"!==t&&!(t in e)){const r=Object.getOwnPropertyDescriptor(n,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:()=>n[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var Re,ve={exports:{}};"undefined"!=typeof self&&self;var Oe,Pe,Be=ve.exports=(Re=q,function(){var e={155:function(e){e.exports=Re}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};r.r(n),r.d(n,{useReactToPrint:function(){return f}});var i=r(155);function s({level:e="error",messages:t,suppressErrors:r=!1}){}function o(e,t){if(t||!e){const e=document.getElementById("printWindow");e&&document.body.removeChild(e)}}function a(e){return e instanceof Error?e:new Error("Unknown Error")}function l(e,t){const{documentTitle:r,onAfterPrint:n,onPrintError:i,preserveAfterPrint:l,print:c,suppressErrors:d}=t;setTimeout(()=>{var t,h;if(e.contentWindow){let u=function(){null==n||n(),o(l)};if(e.contentWindow.focus(),c)c(e).then(u).catch(e=>{i?i("print",a(e)):s({messages:["An error was thrown by the specified `print` function"],suppressErrors:d})});else{if(e.contentWindow.print){const n=null!==(h=null===(t=e.contentDocument)||void 0===t?void 0:t.title)&&void 0!==h?h:"",i=e.ownerDocument.title;r&&(e.ownerDocument.title=r,e.contentDocument&&(e.contentDocument.title=r)),e.contentWindow.print(),r&&(e.ownerDocument.title=i,e.contentDocument&&(e.contentDocument.title=n))}else s({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:d});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(e=>{var t,r;return(null!==(r=null!==(t=navigator.userAgent)&&void 0!==t?t:navigator.vendor)&&void 0!==r?r:"opera"in window&&window.opera).match(e)})?setTimeout(u,500):u()}}else s({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:d})},500)}function c(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null);let n=r.nextNode();for(;n;)t.push(n),n=r.nextNode();return t}function d(e,t,r){const n=c(e),i=c(t);if(n.length===i.length)for(let s=0;s<n.length;s++){const e=n[s],t=i[s],o=e.shadowRoot;if(null!==o){const e=t.attachShadow({mode:o.mode});e.innerHTML=o.innerHTML,d(o,e,r)}}else s({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",e,t],suppressErrors:r})}const h='\n    @page {\n        /* Remove browser default header (title) and footer (url) */\n        margin: 0;\n    }\n    @media print {\n        body {\n            /* Tell browsers to print background colors */\n            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */\n            print-color-adjust: exact; /* Firefox/Safari */\n            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */\n        }\n    }\n';function u(e,t,r,n){var i,o,c,u,f;const{contentNode:g,clonedContentNode:m,clonedImgNodes:p,clonedVideoNodes:w,numResourcesToLoad:A,originalCanvasNodes:C}=r,{bodyClass:y,fonts:E,ignoreGlobalStyles:_,pageStyle:S,nonce:I,suppressErrors:N,copyShadowRoots:T}=n;e.onload=null;const b=null!==(i=e.contentDocument)&&void 0!==i?i:null===(o=e.contentWindow)||void 0===o?void 0:o.document;if(b){const r=b.body.appendChild(m);T&&d(g,r,!!N),E&&((null===(c=e.contentDocument)||void 0===c?void 0:c.fonts)&&(null===(u=e.contentWindow)||void 0===u?void 0:u.FontFace)?E.forEach(r=>{const n=new FontFace(r.family,r.source,{weight:r.weight,style:r.style});e.contentDocument.fonts.add(n),n.loaded.then(()=>{t(n)}).catch(e=>{t(n,["Failed loading the font:",n,"Load error:",a(e)])})}):(E.forEach(e=>{t(e)}),s({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:N})));const n=null!=S?S:h,i=b.createElement("style");I&&(i.setAttribute("nonce",I),b.head.setAttribute("nonce",I)),i.appendChild(b.createTextNode(n)),b.head.appendChild(i),y&&b.body.classList.add(...y.split(" "));const o=b.querySelectorAll("canvas");for(let e=0;e<C.length;++e){const t=C[e],r=o[e];if(void 0===r){s({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",t],suppressErrors:N});continue}const n=r.getContext("2d");n&&n.drawImage(t,0,0)}for(let e=0;e<p.length;e++){const r=p[e],n=r.getAttribute("src");if(n){const e=new Image;e.onload=()=>{t(r)},e.onerror=(e,n,i,s,o)=>{t(r,["Error loading <img>",r,"Error",o])},e.src=n}else t(r,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',r])}for(let e=0;e<w.length;e++){const r=w[e];r.preload="auto";const n=r.getAttribute("poster");if(n){const e=new Image;e.onload=()=>{t(r)},e.onerror=(e,i,s,o,a)=>{t(r,["Error loading video poster",n,"for video",r,"Error:",a])},e.src=n}else r.readyState>=2?t(r):r.src?(r.onloadeddata=()=>{t(r)},r.onerror=(e,n,i,s,o)=>{t(r,["Error loading video",r,"Error",o])},r.onstalled=()=>{t(r,["Loading video stalled, skipping",r])}):t(r,["Error loading video, `src` is empty",r])}const l="select",A=g.querySelectorAll(l),D=b.querySelectorAll(l);for(let e=0;e<A.length;e++)D[e].value=A[e].value;if(!_){const e=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let r=0,n=e.length;r<n;++r){const n=e[r];if("style"===n.tagName.toLowerCase()){const e=b.createElement(n.tagName),t=n.sheet;if(t){let i="";try{const e=t.cssRules.length;for(let r=0;r<e;++r)"string"==typeof t.cssRules[r].cssText&&(i+=`${t.cssRules[r].cssText}\r\n`)}catch(x){s({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",n,`Original error: ${a(x).message}`],level:"warning"})}e.setAttribute("id",`react-to-print-${r}`),I&&e.setAttribute("nonce",I),e.appendChild(b.createTextNode(i)),b.head.appendChild(e)}}else if(n.getAttribute("href"))if(n.hasAttribute("disabled"))s({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",n],level:"warning"}),t(n);else{const e=b.createElement(n.tagName);for(let t=0,r=n.attributes.length;t<r;++t){const r=n.attributes[t];r&&e.setAttribute(r.nodeName,null!==(f=r.nodeValue)&&void 0!==f?f:"")}e.onload=()=>{t(e)},e.onerror=(r,n,i,s,o)=>{t(e,["Failed to load",e,"Error:",o])},I&&e.setAttribute("nonce",I),b.head.appendChild(e)}else s({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",n],level:"warning"}),t(n)}}}0===A&&l(e,n)}function f({bodyClass:e,contentRef:t,copyShadowRoots:r,documentTitle:n,fonts:c,ignoreGlobalStyles:d,nonce:h,onAfterPrint:f,onBeforePrint:g,onPrintError:m,pageStyle:p,preserveAfterPrint:w,print:A,suppressErrors:C}){return(0,i.useCallback)(i=>{function y(){const o={bodyClass:e,contentRef:t,copyShadowRoots:r,documentTitle:n,fonts:c,ignoreGlobalStyles:d,nonce:h,onAfterPrint:f,onPrintError:m,pageStyle:p,preserveAfterPrint:w,print:A,suppressErrors:C},a=function(){const e=document.createElement("iframe");return e.width=`${document.documentElement.clientWidth}px`,e.height=`${document.documentElement.clientHeight}px`,e.style.position="absolute",e.style.top=`-${document.documentElement.clientHeight+100}px`,e.style.left=`-${document.documentElement.clientWidth+100}px`,e.id="printWindow",e.srcdoc="<!DOCTYPE html>",e}(),g=function(e,t){const{contentRef:r,fonts:n,ignoreGlobalStyles:i,suppressErrors:o}=t,a=function({contentRef:e,optionalContent:t,suppressErrors:r}){return t&&"function"==typeof t?(e&&s({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),t()):e?e.current:void s({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:r})}({contentRef:r,optionalContent:e,suppressErrors:o});if(!a)return;const l=a.cloneNode(!0),c=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),d=l.querySelectorAll("img"),h=l.querySelectorAll("video"),u=n?n.length:0;return{contentNode:a,clonedContentNode:l,clonedImgNodes:d,clonedVideoNodes:h,numResourcesToLoad:(i?0:c.length)+d.length+h.length+u,originalCanvasNodes:a.querySelectorAll("canvas")}}(i,o);if(!g)return void s({messages:["There is nothing to print"],suppressErrors:C});const y=function(e,t,r){const{suppressErrors:n}=e,i=[],o=[];return function(a,c){i.includes(a)?s({level:"debug",messages:["Tried to mark a resource that has already been handled",a],suppressErrors:n}):(c?(s({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...c],suppressErrors:n}),o.push(a)):i.push(a),i.length+o.length===t&&l(r,e))}}(o,g.numResourcesToLoad,a);var E,_,S,I;_=y,S=g,I=o,(E=a).onload=()=>{u(E,_,S,I)},document.body.appendChild(E)}o(w,!0),g?g().then(()=>{y()}).catch(e=>{null==m||m("onBeforePrint",a(e))}):y()},[e,t,r,n,c,d,h,f,g,m,p,w,A,C])}return n}());(Pe=Oe||(Oe={}))[Pe.QR_CODE=0]="QR_CODE",Pe[Pe.AZTEC=1]="AZTEC",Pe[Pe.CODABAR=2]="CODABAR",Pe[Pe.CODE_39=3]="CODE_39",Pe[Pe.CODE_93=4]="CODE_93",Pe[Pe.CODE_128=5]="CODE_128",Pe[Pe.DATA_MATRIX=6]="DATA_MATRIX",Pe[Pe.MAXICODE=7]="MAXICODE",Pe[Pe.ITF=8]="ITF",Pe[Pe.EAN_13=9]="EAN_13",Pe[Pe.EAN_8=10]="EAN_8",Pe[Pe.PDF_417=11]="PDF_417",Pe[Pe.RSS_14=12]="RSS_14",Pe[Pe.RSS_EXPANDED=13]="RSS_EXPANDED",Pe[Pe.UPC_A=14]="UPC_A",Pe[Pe.UPC_E=15]="UPC_E",Pe[Pe.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var Le,ke,je,Fe,Ue=new Map([[Oe.QR_CODE,"QR_CODE"],[Oe.AZTEC,"AZTEC"],[Oe.CODABAR,"CODABAR"],[Oe.CODE_39,"CODE_39"],[Oe.CODE_93,"CODE_93"],[Oe.CODE_128,"CODE_128"],[Oe.DATA_MATRIX,"DATA_MATRIX"],[Oe.MAXICODE,"MAXICODE"],[Oe.ITF,"ITF"],[Oe.EAN_13,"EAN_13"],[Oe.EAN_8,"EAN_8"],[Oe.PDF_417,"PDF_417"],[Oe.RSS_14,"RSS_14"],[Oe.RSS_EXPANDED,"RSS_EXPANDED"],[Oe.UPC_A,"UPC_A"],[Oe.UPC_E,"UPC_E"],[Oe.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]);function He(e){return Object.values(Oe).includes(e)}(ke=Le||(Le={}))[ke.UNKNOWN=0]="UNKNOWN",ke[ke.URL=1]="URL",(Fe=je||(je={}))[Fe.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",Fe[Fe.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE";var Ve,ze,Ge=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[je.SCAN_TYPE_CAMERA,je.SCAN_TYPE_FILE],e}(),Ye=function(){function e(e,t){this.format=e,this.formatName=t}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!Ue.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,Ue.get(t))},e}(),We=function(){function e(){}return e.createFromText=function(e){return{decodedText:e,result:{text:e}}},e.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},e}();(ze=Ve||(Ve={}))[ze.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",ze[ze.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",ze[ze.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR";var Xe=function(){function e(){}return e.createFrom=function(e){return{errorMessage:e,type:Ve.UNKWOWN_ERROR}},e}(),Ze=function(){function e(e){this.verbose=e}return e.prototype.log=function(e){this.verbose},e.prototype.warn=function(e){this.verbose},e.prototype.logError=function(e,t){this.verbose},e.prototype.logErrors=function(e){if(0===e.length)throw"Logger#logError called without arguments";this.verbose},e}();function Qe(e){return null==e}var qe=function(){function e(){}return e.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},e.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),Ke=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(e){return"Last Match: ".concat(e)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.torchOnButton=function(){return"Switch On Torch"},e.torchOffButton=function(){return"Switch Off Torch"},e.torchOnFailedMessage=function(){return"Failed to turn on torch"},e.torchOffFailedMessage=function(){return"Failed to turn off torch"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),$e=function(){function e(){}return e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"},e}(),Je=function(){function e(){}return e.isMediaStreamConstraintsValid=function(e,t){if("object"!=typeof e){var r=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var n=new Set(["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"]),i=0,s=Object.keys(e);i<s.length;i++){var o=s[i];if(n.has(o))return t.logError("".concat(o," is not supported videoConstaints."),!0),!1}return!0},e}(),et={exports:{}};!function(e){function t(e){return null==e}var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};function n(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e,t){var r=Object.setPrototypeOf;r?r(e,t):e.__proto__=t}function s(e,t){void 0===t&&(t=e.constructor);var r=Error.captureStackTrace;r&&r(e,t)}var o,a,l=function(e){function t(t){var r=this.constructor,n=e.call(this,t)||this;return Object.defineProperty(n,"name",{value:r.name,enumerable:!1}),i(n,r.prototype),s(n),n}return n(t,e),t}(Error);class c extends l{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}c.kind="Exception";class d extends c{}d.kind="ArgumentException";class h extends c{}h.kind="IllegalArgumentException";class u{constructor(e){if(this.binarizer=e,null===e)throw new h("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,r,n){const i=this.binarizer.getLuminanceSource().crop(e,t,r,n);return new u(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new u(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new u(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch(Re){return""}}}class f extends c{static getChecksumInstance(){return new f}}f.kind="ChecksumException";class g{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class m{static arraycopy(e,t,r,n,i){for(;i--;)r[n++]=e[t++]}static currentTimeMillis(){return Date.now()}}class p extends c{}p.kind="IndexOutOfBoundsException";class w extends p{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}w.kind="ArrayIndexOutOfBoundsException";class A{static fill(e,t){for(let r=0,n=e.length;r<n;r++)e[r]=t}static fillWithin(e,t,r,n){A.rangeCheck(e.length,t,r);for(let i=t;i<r;i++)e[i]=n}static rangeCheck(e,t,r){if(t>r)throw new h("fromIndex("+t+") > toIndex("+r+")");if(t<0)throw new w(t);if(r>e)throw new w(r)}static asList(...e){return e}static create(e,t,r){return Array.from({length:e}).map(e=>Array.from({length:t}).fill(r))}static createInt32Array(e,t,r){return Array.from({length:e}).map(e=>Int32Array.from({length:t}).fill(r))}static equals(e,t){if(!e)return!1;if(!t)return!1;if(!e.length)return!1;if(!t.length)return!1;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}static hashCode(e){if(null===e)return 0;let t=1;for(const r of e)t=31*t+r;return t}static fillUint8Array(e,t){for(let r=0;r!==e.length;r++)e[r]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const r=new Uint8Array(t);return r.set(e),r}return e.slice(0,t)}static copyOfRange(e,t,r){const n=r-t,i=new Int32Array(n);return m.arraycopy(e,t,i,0,n),i}static binarySearch(e,t,r){void 0===r&&(r=A.numberComparator);let n=0,i=e.length-1;for(;n<=i;){const s=i+n>>1,o=r(t,e[s]);if(o>0)n=s+1;else{if(!(o<0))return s;i=s-1}}return-n-1}static numberComparator(e,t){return e-t}}class C{static numberOfTrailingZeros(e){let t;if(0===e)return 32;let r=31;return t=e<<16,0!==t&&(r-=16,e=t),t=e<<8,0!==t&&(r-=8,e=t),t=e<<4,0!==t&&(r-=4,e=t),t=e<<2,0!==t&&(r-=2,e=t),r-(e<<1>>>31)}static numberOfLeadingZeros(e){if(0===e)return 32;let t=1;return e>>>16==0&&(t+=16,e<<=16),e>>>24==0&&(t+=8,e<<=8),e>>>28==0&&(t+=4,e<<=4),e>>>30==0&&(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135,e+=e>>>8,63&(e+=e>>>16)}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}C.MIN_VALUE_32_BITS=-2147483648,C.MAX_VALUE=Number.MAX_SAFE_INTEGER;class y{constructor(e,t){void 0===e?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=null==t?y.makeArray(e):t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>32*this.bits.length){const t=y.makeArray(e);m.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return!!(this.bits[Math.floor(e/32)]&1<<(31&e))}set(e){this.bits[Math.floor(e/32)]|=1<<(31&e)}flip(e){this.bits[Math.floor(e/32)]^=1<<(31&e)}getNextSet(e){const t=this.size;if(e>=t)return t;const r=this.bits;let n=Math.floor(e/32),i=r[n];i&=~((1<<(31&e))-1);const s=r.length;for(;0===i;){if(++n===s)return t;i=r[n]}const o=32*n+C.numberOfTrailingZeros(i);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const r=this.bits;let n=Math.floor(e/32),i=~r[n];i&=~((1<<(31&e))-1);const s=r.length;for(;0===i;){if(++n===s)return t;i=~r[n]}const o=32*n+C.numberOfTrailingZeros(i);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new h;if(t===e)return;t--;const r=Math.floor(e/32),n=Math.floor(t/32),i=this.bits;for(let s=r;s<=n;s++){const o=(2<<(s<n?31:31&t))-(1<<(s>r?0:31&e));i[s]|=o}}clear(){const e=this.bits.length,t=this.bits;for(let r=0;r<e;r++)t[r]=0}isRange(e,t,r){if(t<e||e<0||t>this.size)throw new h;if(t===e)return!0;t--;const n=Math.floor(e/32),i=Math.floor(t/32),s=this.bits;for(let o=n;o<=i;o++){const a=(2<<(o<i?31:31&t))-(1<<(o>n?0:31&e))&4294967295;if((s[o]&a)!==(r?a:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(e,t){if(t<0||t>32)throw new h("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let r=t;r>0;r--)this.appendBit(1==(e>>r-1&1))}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let r=0;r<t;r++)this.appendBit(e.get(r))}xor(e){if(this.size!==e.size)throw new h("Sizes don't match");const t=this.bits;for(let r=0,n=t.length;r<n;r++)t[r]^=e.bits[r]}toBytes(e,t,r,n){for(let i=0;i<n;i++){let n=0;for(let t=0;t<8;t++)this.get(e)&&(n|=1<<7-t),e++;t[r+i]=n}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),r=t+1,n=this.bits;for(let i=0;i<r;i++){let r=n[i];r=r>>1&1431655765|(1431655765&r)<<1,r=r>>2&858993459|(858993459&r)<<2,r=r>>4&252645135|(252645135&r)<<4,r=r>>8&16711935|(16711935&r)<<8,r=r>>16&65535|(65535&r)<<16,e[t-i]=r}if(this.size!==32*r){const t=32*r-this.size;let n=e[0]>>>t;for(let i=1;i<r;i++){const r=e[i];n|=r<<32-t,e[i-1]=n,n=r>>>t}e[r-1]=n}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof y))return!1;const t=e;return this.size===t.size&&A.equals(this.bits,t.bits)}hashCode(){return 31*this.size+A.hashCode(this.bits)}toString(){let e="";for(let t=0,r=this.size;t<r;t++)7&t||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new y(this.size,this.bits.slice())}}(a=o||(o={}))[a.OTHER=0]="OTHER",a[a.PURE_BARCODE=1]="PURE_BARCODE",a[a.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",a[a.TRY_HARDER=3]="TRY_HARDER",a[a.CHARACTER_SET=4]="CHARACTER_SET",a[a.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",a[a.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",a[a.ASSUME_GS1=7]="ASSUME_GS1",a[a.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",a[a.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",a[a.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS";var E,_,S=o;class I extends c{static getFormatInstance(){return new I}}I.kind="FormatException",(_=E||(E={}))[_.Cp437=0]="Cp437",_[_.ISO8859_1=1]="ISO8859_1",_[_.ISO8859_2=2]="ISO8859_2",_[_.ISO8859_3=3]="ISO8859_3",_[_.ISO8859_4=4]="ISO8859_4",_[_.ISO8859_5=5]="ISO8859_5",_[_.ISO8859_6=6]="ISO8859_6",_[_.ISO8859_7=7]="ISO8859_7",_[_.ISO8859_8=8]="ISO8859_8",_[_.ISO8859_9=9]="ISO8859_9",_[_.ISO8859_10=10]="ISO8859_10",_[_.ISO8859_11=11]="ISO8859_11",_[_.ISO8859_13=12]="ISO8859_13",_[_.ISO8859_14=13]="ISO8859_14",_[_.ISO8859_15=14]="ISO8859_15",_[_.ISO8859_16=15]="ISO8859_16",_[_.SJIS=16]="SJIS",_[_.Cp1250=17]="Cp1250",_[_.Cp1251=18]="Cp1251",_[_.Cp1252=19]="Cp1252",_[_.Cp1256=20]="Cp1256",_[_.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",_[_.UTF8=22]="UTF8",_[_.ASCII=23]="ASCII",_[_.Big5=24]="Big5",_[_.GB18030=25]="GB18030",_[_.EUC_KR=26]="EUC_KR";class N{constructor(e,t,r,...n){this.valueIdentifier=e,this.name=r,this.values="number"==typeof t?Int32Array.from([t]):t,this.otherEncodingNames=n,N.VALUE_IDENTIFIER_TO_ECI.set(e,this),N.NAME_TO_ECI.set(r,this);const i=this.values;for(let s=0,o=i.length;s!==o;s++){const e=i[s];N.VALUES_TO_ECI.set(e,this)}for(const s of n)N.NAME_TO_ECI.set(s,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new I("incorect value");const t=N.VALUES_TO_ECI.get(e);if(void 0===t)throw new I("incorect value");return t}static getCharacterSetECIByName(e){const t=N.NAME_TO_ECI.get(e);if(void 0===t)throw new I("incorect value");return t}equals(e){if(!(e instanceof N))return!1;const t=e;return this.getName()===t.getName()}}N.VALUE_IDENTIFIER_TO_ECI=new Map,N.VALUES_TO_ECI=new Map,N.NAME_TO_ECI=new Map,N.Cp437=new N(E.Cp437,Int32Array.from([0,2]),"Cp437"),N.ISO8859_1=new N(E.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),N.ISO8859_2=new N(E.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),N.ISO8859_3=new N(E.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),N.ISO8859_4=new N(E.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),N.ISO8859_5=new N(E.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),N.ISO8859_6=new N(E.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),N.ISO8859_7=new N(E.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),N.ISO8859_8=new N(E.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),N.ISO8859_9=new N(E.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),N.ISO8859_10=new N(E.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),N.ISO8859_11=new N(E.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),N.ISO8859_13=new N(E.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),N.ISO8859_14=new N(E.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),N.ISO8859_15=new N(E.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),N.ISO8859_16=new N(E.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),N.SJIS=new N(E.SJIS,20,"SJIS","Shift_JIS"),N.Cp1250=new N(E.Cp1250,21,"Cp1250","windows-1250"),N.Cp1251=new N(E.Cp1251,22,"Cp1251","windows-1251"),N.Cp1252=new N(E.Cp1252,23,"Cp1252","windows-1252"),N.Cp1256=new N(E.Cp1256,24,"Cp1256","windows-1256"),N.UnicodeBigUnmarked=new N(E.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),N.UTF8=new N(E.UTF8,26,"UTF8","UTF-8"),N.ASCII=new N(E.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),N.Big5=new N(E.Big5,28,"Big5"),N.GB18030=new N(E.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),N.EUC_KR=new N(E.EUC_KR,30,"EUC_KR","EUC-KR");class T extends c{}T.kind="UnsupportedOperationException";class b{static decode(e,t){const r=this.encodingName(t);return this.customDecoder?this.customDecoder(e,r):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(r)?this.decodeFallback(e,r):new TextDecoder(r).decode(e)}static shouldDecodeOnFallback(e){return!b.isBrowser()&&"ISO-8859-1"===e}static encode(e,t){const r=this.encodingName(t);return this.customEncoder?this.customEncoder(e,r):"undefined"==typeof TextEncoder?this.encodeFallback(e):(new TextEncoder).encode(e)}static isBrowser(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(e){return"string"==typeof e?e:e.getName()}static encodingCharacterSet(e){return e instanceof N?e:N.getCharacterSetECIByName(e)}static decodeFallback(e,t){const r=this.encodingCharacterSet(t);if(b.isDecodeFallbackSupported(r)){let t="";for(let r=0,n=e.length;r<n;r++){let n=e[r].toString(16);n.length<2&&(n="0"+n),t+="%"+n}return decodeURIComponent(t)}if(r.equals(N.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new T(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(N.UTF8)||e.equals(N.ISO8859_1)||e.equals(N.ASCII)}static encodeFallback(e){const t=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let n=0;n<t.length;n++)r.push(t[n].charCodeAt(0));return new Uint8Array(r)}}class x{static castAsNonUtf8Char(e,t=null){const r=t?t.getName():this.ISO88591;return b.decode(new Uint8Array([e]),r)}static guessEncoding(e,t){if(null!=t&&void 0!==t.get(S.CHARACTER_SET))return t.get(S.CHARACTER_SET).toString();const r=e.length;let n=!0,i=!0,s=!0,o=0,a=0,l=0,c=0,d=0,h=0,u=0,f=0,g=0,m=0,p=0;const w=e.length>3&&239===e[0]&&187===e[1]&&191===e[2];for(let A=0;A<r&&(n||i||s);A++){const t=255&e[A];s&&(o>0?128&t?o--:s=!1:128&t&&(64&t?(o++,32&t?(o++,16&t?(o++,8&t?s=!1:c++):l++):a++):s=!1)),n&&(t>127&&t<160?n=!1:t>159&&(t<192||215===t||247===t)&&p++),i&&(d>0?t<64||127===t||t>252?i=!1:d--:128===t||160===t||t>239?i=!1:t>160&&t<224?(h++,f=0,u++,u>g&&(g=u)):t>127?(d++,u=0,f++,f>m&&(m=f)):(u=0,f=0))}return s&&o>0&&(s=!1),i&&d>0&&(i=!1),s&&(w||a+l+c>0)?x.UTF8:i&&(x.ASSUME_SHIFT_JIS||g>=3||m>=3)?x.SHIFT_JIS:n&&i?2===g&&2===h||10*p>=r?x.SHIFT_JIS:x.ISO88591:n?x.ISO88591:i?x.SHIFT_JIS:s?x.UTF8:x.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let r=-1;function n(e,n,i,s,o,a){if("%%"===e)return"%";if(void 0===t[++r])return;e=s?parseInt(s.substr(1)):void 0;let l,c=o?parseInt(o.substr(1)):void 0;switch(a){case"s":l=t[r];break;case"c":l=t[r][0];break;case"f":l=parseFloat(t[r]).toFixed(e);break;case"p":l=parseFloat(t[r]).toPrecision(e);break;case"e":l=parseFloat(t[r]).toExponential(e);break;case"x":l=parseInt(t[r]).toString(c||16);break;case"d":l=parseFloat(parseInt(t[r],c||10).toPrecision(e)).toFixed(0)}l="object"==typeof l?JSON.stringify(l):(+l).toString(c);let d=parseInt(i),h=i&&i[0]+""=="0"?"0":" ";for(;l.length<d;)l=void 0!==n?l+h:h+l;return l}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,n)}static getBytes(e,t){return b.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}x.SHIFT_JIS=N.SJIS.getName(),x.GB2312="GB2312",x.ISO88591=N.ISO8859_1.getName(),x.EUC_JP="EUC_JP",x.UTF8=N.UTF8.getName(),x.PLATFORM_DEFAULT_ENCODING=x.UTF8,x.ASSUME_SHIFT_JIS=!1;class D{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return"string"==typeof e?this.value+=e.toString():this.encoding?this.value+=x.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,r){for(let n=t;t<t+r;n++)this.append(e[n]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class M{constructor(e,t,r,n){if(this.width=e,this.height=t,this.rowSize=r,this.bits=n,null==t&&(t=e),this.height=t,e<1||t<1)throw new h("Both dimensions must be greater than 0");null==r&&(r=Math.floor((e+31)/32)),this.rowSize=r,null==n&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,r=e[0].length,n=new M(r,t);for(let i=0;i<t;i++){const t=e[i];for(let e=0;e<r;e++)t[e]&&n.set(e,i)}return n}static parseFromString(e,t,r){if(null===e)throw new h("stringRepresentation cannot be null");const n=new Array(e.length);let i=0,s=0,o=-1,a=0,l=0;for(;l<e.length;)if("\n"===e.charAt(l)||"\r"===e.charAt(l)){if(i>s){if(-1===o)o=i-s;else if(i-s!==o)throw new h("row lengths do not match");s=i,a++}l++}else if(e.substring(l,l+t.length)===t)l+=t.length,n[i]=!0,i++;else{if(e.substring(l,l+r.length)!==r)throw new h("illegal character encountered: "+e.substring(l));l+=r.length,n[i]=!1,i++}if(i>s){if(-1===o)o=i-s;else if(i-s!==o)throw new h("row lengths do not match");a++}const c=new M(o,a);for(let d=0;d<i;d++)n[d]&&c.set(Math.floor(d%o),Math.floor(d/o));return c}get(e,t){const r=t*this.rowSize+Math.floor(e/32);return!!(this.bits[r]>>>(31&e)&1)}set(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]|=1<<(31&e)&4294967295}unset(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]&=~(1<<(31&e)&4294967295)}flip(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]^=1<<(31&e)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new h("input matrix dimensions do not match");const t=new y(Math.floor(this.width/32)+1),r=this.rowSize,n=this.bits;for(let i=0,s=this.height;i<s;i++){const s=i*r,o=e.getRow(i,t).getBitArray();for(let e=0;e<r;e++)n[s+e]^=o[e]}}clear(){const e=this.bits,t=e.length;for(let r=0;r<t;r++)e[r]=0}setRegion(e,t,r,n){if(t<0||e<0)throw new h("Left and top must be nonnegative");if(n<1||r<1)throw new h("Height and width must be at least 1");const i=e+r,s=t+n;if(s>this.height||i>this.width)throw new h("The region must fit inside the matrix");const o=this.rowSize,a=this.bits;for(let l=t;l<s;l++){const t=l*o;for(let r=e;r<i;r++)a[t+Math.floor(r/32)]|=1<<(31&r)&4294967295}}getRow(e,t){null==t||t.getSize()<this.width?t=new y(this.width):t.clear();const r=this.rowSize,n=this.bits,i=e*r;for(let s=0;s<r;s++)t.setBulk(32*s,n[i+s]);return t}setRow(e,t){m.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let r=new y(e),n=new y(e);for(let i=0,s=Math.floor((t+1)/2);i<s;i++)r=this.getRow(i,r),n=this.getRow(t-1-i,n),r.reverse(),n.reverse(),this.setRow(i,n),this.setRow(t-1-i,r)}getEnclosingRectangle(){const e=this.width,t=this.height,r=this.rowSize,n=this.bits;let i=e,s=t,o=-1,a=-1;for(let l=0;l<t;l++)for(let e=0;e<r;e++){const t=n[l*r+e];if(0!==t){if(l<s&&(s=l),l>a&&(a=l),32*e<i){let r=0;for(;!(t<<31-r&4294967295);)r++;32*e+r<i&&(i=32*e+r)}if(32*e+31>o){let r=31;for(;t>>>r===0;)r--;32*e+r>o&&(o=32*e+r)}}}return o<i||a<s?null:Int32Array.from([i,s,o-i+1,a-s+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let r=0;for(;r<t.length&&0===t[r];)r++;if(r===t.length)return null;const n=r/e;let i=r%e*32;const s=t[r];let o=0;for(;!(s<<31-o&4294967295);)o++;return i+=o,Int32Array.from([i,n])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let r=t.length-1;for(;r>=0&&0===t[r];)r--;if(r<0)return null;const n=Math.floor(r/e);let i=32*Math.floor(r%e);const s=t[r];let o=31;for(;s>>>o===0;)o--;return i+=o,Int32Array.from([i,n])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof M))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&A.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+A.hashCode(this.bits),e}toString(e="X ",t="  ",r="\n"){return this.buildToString(e,t,r)}buildToString(e,t,r){let n=new D;for(let i=0,s=this.height;i<s;i++){for(let r=0,s=this.width;r<s;r++)n.append(this.get(r,i)?e:t);n.append(r)}return n.toString()}clone(){return new M(this.width,this.height,this.rowSize,this.bits.slice())}}class R extends c{static getNotFoundInstance(){return new R}}R.kind="NotFoundException";class v extends g{constructor(e){super(e),this.luminances=v.EMPTY,this.buckets=new Int32Array(v.LUMINANCE_BUCKETS)}getBlackRow(e,t){const r=this.getLuminanceSource(),n=r.getWidth();null==t||t.getSize()<n?t=new y(n):t.clear(),this.initArrays(n);const i=r.getRow(e,this.luminances),s=this.buckets;for(let a=0;a<n;a++)s[(255&i[a])>>v.LUMINANCE_SHIFT]++;const o=v.estimateBlackPoint(s);if(n<3)for(let a=0;a<n;a++)(255&i[a])<o&&t.set(a);else{let e=255&i[0],r=255&i[1];for(let s=1;s<n-1;s++){const n=255&i[s+1];(4*r-e-n)/2<o&&t.set(s),e=r,r=n}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight(),n=new M(t,r);this.initArrays(t);const i=this.buckets;for(let a=1;a<5;a++){const n=Math.floor(r*a/5),s=e.getRow(n,this.luminances),o=Math.floor(4*t/5);for(let e=Math.floor(t/5);e<o;e++)i[(255&s[e])>>v.LUMINANCE_SHIFT]++}const s=v.estimateBlackPoint(i),o=e.getMatrix();for(let a=0;a<r;a++){const e=a*t;for(let r=0;r<t;r++)(255&o[e+r])<s&&n.set(r,a)}return n}createBinarizer(e){return new v(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let r=0;r<v.LUMINANCE_BUCKETS;r++)t[r]=0}static estimateBlackPoint(e){const t=e.length;let r=0,n=0,i=0;for(let c=0;c<t;c++)e[c]>i&&(n=c,i=e[c]),e[c]>r&&(r=e[c]);let s=0,o=0;for(let c=0;c<t;c++){const t=c-n,r=e[c]*t*t;r>o&&(s=c,o=r)}if(n>s){const e=n;n=s,s=e}if(s-n<=t/16)throw new R;let a=s-1,l=-1;for(let c=s-1;c>n;c--){const t=c-n,i=t*t*(s-c)*(r-e[c]);i>l&&(a=c,l=i)}return a<<v.LUMINANCE_SHIFT}}v.LUMINANCE_BITS=5,v.LUMINANCE_SHIFT=8-v.LUMINANCE_BITS,v.LUMINANCE_BUCKETS=1<<v.LUMINANCE_BITS,v.EMPTY=Uint8ClampedArray.from([0]);class O extends v{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight();if(t>=O.MINIMUM_DIMENSION&&r>=O.MINIMUM_DIMENSION){const n=e.getMatrix();let i=t>>O.BLOCK_SIZE_POWER;0!==(t&O.BLOCK_SIZE_MASK)&&i++;let s=r>>O.BLOCK_SIZE_POWER;0!==(r&O.BLOCK_SIZE_MASK)&&s++;const o=O.calculateBlackPoints(n,i,s,t,r),a=new M(t,r);O.calculateThresholdForBlock(n,i,s,t,r,o,a),this.matrix=a}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new O(e)}static calculateThresholdForBlock(e,t,r,n,i,s,o){const a=i-O.BLOCK_SIZE,l=n-O.BLOCK_SIZE;for(let c=0;c<r;c++){let i=c<<O.BLOCK_SIZE_POWER;i>a&&(i=a);const d=O.cap(c,2,r-3);for(let r=0;r<t;r++){let a=r<<O.BLOCK_SIZE_POWER;a>l&&(a=l);const c=O.cap(r,2,t-3);let h=0;for(let e=-2;e<=2;e++){const t=s[d+e];h+=t[c-2]+t[c-1]+t[c]+t[c+1]+t[c+2]}const u=h/25;O.thresholdBlock(e,a,i,u,n,o)}}}static cap(e,t,r){return e<t?t:e>r?r:e}static thresholdBlock(e,t,r,n,i,s){for(let o=0,a=r*i+t;o<O.BLOCK_SIZE;o++,a+=i)for(let i=0;i<O.BLOCK_SIZE;i++)(255&e[a+i])<=n&&s.set(t+i,r+o)}static calculateBlackPoints(e,t,r,n,i){const s=i-O.BLOCK_SIZE,o=n-O.BLOCK_SIZE,a=new Array(r);for(let l=0;l<r;l++){a[l]=new Int32Array(t);let r=l<<O.BLOCK_SIZE_POWER;r>s&&(r=s);for(let i=0;i<t;i++){let t=i<<O.BLOCK_SIZE_POWER;t>o&&(t=o);let s=0,c=255,d=0;for(let i=0,o=r*n+t;i<O.BLOCK_SIZE;i++,o+=n){for(let t=0;t<O.BLOCK_SIZE;t++){const r=255&e[o+t];s+=r,r<c&&(c=r),r>d&&(d=r)}if(d-c>O.MIN_DYNAMIC_RANGE)for(i++,o+=n;i<O.BLOCK_SIZE;i++,o+=n)for(let t=0;t<O.BLOCK_SIZE;t++)s+=255&e[o+t]}let h=s>>2*O.BLOCK_SIZE_POWER;if(d-c<=O.MIN_DYNAMIC_RANGE&&(h=c/2,l>0&&i>0)){const e=(a[l-1][i]+2*a[l][i-1]+a[l-1][i-1])/4;c<e&&(h=e)}a[l][i]=h}}return a}}O.BLOCK_SIZE_POWER=3,O.BLOCK_SIZE=1<<O.BLOCK_SIZE_POWER,O.BLOCK_SIZE_MASK=O.BLOCK_SIZE-1,O.MINIMUM_DIMENSION=5*O.BLOCK_SIZE,O.MIN_DYNAMIC_RANGE=24;class P{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,r,n){throw new T("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new T("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new T("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new D;for(let r=0;r<this.height;r++){const n=this.getRow(r,e);for(let e=0;e<this.width;e++){const r=255&n[e];let i;i=r<64?"#":r<128?"+":r<192?".":" ",t.append(i)}t.append("\n")}return t.toString()}}class B extends P{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const r=this.delegate.getRow(e,t),n=this.getWidth();for(let i=0;i<n;i++)r[i]=255-(255&r[i]);return r}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(t);for(let n=0;n<t;n++)r[n]=255-(255&e[n]);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,r,n){return new B(this.delegate.crop(e,t,r,n))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new B(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new B(this.delegate.rotateCounterClockwise45())}}class L extends P{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=L.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return L.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,r){const n=new Uint8ClampedArray(t*r);for(let i=0,s=0,o=e.length;i<o;i+=4,s++){let t;t=0===e[i+3]?255:306*e[i]+601*e[i+1]+117*e[i+2]+512>>10,n[s]=t}return n}getRow(e,t){if(e<0||e>=this.getHeight())throw new h("Requested row is outside the image: "+e);const r=this.getWidth(),n=e*r;return null===t?t=this.buffer.slice(n,n+r):(t.length<r&&(t=new Uint8ClampedArray(r)),t.set(this.buffer.slice(n,n+r))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,r,n){return super.crop(e,t,r,n),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),r=t.getContext("2d"),n=e*L.DEGREE_TO_RADIANS,i=this.canvas.width,s=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(n))*i+Math.abs(Math.sin(n))*s),a=Math.ceil(Math.abs(Math.sin(n))*i+Math.abs(Math.cos(n))*s);return t.width=o,t.height=a,r.translate(o/2,a/2),r.rotate(n),r.drawImage(this.canvas,i/-2,s/-2),this.buffer=L.makeBufferFromCanvasImageData(t),this}invert(){return new B(this)}}L.DEGREE_TO_RADIANS=Math.PI/180;class k{constructor(e,t,r){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var j,F,U=(globalThis||globalThis||self||window?(globalThis||globalThis||self||window||void 0).__awaiter:void 0)||function(e,t,r,n){function i(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){e.done?r(e.value):i(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})};class H{constructor(e,t=500,r){this.reader=e,this.timeBetweenScansMillis=t,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!=typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return U(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const r of e){const e="video"===r.kind?"videoinput":r.kind;if("videoinput"!==e)continue;const n={deviceId:r.deviceId||r.id,label:r.label||`Video device ${t.length+1}`,kind:e,groupId:r.groupId};t.push(n)}return t})}getVideoInputDevices(){return U(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(e=>new k(e.deviceId,e.label))})}findDeviceById(e){return U(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(t=>t.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return U(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return U(this,void 0,void 0,function*(){let r;this.reset(),r=e?{deviceId:{exact:e}}:{facingMode:"environment"};const n={video:r};return yield this.decodeOnceFromConstraints(n,t)})}decodeOnceFromConstraints(e,t){return U(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(r,t)})}decodeOnceFromStream(e,t){return U(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(r)})}decodeFromInputVideoDeviceContinuously(e,t,r){return U(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,r)})}decodeFromVideoDevice(e,t,r){return U(this,void 0,void 0,function*(){let n;n=e?{deviceId:{exact:e}}:{facingMode:"environment"};const i={video:n};return yield this.decodeFromConstraints(i,t,r)})}decodeFromConstraints(e,t,r){return U(this,void 0,void 0,function*(){const n=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(n,t,r)})}decodeFromStream(e,t,r){return U(this,void 0,void 0,function*(){this.reset();const n=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(n,r)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return U(this,void 0,void 0,function*(){const r=this.prepareVideoElement(t);return this.addVideoSource(r,e),this.videoElement=r,this.stream=e,yield this.playVideoOnLoadAsync(r),r})}playVideoOnLoadAsync(e){return new Promise((t,r)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return U(this,void 0,void 0,function*(){if(!this.isVideoPlaying(e))try{yield e.play()}catch(t){}})}getMediaElement(e,t){const r=document.getElementById(e);if(!r)throw new d(`element with id '${e}' not found`);if(r.nodeName.toLowerCase()!==t.toLowerCase())throw new d(`element with id '${e}' must be an ${t} element`);return r}decodeFromImage(e,t){if(!e&&!t)throw new d("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new d("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,r){if(void 0===e&&void 0===t)throw new d("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,r):this.decodeFromVideoElementContinuously(e,r)}decodeFromImageElement(e){if(!e)throw new d("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);let r;return this.imageElement=t,r=this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t),r}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(r,t)}_decodeFromVideoElementSetup(e){if(!e)throw new d("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new d("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const r=this._decodeOnLoadImage(t);return t.src=e,r}decodeFromVideoUrl(e){if(!e)throw new d("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),r=this.decodeFromVideoElement(t);return t.src=e,r}decodeFromVideoUrlContinuously(e,t){if(!e)throw new d("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),n=this.decodeFromVideoElementContinuously(r,t);return r.src=e,n}_decodeOnLoadImage(e){return new Promise((t,r)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,r),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return U(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return U(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!!e.complete&&0!==e.naturalWidth}prepareImageElement(e){let t;return void 0===e&&(t=document.createElement("img"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return e||"undefined"==typeof document||(t=document.createElement("video"),t.width=200,t.height=200),"string"==typeof e&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,r=!0){this._stopAsyncDecode=!1;const n=(i,s)=>{if(this._stopAsyncDecode)return s(new R("Video stream has ended before any code could be detected.")),void(this._stopAsyncDecode=void 0);try{i(this.decode(e))}catch(Re){if(t&&Re instanceof R||(Re instanceof f||Re instanceof I)&&r)return setTimeout(n,this._timeBetweenDecodingAttempts,i,s);s(Re)}};return new Promise((e,t)=>n(e,t))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const r=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{const n=this.decode(e);t(n,null),setTimeout(r,this.timeBetweenScansMillis)}catch(Re){t(null,Re),(Re instanceof f||Re instanceof I||Re instanceof R)&&setTimeout(r,this._timeBetweenDecodingAttempts)}};r()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return 0!==e.videoWidth}drawFrameOnCanvas(e,t,r){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),r||(r=this.captureCanvasContext),r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,r=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),r||(r=this.captureCanvasContext),r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),r=new L(t),n=new O(r);return new u(n)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const t=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=t}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if("undefined"==typeof document)return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let r,n;return void 0!==e&&(e instanceof HTMLVideoElement?(r=e.videoWidth,n=e.videoHeight):e instanceof HTMLImageElement&&(r=e.naturalWidth||e.width,n=e.naturalHeight||e.height)),t.style.width=r+"px",t.style.height=n+"px",t.width=r,t.height=n,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch(r){e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch(t){e.src=""}this.videoElement.removeAttribute("src")}}class V{constructor(e,t,r=(null==t?0:8*t.length),n,i,s=m.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=r,this.resultPoints=n,this.format=i,this.timestamp=s,this.text=e,this.rawBytes=t,this.numBits=null==r?null==t?0:8*t.length:r,this.resultPoints=n,this.format=i,this.resultMetadata=null,this.timestamp=null==s?m.currentTimeMillis():s}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){null!==e&&(null===this.resultMetadata?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(null===t)this.resultPoints=e;else if(null!==e&&e.length>0){const r=new Array(t.length+e.length);m.arraycopy(t,0,r,0,t.length),m.arraycopy(e,0,r,t.length,e.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}(F=j||(j={}))[F.AZTEC=0]="AZTEC",F[F.CODABAR=1]="CODABAR",F[F.CODE_39=2]="CODE_39",F[F.CODE_93=3]="CODE_93",F[F.CODE_128=4]="CODE_128",F[F.DATA_MATRIX=5]="DATA_MATRIX",F[F.EAN_8=6]="EAN_8",F[F.EAN_13=7]="EAN_13",F[F.ITF=8]="ITF",F[F.MAXICODE=9]="MAXICODE",F[F.PDF_417=10]="PDF_417",F[F.QR_CODE=11]="QR_CODE",F[F.RSS_14=12]="RSS_14",F[F.RSS_EXPANDED=13]="RSS_EXPANDED",F[F.UPC_A=14]="UPC_A",F[F.UPC_E=15]="UPC_E",F[F.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION";var z,G,Y=j;(G=z||(z={}))[G.OTHER=0]="OTHER",G[G.ORIENTATION=1]="ORIENTATION",G[G.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",G[G.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",G[G.ISSUE_NUMBER=4]="ISSUE_NUMBER",G[G.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",G[G.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",G[G.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",G[G.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",G[G.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",G[G.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY";var W,X,Z,Q,q,K,$,J,ee,te,re,ne=z;class ie{constructor(e,t,r,n,i=-1,s=-1){this.rawBytes=e,this.text=t,this.byteSegments=r,this.ecLevel=n,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=s,this.numBits=null==e?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class se{exp(e){return this.expTable[e]}log(e){if(0===e)throw new h;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class oe{constructor(e,t){if(0===t.length)throw new h;this.field=e;const r=t.length;if(r>1&&0===t[0]){let e=1;for(;e<r&&0===t[e];)e++;e===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-e),m.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);const t=this.coefficients;let r;if(1===e){r=0;for(let e=0,n=t.length;e!==n;e++){const n=t[e];r=se.addOrSubtract(r,n)}return r}r=t[0];const n=t.length,i=this.field;for(let s=1;s<n;s++)r=se.addOrSubtract(i.multiply(e,r),t[s]);return r}addOrSubtract(e){if(!this.field.equals(e.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){const e=t;t=r,r=e}let n=new Int32Array(r.length);const i=r.length-t.length;m.arraycopy(r,0,n,0,i);for(let s=i;s<r.length;s++)n[s]=se.addOrSubtract(t[s-i],r[s]);return new oe(this.field,n)}multiply(e){if(!this.field.equals(e.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,r=t.length,n=e.coefficients,i=n.length,s=new Int32Array(r+i-1),o=this.field;for(let a=0;a<r;a++){const e=t[a];for(let t=0;t<i;t++)s[a+t]=se.addOrSubtract(s[a+t],o.multiply(e,n[t]))}return new oe(o,s)}multiplyScalar(e){if(0===e)return this.field.getZero();if(1===e)return this;const t=this.coefficients.length,r=this.field,n=new Int32Array(t),i=this.coefficients;for(let s=0;s<t;s++)n[s]=r.multiply(i[s],e);return new oe(r,n)}multiplyByMonomial(e,t){if(e<0)throw new h;if(0===t)return this.field.getZero();const r=this.coefficients,n=r.length,i=new Int32Array(n+e),s=this.field;for(let o=0;o<n;o++)i[o]=s.multiply(r[o],t);return new oe(s,i)}divide(e){if(!this.field.equals(e.field))throw new h("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new h("Divide by 0");const t=this.field;let r=t.getZero(),n=this;const i=e.getCoefficient(e.getDegree()),s=t.inverse(i);for(;n.getDegree()>=e.getDegree()&&!n.isZero();){const i=n.getDegree()-e.getDegree(),o=t.multiply(n.getCoefficient(n.getDegree()),s),a=e.multiplyByMonomial(i,o),l=t.buildMonomial(i,o);r=r.addOrSubtract(l),n=n.addOrSubtract(a)}return[r,n]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);if(0!==r){if(r<0?(e+=" - ",r=-r):e.length>0&&(e+=" + "),0===t||1!==r){const t=this.field.log(r);0===t?e+="1":1===t?e+="a":(e+="a^",e+=t)}0!==t&&(1===t?e+="x":(e+="x^",e+=t))}}return e}}class ae extends c{}ae.kind="ArithmeticException";class le extends se{constructor(e,t,r){super(),this.primitive=e,this.size=t,this.generatorBase=r;const n=new Int32Array(t);let i=1;for(let o=0;o<t;o++)n[o]=i,i*=2,i>=t&&(i^=e,i&=t-1);this.expTable=n;const s=new Int32Array(t);for(let o=0;o<t-1;o++)s[n[o]]=o;this.logTable=s,this.zero=new oe(this,Int32Array.from([0])),this.one=new oe(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new h;if(0===t)return this.zero;const r=new Int32Array(e+1);return r[0]=t,new oe(this,r)}inverse(e){if(0===e)throw new ae;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+C.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}le.AZTEC_DATA_12=new le(4201,4096,1),le.AZTEC_DATA_10=new le(1033,1024,1),le.AZTEC_DATA_6=new le(67,64,1),le.AZTEC_PARAM=new le(19,16,1),le.QR_CODE_FIELD_256=new le(285,256,0),le.DATA_MATRIX_FIELD_256=new le(301,256,1),le.AZTEC_DATA_8=le.DATA_MATRIX_FIELD_256,le.MAXICODE_FIELD_64=le.AZTEC_DATA_6;class ce extends c{}ce.kind="ReedSolomonException";class de extends c{}de.kind="IllegalStateException";class he{constructor(e){this.field=e}decode(e,t){const r=this.field,n=new oe(r,e),i=new Int32Array(t);let s=!0;for(let u=0;u<t;u++){const e=n.evaluateAt(r.exp(u+r.getGeneratorBase()));i[i.length-1-u]=e,0!==e&&(s=!1)}if(s)return;const o=new oe(r,i),a=this.runEuclideanAlgorithm(r.buildMonomial(t,1),o,t),l=a[0],c=a[1],d=this.findErrorLocations(l),h=this.findErrorMagnitudes(c,d);for(let u=0;u<d.length;u++){const t=e.length-1-r.log(d[u]);if(t<0)throw new ce("Bad error location");e[t]=le.addOrSubtract(e[t],h[u])}}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){const r=e;e=t,t=r}const n=this.field;let i=e,s=t,o=n.getZero(),a=n.getOne();for(;s.getDegree()>=(r/2|0);){let e=i,t=o;if(i=s,o=a,i.isZero())throw new ce("r_{i-1} was zero");s=e;let r=n.getZero();const l=i.getCoefficient(i.getDegree()),c=n.inverse(l);for(;s.getDegree()>=i.getDegree()&&!s.isZero();){const e=s.getDegree()-i.getDegree(),t=n.multiply(s.getCoefficient(s.getDegree()),c);r=r.addOrSubtract(n.buildMonomial(e,t)),s=s.addOrSubtract(i.multiplyByMonomial(e,t))}if(a=r.multiply(o).addOrSubtract(t),s.getDegree()>=i.getDegree())throw new de("Division algorithm failed to reduce polynomial?")}const l=a.getCoefficient(0);if(0===l)throw new ce("sigmaTilde(0) was zero");const c=n.inverse(l);return[a.multiplyScalar(c),s.multiplyScalar(c)]}findErrorLocations(e){const t=e.getDegree();if(1===t)return Int32Array.from([e.getCoefficient(1)]);const r=new Int32Array(t);let n=0;const i=this.field;for(let s=1;s<i.getSize()&&n<t;s++)0===e.evaluateAt(s)&&(r[n]=i.inverse(s),n++);if(n!==t)throw new ce("Error locator degree does not match number of roots");return r}findErrorMagnitudes(e,t){const r=t.length,n=new Int32Array(r),i=this.field;for(let s=0;s<r;s++){const o=i.inverse(t[s]);let a=1;for(let e=0;e<r;e++)if(s!==e){const r=i.multiply(t[e],o),n=1&r?-2&r:1|r;a=i.multiply(a,n)}n[s]=i.multiply(e.evaluateAt(o),i.inverse(a)),0!==i.getGeneratorBase()&&(n[s]=i.multiply(n[s],o))}return n}}($=W||(W={}))[$.UPPER=0]="UPPER",$[$.LOWER=1]="LOWER",$[$.MIXED=2]="MIXED",$[$.DIGIT=3]="DIGIT",$[$.PUNCT=4]="PUNCT",$[$.BINARY=5]="BINARY";class ue{decode(e){this.ddata=e;let t=e.getBits(),r=this.extractBits(t),n=this.correctBits(r),i=ue.convertBoolArrayToByteArray(n),s=ue.getEncodedData(n),o=new ie(i,s,null,null);return o.setNumBits(n.length),o}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,r=W.UPPER,n=W.UPPER,i="",s=0;for(;s<t;)if(n===W.BINARY){if(t-s<5)break;let o=ue.readCode(e,s,5);if(s+=5,0===o){if(t-s<11)break;o=ue.readCode(e,s,11)+31,s+=11}for(let r=0;r<o;r++){if(t-s<8){s=t;break}const r=ue.readCode(e,s,8);i+=x.castAsNonUtf8Char(r),s+=8}n=r}else{let o=n===W.DIGIT?4:5;if(t-s<o)break;let a=ue.readCode(e,s,o);s+=o;let l=ue.getCharacter(n,a);l.startsWith("CTRL_")?(r=n,n=ue.getTable(l.charAt(5)),"L"===l.charAt(6)&&(r=n)):(i+=l,n=r)}return i}static getTable(e){switch(e){case"L":return W.LOWER;case"P":return W.PUNCT;case"M":return W.MIXED;case"D":return W.DIGIT;case"B":return W.BINARY;default:return W.UPPER}}static getCharacter(e,t){switch(e){case W.UPPER:return ue.UPPER_TABLE[t];case W.LOWER:return ue.LOWER_TABLE[t];case W.MIXED:return ue.MIXED_TABLE[t];case W.PUNCT:return ue.PUNCT_TABLE[t];case W.DIGIT:return ue.DIGIT_TABLE[t];default:throw new de("Bad table")}}correctBits(e){let t,r;this.ddata.getNbLayers()<=2?(r=6,t=le.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,t=le.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,t=le.AZTEC_DATA_10):(r=12,t=le.AZTEC_DATA_12);let n=this.ddata.getNbDatablocks(),i=e.length/r;if(i<n)throw new I;let s=e.length%r,o=new Int32Array(i);for(let u=0;u<i;u++,s+=r)o[u]=ue.readCode(e,s,r);try{new he(t).decode(o,i-n)}catch(h){throw new I(h)}let a=(1<<r)-1,l=0;for(let u=0;u<n;u++){let e=o[u];if(0===e||e===a)throw new I;1!==e&&e!==a-1||l++}let c=new Array(n*r-l),d=0;for(let u=0;u<n;u++){let e=o[u];if(1===e||e===a-1)c.fill(e>1,d,d+r-1),d+=r-1;else for(let t=r-1;t>=0;--t)c[d++]=!!(e&1<<t)}return c}extractBits(e){let t=this.ddata.isCompact(),r=this.ddata.getNbLayers(),n=(t?11:14)+4*r,i=new Int32Array(n),s=new Array(this.totalBitsInLayer(r,t));if(t)for(let o=0;o<i.length;o++)i[o]=o;else{let e=n+1+2*C.truncDivision(C.truncDivision(n,2)-1,15),t=n/2,r=C.truncDivision(e,2);for(let n=0;n<t;n++){let e=n+C.truncDivision(n,15);i[t-n-1]=r-e-1,i[t+n]=r+e+1}}for(let o=0,a=0;o<r;o++){let l=4*(r-o)+(t?9:12),c=2*o,d=n-1-c;for(let t=0;t<l;t++){let r=2*t;for(let n=0;n<2;n++)s[a+r+n]=e.get(i[c+n],i[c+t]),s[a+2*l+r+n]=e.get(i[c+t],i[d-n]),s[a+4*l+r+n]=e.get(i[d-n],i[d-t]),s[a+6*l+r+n]=e.get(i[d-t],i[c+n])}a+=8*l}return s}static readCode(e,t,r){let n=0;for(let i=t;i<t+r;i++)n<<=1,e[i]&&(n|=1);return n}static readByte(e,t){let r=e.length-t;return r>=8?ue.readCode(e,t,8):ue.readCode(e,t,r)<<8-r}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let r=0;r<t.length;r++)t[r]=ue.readByte(e,8*r);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}ue.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],ue.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],ue.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","\t","\n","\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],ue.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],ue.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class fe{constructor(){}static round(e){return NaN===e?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,r,n){const i=e-r,s=t-n;return Math.sqrt(i*i+s*s)}static sum(e){let t=0;for(let r=0,n=e.length;r!==n;r++)t+=e[r];return t}}class ge{static floatToIntBits(e){return e}}ge.MAX_VALUE=Number.MAX_SAFE_INTEGER;class me{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof me){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*ge.floatToIntBits(this.x)+ge.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),r=this.distance(e[1],e[2]),n=this.distance(e[0],e[2]);let i,s,o;if(r>=t&&r>=n?(s=e[0],i=e[1],o=e[2]):n>=r&&n>=t?(s=e[1],i=e[0],o=e[2]):(s=e[2],i=e[0],o=e[1]),this.crossProductZ(i,s,o)<0){const e=i;i=o,o=e}e[0]=i,e[1]=s,e[2]=o}static distance(e,t){return fe.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,r){const n=t.x,i=t.y;return(r.x-n)*(e.y-i)-(r.y-i)*(e.x-n)}}class pe{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class we extends pe{constructor(e,t,r,n,i){super(e,t),this.compact=r,this.nbDatablocks=n,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ae{constructor(e,t,r,n){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),null==t&&(t=Ae.INIT_SIZE),null==r&&(r=e.getWidth()/2|0),null==n&&(n=e.getHeight()/2|0);const i=t/2|0;if(this.leftInit=r-i,this.rightInit=r+i,this.upInit=n-i,this.downInit=n+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new R}detect(){let e=this.leftInit,t=this.rightInit,r=this.upInit,n=this.downInit,i=!1,s=!0,o=!1,a=!1,l=!1,c=!1,d=!1;const h=this.width,u=this.height;for(;s;){s=!1;let f=!0;for(;(f||!a)&&t<h;)f=this.containsBlackPoint(r,n,t,!1),f?(t++,s=!0,a=!0):a||t++;if(t>=h){i=!0;break}let g=!0;for(;(g||!l)&&n<u;)g=this.containsBlackPoint(e,t,n,!0),g?(n++,s=!0,l=!0):l||n++;if(n>=u){i=!0;break}let m=!0;for(;(m||!c)&&e>=0;)m=this.containsBlackPoint(r,n,e,!1),m?(e--,s=!0,c=!0):c||e--;if(e<0){i=!0;break}let p=!0;for(;(p||!d)&&r>=0;)p=this.containsBlackPoint(e,t,r,!0),p?(r--,s=!0,d=!0):d||r--;if(r<0){i=!0;break}s&&(o=!0)}if(!i&&o){const i=t-e;let s=null;for(let t=1;null===s&&t<i;t++)s=this.getBlackPointOnSegment(e,n-t,e+t,n);if(null==s)throw new R;let o=null;for(let t=1;null===o&&t<i;t++)o=this.getBlackPointOnSegment(e,r+t,e+t,r);if(null==o)throw new R;let a=null;for(let e=1;null===a&&e<i;e++)a=this.getBlackPointOnSegment(t,r+e,t-e,r);if(null==a)throw new R;let l=null;for(let e=1;null===l&&e<i;e++)l=this.getBlackPointOnSegment(t,n-e,t-e,n);if(null==l)throw new R;return this.centerEdges(l,s,a,o)}throw new R}getBlackPointOnSegment(e,t,r,n){const i=fe.round(fe.distance(e,t,r,n)),s=(r-e)/i,o=(n-t)/i,a=this.image;for(let l=0;l<i;l++){const r=fe.round(e+l*s),n=fe.round(t+l*o);if(a.get(r,n))return new me(r,n)}return null}centerEdges(e,t,r,n){const i=e.getX(),s=e.getY(),o=t.getX(),a=t.getY(),l=r.getX(),c=r.getY(),d=n.getX(),h=n.getY(),u=Ae.CORR;return i<this.width/2?[new me(d-u,h+u),new me(o+u,a+u),new me(l-u,c-u),new me(i+u,s-u)]:[new me(d+u,h+u),new me(o+u,a-u),new me(l-u,c+u),new me(i-u,s-u)]}containsBlackPoint(e,t,r,n){const i=this.image;if(n){for(let s=e;s<=t;s++)if(i.get(s,r))return!0}else for(let s=e;s<=t;s++)if(i.get(r,s))return!0;return!1}}Ae.INIT_SIZE=10,Ae.CORR=1;class Ce{static checkAndNudgePoints(e,t){const r=e.getWidth(),n=e.getHeight();let i=!0;for(let s=0;s<t.length&&i;s+=2){const e=Math.floor(t[s]),o=Math.floor(t[s+1]);if(e<-1||e>r||o<-1||o>n)throw new R;i=!1,-1===e?(t[s]=0,i=!0):e===r&&(t[s]=r-1,i=!0),-1===o?(t[s+1]=0,i=!0):o===n&&(t[s+1]=n-1,i=!0)}i=!0;for(let s=t.length-2;s>=0&&i;s-=2){const e=Math.floor(t[s]),o=Math.floor(t[s+1]);if(e<-1||e>r||o<-1||o>n)throw new R;i=!1,-1===e?(t[s]=0,i=!0):e===r&&(t[s]=r-1,i=!0),-1===o?(t[s+1]=0,i=!0):o===n&&(t[s+1]=n-1,i=!0)}}}class ye{constructor(e,t,r,n,i,s,o,a,l){this.a11=e,this.a21=t,this.a31=r,this.a12=n,this.a22=i,this.a32=s,this.a13=o,this.a23=a,this.a33=l}static quadrilateralToQuadrilateral(e,t,r,n,i,s,o,a,l,c,d,h,u,f,g,m){const p=ye.quadrilateralToSquare(e,t,r,n,i,s,o,a);return ye.squareToQuadrilateral(l,c,d,h,u,f,g,m).times(p)}transformPoints(e){const t=e.length,r=this.a11,n=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,l=this.a31,c=this.a32,d=this.a33;for(let h=0;h<t;h+=2){const t=e[h],u=e[h+1],f=i*t+a*u+d;e[h]=(r*t+s*u+l)/f,e[h+1]=(n*t+o*u+c)/f}}transformPointsWithValues(e,t){const r=this.a11,n=this.a12,i=this.a13,s=this.a21,o=this.a22,a=this.a23,l=this.a31,c=this.a32,d=this.a33,h=e.length;for(let u=0;u<h;u++){const h=e[u],f=t[u],g=i*h+a*f+d;e[u]=(r*h+s*f+l)/g,t[u]=(n*h+o*f+c)/g}}static squareToQuadrilateral(e,t,r,n,i,s,o,a){const l=e-r+i-o,c=t-n+s-a;if(0===l&&0===c)return new ye(r-e,i-r,e,n-t,s-n,t,0,0,1);{const d=r-i,h=o-i,u=n-s,f=a-s,g=d*f-h*u,m=(l*f-h*c)/g,p=(d*c-l*u)/g;return new ye(r-e+m*r,o-e+p*o,e,n-t+m*n,a-t+p*a,t,m,p,1)}}static quadrilateralToSquare(e,t,r,n,i,s,o,a){return ye.squareToQuadrilateral(e,t,r,n,i,s,o,a).buildAdjoint()}buildAdjoint(){return new ye(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new ye(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class Ee extends Ce{sampleGrid(e,t,r,n,i,s,o,a,l,c,d,h,u,f,g,m,p,w,A){const C=ye.quadrilateralToQuadrilateral(n,i,s,o,a,l,c,d,h,u,f,g,m,p,w,A);return this.sampleGridWithTransform(e,t,r,C)}sampleGridWithTransform(e,t,r,n){if(t<=0||r<=0)throw new R;const i=new M(t,r),s=new Float32Array(2*t);for(let a=0;a<r;a++){const t=s.length,r=a+.5;for(let e=0;e<t;e+=2)s[e]=e/2+.5,s[e+1]=r;n.transformPoints(s),Ce.checkAndNudgePoints(e,s);try{for(let r=0;r<t;r+=2)e.get(Math.floor(s[r]),Math.floor(s[r+1]))&&i.set(r/2,a)}catch(o){throw new R}}return i}}class _e{static setGridSampler(e){_e.gridSampler=e}static getInstance(){return _e.gridSampler}}_e.gridSampler=new Ee;class Se{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new me(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Ie{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),r=this.getBullsEyeCorners(t);if(e){let e=r[0];r[0]=r[2],r[2]=e}this.extractParameters(r);let n=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),i=this.getMatrixCornerPoints(r);return new we(n,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!(this.isValidPoint(e[0])&&this.isValidPoint(e[1])&&this.isValidPoint(e[2])&&this.isValidPoint(e[3])))throw new R;let t=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(r,t);let n=0;for(let s=0;s<4;s++){let e=r[(this.shift+s)%4];this.compact?(n<<=7,n+=e>>1&127):(n<<=10,n+=(e>>2&992)+(e>>1&31))}let i=this.getCorrectedParameterData(n,this.compact);this.compact?(this.nbLayers=1+(i>>6),this.nbDataBlocks=1+(63&i)):(this.nbLayers=1+(i>>11),this.nbDataBlocks=1+(2047&i))}getRotation(e,t){let r=0;e.forEach((e,n,i)=>{r=(e>>t-2<<1)+(1&e)+(r<<3)}),r=((1&r)<<11)+(r>>1);for(let n=0;n<4;n++)if(C.bitCount(r^this.EXPECTED_CORNER_BITS[n])<=2)return n;throw new R}getCorrectedParameterData(e,t){let r,n;t?(r=7,n=2):(r=10,n=4);let i=r-n,s=new Int32Array(r);for(let l=r-1;l>=0;--l)s[l]=15&e,e>>=4;try{new he(le.AZTEC_PARAM).decode(s,i)}catch(a){throw new R}let o=0;for(let l=0;l<n;l++)o=(o<<4)+s[l];return o}getBullsEyeCorners(e){let t=e,r=e,n=e,i=e,s=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let e=this.getFirstDifferent(t,s,1,-1),o=this.getFirstDifferent(r,s,1,1),a=this.getFirstDifferent(n,s,-1,1),l=this.getFirstDifferent(i,s,-1,-1);if(this.nbCenterLayers>2){let r=this.distancePoint(l,e)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(r<.75||r>1.25||!this.isWhiteOrBlackRectangle(e,o,a,l))break}t=e,r=o,n=a,i=l,s=!s}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new R;this.compact=5===this.nbCenterLayers;let o=new me(t.getX()+.5,t.getY()-.5),a=new me(r.getX()+.5,r.getY()+.5),l=new me(n.getX()-.5,n.getY()+.5),c=new me(i.getX()-.5,i.getY()-.5);return this.expandSquare([o,a,l,c],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,r,n;try{let i=new Ae(this.image).detect();e=i[0],t=i[1],r=i[2],n=i[3]}catch(Re){let s=this.image.getWidth()/2,o=this.image.getHeight()/2;e=this.getFirstDifferent(new Se(s+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Se(s+7,o+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new Se(s-7,o+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new Se(s-7,o-7),!1,-1,-1).toResultPoint()}let i=fe.round((e.getX()+n.getX()+t.getX()+r.getX())/4),s=fe.round((e.getY()+n.getY()+t.getY()+r.getY())/4);try{let o=new Ae(this.image,15,i,s).detect();e=o[0],t=o[1],r=o[2],n=o[3]}catch(Re){e=this.getFirstDifferent(new Se(i+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Se(i+7,s+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new Se(i-7,s+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new Se(i-7,s-7),!1,-1,-1).toResultPoint()}return i=fe.round((e.getX()+n.getX()+t.getX()+r.getX())/4),s=fe.round((e.getY()+n.getY()+t.getY()+r.getY())/4),new Se(i,s)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,r,n,i){let s=_e.getInstance(),o=this.getDimension(),a=o/2-this.nbCenterLayers,l=o/2+this.nbCenterLayers;return s.sampleGrid(e,o,o,a,a,l,a,l,l,a,l,t.getX(),t.getY(),r.getX(),r.getY(),n.getX(),n.getY(),i.getX(),i.getY())}sampleLine(e,t,r){let n=0,i=this.distanceResultPoint(e,t),s=i/r,o=e.getX(),a=e.getY(),l=s*(t.getX()-e.getX())/i,c=s*(t.getY()-e.getY())/i;for(let d=0;d<r;d++)this.image.get(fe.round(o+d*l),fe.round(a+d*c))&&(n|=1<<r-d-1);return n}isWhiteOrBlackRectangle(e,t,r,n){let i=3;e=new Se(e.getX()-i,e.getY()+i),t=new Se(t.getX()-i,t.getY()-i),r=new Se(r.getX()+i,r.getY()-i),n=new Se(n.getX()+i,n.getY()+i);let s=this.getColor(n,e);if(0===s)return!1;let o=this.getColor(e,t);return o===s&&(o=this.getColor(t,r),o===s&&(o=this.getColor(r,n),o===s))}getColor(e,t){let r=this.distancePoint(e,t),n=(t.getX()-e.getX())/r,i=(t.getY()-e.getY())/r,s=0,o=e.getX(),a=e.getY(),l=this.image.get(e.getX(),e.getY()),c=Math.ceil(r);for(let h=0;h<c;h++)o+=n,a+=i,this.image.get(fe.round(o),fe.round(a))!==l&&s++;let d=s/r;return d>.1&&d<.9?0:d<=.1===l?1:-1}getFirstDifferent(e,t,r,n){let i=e.getX()+r,s=e.getY()+n;for(;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=r,s+=n;for(i-=r,s-=n;this.isValid(i,s)&&this.image.get(i,s)===t;)i+=r;for(i-=r;this.isValid(i,s)&&this.image.get(i,s)===t;)s+=n;return s-=n,new Se(i,s)}expandSquare(e,t,r){let n=r/(2*t),i=e[0].getX()-e[2].getX(),s=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,a=(e[0].getY()+e[2].getY())/2,l=new me(o+n*i,a+n*s),c=new me(o-n*i,a-n*s);return i=e[1].getX()-e[3].getX(),s=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,a=(e[1].getY()+e[3].getY())/2,[l,new me(o+n*i,a+n*s),c,new me(o-n*i,a-n*s)]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=fe.round(e.getX()),r=fe.round(e.getY());return this.isValid(t,r)}distancePoint(e,t){return fe.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return fe.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(C.truncDivision(this.nbLayers-4,8)+1)+15}}class Ne{decode(e,t=null){let r=null,n=new Ie(e.getBlackMatrix()),i=null,s=null;try{let e=n.detectMirror(!1);i=e.getPoints(),this.reportFoundResultPoints(t,i),s=(new ue).decode(e)}catch(Re){r=Re}if(null==s)try{let e=n.detectMirror(!0);i=e.getPoints(),this.reportFoundResultPoints(t,i),s=(new ue).decode(e)}catch(Re){if(null!=r)throw r;throw Re}let o=new V(s.getText(),s.getRawBytes(),s.getNumBits(),i,Y.AZTEC,m.currentTimeMillis()),a=s.getByteSegments();null!=a&&o.putMetadata(ne.BYTE_SEGMENTS,a);let l=s.getECLevel();return null!=l&&o.putMetadata(ne.ERROR_CORRECTION_LEVEL,l),o}reportFoundResultPoints(e,t){if(null!=e){let r=e.get(S.NEED_RESULT_POINT_CALLBACK);null!=r&&t.forEach((e,t,n)=>{r.foundPossibleResultPoint(e)})}}reset(){}}class Te extends H{constructor(e=500){super(new Ne,e)}}class be{decode(e,t){try{return this.doDecode(e,t)}catch(r){if(t&&!0===t.get(S.TRY_HARDER)&&e.isRotateSupported()){const r=e.rotateCounterClockwise(),n=this.doDecode(r,t),i=n.getResultMetadata();let s=270;null!==i&&!0===i.get(ne.ORIENTATION)&&(s+=i.get(ne.ORIENTATION)%360),n.putMetadata(ne.ORIENTATION,s);const o=n.getResultPoints();if(null!==o){const e=r.getHeight();for(let t=0;t<o.length;t++)o[t]=new me(e-o[t].getY()-1,o[t].getX())}return n}throw new R}}reset(){}doDecode(e,t){const r=e.getWidth(),n=e.getHeight();let i=new y(r);const s=t&&!0===t.get(S.TRY_HARDER),o=Math.max(1,n>>(s?8:5));let a;a=s?n:15;const l=Math.trunc(n/2);for(let h=0;h<a;h++){const s=Math.trunc((h+1)/2),a=l+o*(1&h?-s:s);if(a<0||a>=n)break;try{i=e.getBlackRow(a,i)}catch(c){continue}for(let e=0;e<2;e++){if(1===e&&(i.reverse(),t&&!0===t.get(S.NEED_RESULT_POINT_CALLBACK))){const e=new Map;t.forEach((t,r)=>e.set(r,t)),e.delete(S.NEED_RESULT_POINT_CALLBACK),t=e}try{const n=this.decodeRow(a,i,t);if(1===e){n.putMetadata(ne.ORIENTATION,180);const e=n.getResultPoints();null!==e&&(e[0]=new me(r-e[0].getX()-1,e[0].getY()),e[1]=new me(r-e[1].getX()-1,e[1].getY()))}return n}catch(d){}}}throw new R}static recordPattern(e,t,r){const n=r.length;for(let l=0;l<n;l++)r[l]=0;const i=e.getSize();if(t>=i)throw new R;let s=!e.get(t),o=0,a=t;for(;a<i;){if(e.get(a)!==s)r[o]++;else{if(++o===n)break;r[o]=1,s=!s}a++}if(o!==n&&(o!==n-1||a!==i))throw new R}static recordPatternInReverse(e,t,r){let n=r.length,i=e.get(t);for(;t>0&&n>=0;)e.get(--t)!==i&&(n--,i=!i);if(n>=0)throw new R;be.recordPattern(e,t+1,r)}static patternMatchVariance(e,t,r){const n=e.length;let i=0,s=0;for(let l=0;l<n;l++)i+=e[l],s+=t[l];if(i<s)return Number.POSITIVE_INFINITY;const o=i/s;r*=o;let a=0;for(let l=0;l<n;l++){const n=e[l],i=t[l]*o,s=n>i?n-i:i-n;if(s>r)return Number.POSITIVE_INFINITY;a+=s}return a/i}}class xe extends be{static findStartPattern(e){const t=e.getSize(),r=e.getNextSet(0);let n=0,i=Int32Array.from([0,0,0,0,0,0]),s=r,o=!1;const a=6;for(let l=r;l<t;l++)if(e.get(l)!==o)i[n]++;else{if(n===a-1){let t=xe.MAX_AVG_VARIANCE,r=-1;for(let e=xe.CODE_START_A;e<=xe.CODE_START_C;e++){const n=be.patternMatchVariance(i,xe.CODE_PATTERNS[e],xe.MAX_INDIVIDUAL_VARIANCE);n<t&&(t=n,r=e)}if(r>=0&&e.isRange(Math.max(0,s-(l-s)/2),s,!1))return Int32Array.from([s,l,r]);s+=i[0]+i[1],i=i.slice(2,i.length-1),i[n-1]=0,i[n]=0,n--}else n++;i[n]=1,o=!o}throw new R}static decodeCode(e,t,r){be.recordPattern(e,r,t);let n=xe.MAX_AVG_VARIANCE,i=-1;for(let s=0;s<xe.CODE_PATTERNS.length;s++){const e=xe.CODE_PATTERNS[s],r=this.patternMatchVariance(t,e,xe.MAX_INDIVIDUAL_VARIANCE);r<n&&(n=r,i=s)}if(i>=0)return i;throw new R}decodeRow(e,t,r){const n=r&&!0===r.get(S.ASSUME_GS1),i=xe.findStartPattern(t),s=i[2];let o=0;const a=new Uint8Array(20);let l;switch(a[o++]=s,s){case xe.CODE_START_A:l=xe.CODE_CODE_A;break;case xe.CODE_START_B:l=xe.CODE_CODE_B;break;case xe.CODE_START_C:l=xe.CODE_CODE_C;break;default:throw new I}let c=!1,d=!1,h="",u=i[0],g=i[1];const m=Int32Array.from([0,0,0,0,0,0]);let p=0,w=0,A=s,C=0,y=!0,E=!1,_=!1;for(;!c;){const e=d;switch(d=!1,p=w,w=xe.decodeCode(t,m,g),a[o++]=w,w!==xe.CODE_STOP&&(y=!0),w!==xe.CODE_STOP&&(C++,A+=C*w),u=g,g+=m.reduce((e,t)=>e+t,0),w){case xe.CODE_START_A:case xe.CODE_START_B:case xe.CODE_START_C:throw new I}switch(l){case xe.CODE_CODE_A:if(w<64)h+=_===E?String.fromCharCode(" ".charCodeAt(0)+w):String.fromCharCode(" ".charCodeAt(0)+w+128),_=!1;else if(w<96)h+=_===E?String.fromCharCode(w-64):String.fromCharCode(w+64),_=!1;else switch(w!==xe.CODE_STOP&&(y=!1),w){case xe.CODE_FNC_1:n&&(0===h.length?h+="]C1":h+=String.fromCharCode(29));break;case xe.CODE_FNC_2:case xe.CODE_FNC_3:break;case xe.CODE_FNC_4_A:!E&&_?(E=!0,_=!1):E&&_?(E=!1,_=!1):_=!0;break;case xe.CODE_SHIFT:d=!0,l=xe.CODE_CODE_B;break;case xe.CODE_CODE_B:l=xe.CODE_CODE_B;break;case xe.CODE_CODE_C:l=xe.CODE_CODE_C;break;case xe.CODE_STOP:c=!0}break;case xe.CODE_CODE_B:if(w<96)h+=_===E?String.fromCharCode(" ".charCodeAt(0)+w):String.fromCharCode(" ".charCodeAt(0)+w+128),_=!1;else switch(w!==xe.CODE_STOP&&(y=!1),w){case xe.CODE_FNC_1:n&&(0===h.length?h+="]C1":h+=String.fromCharCode(29));break;case xe.CODE_FNC_2:case xe.CODE_FNC_3:break;case xe.CODE_FNC_4_B:!E&&_?(E=!0,_=!1):E&&_?(E=!1,_=!1):_=!0;break;case xe.CODE_SHIFT:d=!0,l=xe.CODE_CODE_A;break;case xe.CODE_CODE_A:l=xe.CODE_CODE_A;break;case xe.CODE_CODE_C:l=xe.CODE_CODE_C;break;case xe.CODE_STOP:c=!0}break;case xe.CODE_CODE_C:if(w<100)w<10&&(h+="0"),h+=w;else switch(w!==xe.CODE_STOP&&(y=!1),w){case xe.CODE_FNC_1:n&&(0===h.length?h+="]C1":h+=String.fromCharCode(29));break;case xe.CODE_CODE_A:l=xe.CODE_CODE_A;break;case xe.CODE_CODE_B:l=xe.CODE_CODE_B;break;case xe.CODE_STOP:c=!0}}e&&(l=l===xe.CODE_CODE_A?xe.CODE_CODE_B:xe.CODE_CODE_A)}const N=g-u;if(g=t.getNextUnset(g),!t.isRange(g,Math.min(t.getSize(),g+(g-u)/2),!1))throw new R;if(A-=C*p,A%103!==p)throw new f;const T=h.length;if(0===T)throw new R;T>0&&y&&(h=l===xe.CODE_CODE_C?h.substring(0,T-2):h.substring(0,T-1));const b=(i[1]+i[0])/2,x=u+N/2,D=a.length,M=new Uint8Array(D);for(let f=0;f<D;f++)M[f]=a[f];const v=[new me(b,e),new me(x,e)];return new V(h,M,0,v,Y.CODE_128,(new Date).getTime())}}xe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],xe.MAX_AVG_VARIANCE=.25,xe.MAX_INDIVIDUAL_VARIANCE=.7,xe.CODE_SHIFT=98,xe.CODE_CODE_C=99,xe.CODE_CODE_B=100,xe.CODE_CODE_A=101,xe.CODE_FNC_1=102,xe.CODE_FNC_2=97,xe.CODE_FNC_3=96,xe.CODE_FNC_4_A=101,xe.CODE_FNC_4_B=100,xe.CODE_START_A=103,xe.CODE_START_B=104,xe.CODE_START_C=105,xe.CODE_STOP=106;class De extends be{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,r){let n=this.counters;n.fill(0),this.decodeRowResult="";let i,s,o=De.findAsteriskPattern(t,n),a=t.getNextSet(o[1]),l=t.getSize();do{De.recordPattern(t,a,n);let e=De.toNarrowWidePattern(n);if(e<0)throw new R;i=De.patternToChar(e),this.decodeRowResult+=i,s=a;for(let t of n)a+=t;a=t.getNextSet(a)}while("*"!==i);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let c,d=0;for(let f of n)d+=f;if(a!==l&&2*(a-s-d)<d)throw new R;if(this.usingCheckDigit){let e=this.decodeRowResult.length-1,t=0;for(let r=0;r<e;r++)t+=De.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(r));if(this.decodeRowResult.charAt(e)!==De.ALPHABET_STRING.charAt(t%43))throw new f;this.decodeRowResult=this.decodeRowResult.substring(0,e)}if(0===this.decodeRowResult.length)throw new R;c=this.extendedMode?De.decodeExtended(this.decodeRowResult):this.decodeRowResult;let h=(o[1]+o[0])/2,u=s+d/2;return new V(c,null,0,[new me(h,e),new me(u,e)],Y.CODE_39,(new Date).getTime())}static findAsteriskPattern(e,t){let r=e.getSize(),n=e.getNextSet(0),i=0,s=n,o=!1,a=t.length;for(let l=n;l<r;l++)if(e.get(l)!==o)t[i]++;else{if(i===a-1){if(this.toNarrowWidePattern(t)===De.ASTERISK_ENCODING&&e.isRange(Math.max(0,s-Math.floor((l-s)/2)),s,!1))return[s,l];s+=t[0]+t[1],t.copyWithin(0,2,2+i-1),t[i-1]=0,t[i]=0,i--}else i++;t[i]=1,o=!o}throw new R}static toNarrowWidePattern(e){let t,r=e.length,n=0;do{let i=2147483647;for(let t of e)t<i&&t>n&&(i=t);n=i,t=0;let s=0,o=0;for(let a=0;a<r;a++){let i=e[a];i>n&&(o|=1<<r-1-a,t++,s+=i)}if(3===t){for(let i=0;i<r&&t>0;i++){let r=e[i];if(r>n&&(t--,2*r>=s))return-1}return o}}while(t>3);return-1}static patternToChar(e){for(let t=0;t<De.CHARACTER_ENCODINGS.length;t++)if(De.CHARACTER_ENCODINGS[t]===e)return De.ALPHABET_STRING.charAt(t);if(e===De.ASTERISK_ENCODING)return"*";throw new R}static decodeExtended(e){let t=e.length,r="";for(let n=0;n<t;n++){let t=e.charAt(n);if("+"===t||"$"===t||"%"===t||"/"===t){let i=e.charAt(n+1),s="\0";switch(t){case"+":if(!(i>="A"&&i<="Z"))throw new I;s=String.fromCharCode(i.charCodeAt(0)+32);break;case"$":if(!(i>="A"&&i<="Z"))throw new I;s=String.fromCharCode(i.charCodeAt(0)-64);break;case"%":if(i>="A"&&i<="E")s=String.fromCharCode(i.charCodeAt(0)-38);else if(i>="F"&&i<="J")s=String.fromCharCode(i.charCodeAt(0)-11);else if(i>="K"&&i<="O")s=String.fromCharCode(i.charCodeAt(0)+16);else if(i>="P"&&i<="T")s=String.fromCharCode(i.charCodeAt(0)+43);else if("U"===i)s="\0";else if("V"===i)s="@";else if("W"===i)s="`";else{if("X"!==i&&"Y"!==i&&"Z"!==i)throw new I;s=""}break;case"/":if(i>="A"&&i<="O")s=String.fromCharCode(i.charCodeAt(0)-32);else{if("Z"!==i)throw new I;s=":"}}r+=s,n++}else r+=t}return r}}De.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",De.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],De.ASTERISK_ENCODING=148;class Me extends be{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,r){let n=this.decodeStart(t),i=this.decodeEnd(t),s=new D;Me.decodeMiddle(t,n[1],i[0],s);let o=s.toString(),a=null;null!=r&&(a=r.get(S.ALLOWED_LENGTHS)),null==a&&(a=Me.DEFAULT_ALLOWED_LENGTHS);let l=o.length,c=!1,d=0;for(let u of a){if(l===u){c=!0;break}u>d&&(d=u)}if(!c&&l>d&&(c=!0),!c)throw new I;const h=[new me(n[1],e),new me(i[0],e)];return new V(o,null,0,h,Y.ITF,(new Date).getTime())}static decodeMiddle(e,t,r,n){let i=new Int32Array(10),s=new Int32Array(5),o=new Int32Array(5);for(i.fill(0),s.fill(0),o.fill(0);t<r;){be.recordPattern(e,t,i);for(let e=0;e<5;e++){let t=2*e;s[e]=i[t],o[e]=i[t+1]}let r=Me.decodeDigit(s);n.append(r.toString()),r=this.decodeDigit(o),n.append(r.toString()),i.forEach(function(e){t+=e})}}decodeStart(e){let t=Me.skipWhiteSpace(e),r=Me.findGuardPattern(e,t,Me.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(e,r[0]),r}validateQuietZone(e,t){let r=10*this.narrowLineWidth;r=r<t?r:t;for(let n=t-1;r>0&&n>=0&&!e.get(n);n--)r--;if(0!==r)throw new R}static skipWhiteSpace(e){const t=e.getSize(),r=e.getNextSet(0);if(r===t)throw new R;return r}decodeEnd(e){e.reverse();try{let r,n=Me.skipWhiteSpace(e);try{r=Me.findGuardPattern(e,n,Me.END_PATTERN_REVERSED[0])}catch(t){t instanceof R&&(r=Me.findGuardPattern(e,n,Me.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,r[0]);let i=r[0];return r[0]=e.getSize()-r[1],r[1]=e.getSize()-i,r}finally{e.reverse()}}static findGuardPattern(e,t,r){let n=r.length,i=new Int32Array(n),s=e.getSize(),o=!1,a=0,l=t;i.fill(0);for(let c=t;c<s;c++)if(e.get(c)!==o)i[a]++;else{if(a===n-1){if(be.patternMatchVariance(i,r,Me.MAX_INDIVIDUAL_VARIANCE)<Me.MAX_AVG_VARIANCE)return[l,c];l+=i[0]+i[1],m.arraycopy(i,2,i,0,a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,o=!o}throw new R}static decodeDigit(e){let t=Me.MAX_AVG_VARIANCE,r=-1,n=Me.PATTERNS.length;for(let i=0;i<n;i++){let n=Me.PATTERNS[i],s=be.patternMatchVariance(e,n,Me.MAX_INDIVIDUAL_VARIANCE);s<t?(t=s,r=i):s===t&&(r=-1)}if(r>=0)return r%10;throw new R}}Me.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Me.MAX_AVG_VARIANCE=.38,Me.MAX_INDIVIDUAL_VARIANCE=.5,Me.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Me.START_PATTERN=Int32Array.from([1,1,1,1]),Me.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class ve extends be{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t,r=!1,n=0,i=Int32Array.from([0,0,0]);for(;!r;){i=Int32Array.from([0,0,0]),t=ve.findGuardPattern(e,n,!1,this.START_END_PATTERN,i);let s=t[0];n=t[1];let o=s-(n-s);o>=0&&(r=e.isRange(o,s,!1))}return t}static checkChecksum(e){return ve.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let r=parseInt(e.charAt(t-1),10);return ve.getStandardUPCEANChecksum(e.substring(0,t-1))===r}static getStandardUPCEANChecksum(e){let t=e.length,r=0;for(let n=t-1;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new I;r+=t}r*=3;for(let n=t-2;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new I;r+=t}return(1e3-r)%10}static decodeEnd(e,t){return ve.findGuardPattern(e,t,!1,ve.START_END_PATTERN,new Int32Array(ve.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,r,n){return this.findGuardPattern(e,t,r,n,new Int32Array(n.length))}static findGuardPattern(e,t,r,n,i){let s=e.getSize(),o=0,a=t=r?e.getNextUnset(t):e.getNextSet(t),l=n.length,c=r;for(let d=t;d<s;d++)if(e.get(d)!==c)i[o]++;else{if(o===l-1){if(be.patternMatchVariance(i,n,ve.MAX_INDIVIDUAL_VARIANCE)<ve.MAX_AVG_VARIANCE)return Int32Array.from([a,d]);a+=i[0]+i[1];let e=i.slice(2,i.length-1);for(let t=0;t<o-1;t++)i[t]=e[t];i[o-1]=0,i[o]=0,o--}else o++;i[o]=1,c=!c}throw new R}static decodeDigit(e,t,r,n){this.recordPattern(e,r,t);let i=this.MAX_AVG_VARIANCE,s=-1,o=n.length;for(let a=0;a<o;a++){let e=n[a],r=be.patternMatchVariance(t,e,ve.MAX_INDIVIDUAL_VARIANCE);r<i&&(i=r,s=a)}if(s>=0)return s;throw new R}}ve.MAX_AVG_VARIANCE=.48,ve.MAX_INDIVIDUAL_VARIANCE=.7,ve.START_END_PATTERN=Int32Array.from([1,1,1]),ve.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),ve.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ve.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Oe{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,r){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(t,r,n),s=n.toString(),o=Oe.parseExtensionString(s),a=[new me((r[0]+r[1])/2,e),new me(i,e)],l=new V(s,null,0,a,Y.UPC_EAN_EXTENSION,(new Date).getTime());return null!=o&&l.putAllMetadata(o),l}decodeMiddle(e,t,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),s=t[1],o=0;for(let l=0;l<5&&s<i;l++){let t=ve.decodeDigit(e,n,s,ve.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)s+=e;t>=10&&(o|=1<<4-l),4!==l&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(5!==r.length)throw new R;let a=this.determineCheckDigit(o);if(Oe.extensionChecksum(r.toString())!==a)throw new R;return s}static extensionChecksum(e){let t=e.length,r=0;for(let n=t-2;n>=0;n-=2)r+=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);r*=3;for(let n=t-1;n>=0;n-=2)r+=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);return r*=3,r%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new R}static parseExtensionString(e){if(5!==e.length)return null;let t=Oe.parseExtension5String(e);return null==t?null:new Map([[ne.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t=""}let r=parseInt(e.substring(1)),n=r%100;return t+(r/100).toString()+"."+(n<10?"0"+n:n.toString())}}class Pe{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,r){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(t,r,n),s=n.toString(),o=Pe.parseExtensionString(s),a=[new me((r[0]+r[1])/2,e),new me(i,e)],l=new V(s,null,0,a,Y.UPC_EAN_EXTENSION,(new Date).getTime());return null!=o&&l.putAllMetadata(o),l}decodeMiddle(e,t,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),s=t[1],o=0;for(let a=0;a<2&&s<i;a++){let t=ve.decodeDigit(e,n,s,ve.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)s+=e;t>=10&&(o|=1<<1-a),1!==a&&(s=e.getNextSet(s),s=e.getNextUnset(s))}if(2!==r.length)throw new R;if(parseInt(r.toString())%4!==o)throw new R;return s}static parseExtensionString(e){return 2!==e.length?null:new Map([[ne.ISSUE_NUMBER,parseInt(e)]])}}class Be{static decodeRow(e,t,r){let n=ve.findGuardPattern(t,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new Oe).decodeRow(e,t,n)}catch(i){return(new Pe).decodeRow(e,t,n)}}}Be.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Le extends ve{constructor(){super(),this.decodeRowStringBuffer="",Le.L_AND_G_PATTERNS=Le.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=Le.L_PATTERNS[e-10],r=new Int32Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[t.length-e-1];Le.L_AND_G_PATTERNS[e]=r}}decodeRow(e,t,r){let n=Le.findStartGuardPattern(t),i=null==r?null:r.get(S.NEED_RESULT_POINT_CALLBACK);if(null!=i){const t=new me((n[0]+n[1])/2,e);i.foundPossibleResultPoint(t)}let s=this.decodeMiddle(t,n,this.decodeRowStringBuffer),o=s.rowOffset,a=s.resultString;if(null!=i){const t=new me(o,e);i.foundPossibleResultPoint(t)}let l=this.decodeEnd(t,o);if(null!=i){const t=new me((l[0]+l[1])/2,e);i.foundPossibleResultPoint(t)}let c=l[1],d=c+(c-l[0]);if(d>=t.getSize()||!t.isRange(c,d,!1))throw new R;let h=a.toString();if(h.length<8)throw new I;if(!Le.checkChecksum(h))throw new f;let u=(n[1]+n[0])/2,g=(l[1]+l[0])/2,m=this.getBarcodeFormat(),p=[new me(u,e),new me(g,e)],w=new V(h,null,0,p,m,(new Date).getTime()),A=0;try{let r=Be.decodeRow(e,t,l[1]);w.putMetadata(ne.UPC_EAN_EXTENSION,r.getText()),w.putAllMetadata(r.getResultMetadata()),w.addResultPoints(r.getResultPoints()),A=r.getText().length}catch(y){}let C=null==r?null:r.get(S.ALLOWED_EAN_EXTENSIONS);if(null!=C){let e=!1;for(let t in C)if(A.toString()===t){e=!0;break}if(!e)throw new R}return w}decodeEnd(e,t){return Le.findGuardPattern(e,t,!1,Le.START_END_PATTERN,new Int32Array(Le.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return Le.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(0===t)return!1;let r=parseInt(e.charAt(t-1),10);return Le.getStandardUPCEANChecksum(e.substring(0,t-1))===r}static getStandardUPCEANChecksum(e){let t=e.length,r=0;for(let n=t-1;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new I;r+=t}r*=3;for(let n=t-2;n>=0;n-=2){let t=e.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(t<0||t>9)throw new I;r+=t}return(1e3-r)%10}}class ke extends Le{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),s=t[1],o=0;for(let a=0;a<6&&s<i;a++){let t=Le.decodeDigit(e,n,s,Le.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)s+=e;t>=10&&(o|=1<<5-a)}r=ke.determineFirstDigit(r,o),s=Le.findGuardPattern(e,s,!0,Le.MIDDLE_PATTERN,new Int32Array(Le.MIDDLE_PATTERN.length).fill(0))[1];for(let a=0;a<6&&s<i;a++){let t=Le.decodeDigit(e,n,s,Le.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of n)s+=e}return{rowOffset:s,resultString:r}}getBarcodeFormat(){return Y.EAN_13}static determineFirstDigit(e,t){for(let r=0;r<10;r++)if(t===this.FIRST_DIGIT_ENCODINGS[r])return e=String.fromCharCode("0".charCodeAt(0)+r)+e;throw new R}}ke.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class je extends Le{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,r){const n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=e.getSize(),s=t[1];for(let o=0;o<4&&s<i;o++){let t=Le.decodeDigit(e,n,s,Le.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of n)s+=e}s=Le.findGuardPattern(e,s,!0,Le.MIDDLE_PATTERN,new Int32Array(Le.MIDDLE_PATTERN.length).fill(0))[1];for(let o=0;o<4&&s<i;o++){let t=Le.decodeDigit(e,n,s,Le.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t);for(let e of n)s+=e}return{rowOffset:s,resultString:r}}getBarcodeFormat(){return Y.EAN_8}}class Fe extends Le{constructor(){super(...arguments),this.ean13Reader=new ke}getBarcodeFormat(){return Y.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,r){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,r))}decodeMiddle(e,t,r){return this.ean13Reader.decodeMiddle(e,t,r)}maybeReturnResult(e){let t=e.getText();if("0"===t.charAt(0)){let r=new V(t.substring(1),null,null,e.getResultPoints(),Y.UPC_A);return null!=e.getResultMetadata()&&r.putAllMetadata(e.getResultMetadata()),r}throw new R}reset(){this.ean13Reader.reset()}}class Ue extends Le{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,r){const n=this.decodeMiddleCounters.map(e=>e);n[0]=0,n[1]=0,n[2]=0,n[3]=0;const i=e.getSize();let s=t[1],o=0;for(let a=0;a<6&&s<i;a++){const t=Ue.decodeDigit(e,n,s,Ue.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+t%10);for(let e of n)s+=e;t>=10&&(o|=1<<5-a)}return{rowOffset:s,resultString:Ue.determineNumSysAndCheckDigit(r,o)}}decodeEnd(e,t){return Ue.findGuardPatternWithoutCounters(e,t,!0,Ue.MIDDLE_END_PATTERN)}checkChecksum(e){return Le.checkChecksum(Ue.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let r=0;r<=1;r++)for(let n=0;n<10;n++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[r][n])return String.fromCharCode("0".charCodeAt(0)+r)+e+String.fromCharCode("0".charCodeAt(0)+n);throw R.getNotFoundInstance()}getBarcodeFormat(){return Y.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(e=>e.charCodeAt(0)),r=new D;r.append(e.charAt(0));let n=t[5];switch(n){case 0:case 1:case 2:r.appendChars(t,0,2),r.append(n),r.append("0000"),r.appendChars(t,2,3);break;case 3:r.appendChars(t,0,3),r.append("00000"),r.appendChars(t,3,2);break;case 4:r.appendChars(t,0,4),r.append("00000"),r.append(t[4]);break;default:r.appendChars(t,0,5),r.append("0000"),r.append(n)}return e.length>=8&&r.append(e.charAt(7)),r.toString()}}Ue.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ue.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class He extends be{constructor(e){super();let r=null==e?null:e.get(S.POSSIBLE_FORMATS),n=[];t(r)?(n.push(new ke),n.push(new Fe),n.push(new je),n.push(new Ue)):(r.indexOf(Y.EAN_13)>-1&&n.push(new ke),r.indexOf(Y.UPC_A)>-1&&n.push(new Fe),r.indexOf(Y.EAN_8)>-1&&n.push(new je),r.indexOf(Y.UPC_E)>-1&&n.push(new Ue)),this.readers=n}decodeRow(e,t,r){for(let i of this.readers)try{const n=i.decodeRow(e,t,r),s=n.getBarcodeFormat()===Y.EAN_13&&"0"===n.getText().charAt(0),o=null==r?null:r.get(S.POSSIBLE_FORMATS),a=null==o||o.includes(Y.UPC_A);if(s&&a){const e=n.getRawBytes(),t=new V(n.getText().substring(1),e,e?e.length:null,n.getResultPoints(),Y.UPC_A);return t.putAllMetadata(n.getResultMetadata()),t}return n}catch(n){}throw new R}reset(){for(let e of this.readers)e.reset()}}class Ve extends be{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let r=0;r<t.length;r++)if(be.patternMatchVariance(e,t[r],Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE)return r;throw new R}static count(e){return fe.sum(new Int32Array(e))}static increment(e,t){let r=0,n=t[0];for(let i=1;i<e.length;i++)t[i]>n&&(n=t[i],r=i);e[r]++}static decrement(e,t){let r=0,n=t[0];for(let i=1;i<e.length;i++)t[i]<n&&(n=t[i],r=i);e[r]--}static isFinderPattern(e){let t=e[0]+e[1],r=t/(t+e[2]+e[3]);if(r>=Ve.MIN_FINDER_PATTERN_RATIO&&r<=Ve.MAX_FINDER_PATTERN_RATIO){let t=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(let n of e)n>r&&(r=n),n<t&&(t=n);return r<10*t}return!1}}Ve.MAX_AVG_VARIANCE=.2,Ve.MAX_INDIVIDUAL_VARIANCE=.45,Ve.MIN_FINDER_PATTERN_RATIO=9.5/12,Ve.MAX_FINDER_PATTERN_RATIO=12.5/14;class ze{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof ze))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Ge{constructor(e,t,r,n,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new me(r,i)),this.resultPoints.push(new me(n,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof Ge))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class Ye{constructor(){}static getRSSvalue(e,t,r){let n=0;for(let a of e)n+=a;let i=0,s=0,o=e.length;for(let a=0;a<o-1;a++){let l;for(l=1,s|=1<<a;l<e[a];l++,s&=~(1<<a)){let e=Ye.combins(n-l-1,o-a-2);if(r&&0===s&&n-l-(o-a-1)>=o-a-1&&(e-=Ye.combins(n-l-(o-a),o-a-2)),o-a-1>1){let r=0;for(let e=n-l-(o-a-2);e>t;e--)r+=Ye.combins(n-l-e-1,o-a-3);e-=r*(o-1-a)}else n-l>t&&e--;i+=e}n-=l}return i}static combins(e,t){let r,n;e-t>t?(n=t,r=e-t):(n=e-t,r=t);let i=1,s=1;for(let o=e;o>r;o--)i*=o,s<=n&&(i/=s,s++);for(;s<=n;)i/=s,s++;return i}}class We{static buildBitArray(e){let t=2*e.length-1;null==e[e.length-1].getRightChar()&&(t-=1);let r=new y(12*t),n=0,i=e[0].getRightChar().getValue();for(let s=11;s>=0;--s)i&1<<s&&r.set(n),n++;for(let s=1;s<e.length;++s){let t=e[s],i=t.getLeftChar().getValue();for(let e=11;e>=0;--e)i&1<<e&&r.set(n),n++;if(null!=t.getRightChar()){let e=t.getRightChar().getValue();for(let t=11;t>=0;--t)e&1<<t&&r.set(n),n++}}return r}}class Xe{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Ze{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class Qe extends Ze{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===Qe.FNC1}}Qe.FNC1="$";class qe extends Ze{constructor(e,t,r){super(e),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Ke extends Ze{constructor(e,t,r){if(super(e),t<0||t>10||r<0||r>10)throw new I;this.firstDigit=t,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return 10*this.firstDigit+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Ke.FNC1}isSecondDigitFNC1(){return this.secondDigit===Ke.FNC1}isAnyFNC1(){return this.firstDigit===Ke.FNC1||this.secondDigit===Ke.FNC1}}Ke.FNC1=10;class $e{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new R;let t=e.substring(0,2);for(let i of $e.TWO_DIGIT_DATA_LENGTH)if(i[0]===t)return i[1]===$e.VARIABLE_LENGTH?$e.processVariableAI(2,i[2],e):$e.processFixedAI(2,i[1],e);if(e.length<3)throw new R;let r=e.substring(0,3);for(let i of $e.THREE_DIGIT_DATA_LENGTH)if(i[0]===r)return i[1]===$e.VARIABLE_LENGTH?$e.processVariableAI(3,i[2],e):$e.processFixedAI(3,i[1],e);for(let i of $e.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(i[0]===r)return i[1]===$e.VARIABLE_LENGTH?$e.processVariableAI(4,i[2],e):$e.processFixedAI(4,i[1],e);if(e.length<4)throw new R;let n=e.substring(0,4);for(let i of $e.FOUR_DIGIT_DATA_LENGTH)if(i[0]===n)return i[1]===$e.VARIABLE_LENGTH?$e.processVariableAI(4,i[2],e):$e.processFixedAI(4,i[1],e);throw new R}static processFixedAI(e,t,r){if(r.length<e)throw new R;let n=r.substring(0,e);if(r.length<e+t)throw new R;let i=r.substring(e,e+t),s=r.substring(e+t),o="("+n+")"+i,a=$e.parseFieldsInGeneralPurpose(s);return null==a?o:o+a}static processVariableAI(e,t,r){let n,i=r.substring(0,e);n=r.length<e+t?r.length:e+t;let s=r.substring(e,n),o=r.substring(n),a="("+i+")"+s,l=$e.parseFieldsInGeneralPurpose(o);return null==l?a:a+l}}$e.VARIABLE_LENGTH=[],$e.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",$e.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",$e.VARIABLE_LENGTH,20],["22",$e.VARIABLE_LENGTH,29],["30",$e.VARIABLE_LENGTH,8],["37",$e.VARIABLE_LENGTH,8],["90",$e.VARIABLE_LENGTH,30],["91",$e.VARIABLE_LENGTH,30],["92",$e.VARIABLE_LENGTH,30],["93",$e.VARIABLE_LENGTH,30],["94",$e.VARIABLE_LENGTH,30],["95",$e.VARIABLE_LENGTH,30],["96",$e.VARIABLE_LENGTH,30],["97",$e.VARIABLE_LENGTH,3],["98",$e.VARIABLE_LENGTH,30],["99",$e.VARIABLE_LENGTH,30]],$e.THREE_DIGIT_DATA_LENGTH=[["240",$e.VARIABLE_LENGTH,30],["241",$e.VARIABLE_LENGTH,30],["242",$e.VARIABLE_LENGTH,6],["250",$e.VARIABLE_LENGTH,30],["251",$e.VARIABLE_LENGTH,30],["253",$e.VARIABLE_LENGTH,17],["254",$e.VARIABLE_LENGTH,20],["400",$e.VARIABLE_LENGTH,30],["401",$e.VARIABLE_LENGTH,30],["402",17],["403",$e.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",$e.VARIABLE_LENGTH,20],["421",$e.VARIABLE_LENGTH,15],["422",3],["423",$e.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],$e.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",$e.VARIABLE_LENGTH,15],["391",$e.VARIABLE_LENGTH,18],["392",$e.VARIABLE_LENGTH,15],["393",$e.VARIABLE_LENGTH,18],["703",$e.VARIABLE_LENGTH,30]],$e.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",$e.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",$e.VARIABLE_LENGTH,20],["8003",$e.VARIABLE_LENGTH,30],["8004",$e.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",$e.VARIABLE_LENGTH,30],["8008",$e.VARIABLE_LENGTH,12],["8018",18],["8020",$e.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",$e.VARIABLE_LENGTH,70],["8200",$e.VARIABLE_LENGTH,70]];class Je{constructor(e){this.buffer=new D,this.information=e}decodeAllCodes(e,t){let r=t,n=null;for(;;){let t=this.decodeGeneralPurposeField(r,n),i=$e.parseFieldsInGeneralPurpose(t.getNewString());if(null!=i&&e.append(i),n=t.isRemaining()?""+t.getRemainingValue():null,r===t.getNewPosition())break;r=t.getNewPosition()}return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let t=this.extractNumericValueFromBitArray(e,4);return new Ke(this.information.getSize(),0===t?Ke.FNC1:t-1,Ke.FNC1)}let t=this.extractNumericValueFromBitArray(e,7);return new Ke(e+7,(t-8)/11,(t-8)%11)}extractNumericValueFromBitArray(e,t){return Je.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,r){let n=0;for(let i=0;i<r;++i)e.get(t+i)&&(n|=1<<r-i-1);return n}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),null!=t&&this.buffer.append(t),this.current.setPosition(e);let r=this.parseBlocks();return null!=r&&r.isRemaining()?new qe(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new qe(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let r=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),r===this.current.getPosition()&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return t=e.isSecondDigitFNC1()?new qe(this.current.getPosition(),this.buffer.toString()):new qe(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Xe(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let e=new qe(this.current.getPosition(),this.buffer.toString());return new Xe(!0,e)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Xe(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new qe(this.current.getPosition(),this.buffer.toString());return new Xe(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Xe(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let e=new qe(this.current.getPosition(),this.buffer.toString());return new Xe(!0,e)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Xe(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<116)return!0;if(e+8>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(e,8);return n>=232&&n<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new Qe(e+5,Qe.FNC1);if(t>=5&&t<15)return new Qe(e+5,"0"+(t-5));let r,n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new Qe(e+7,""+(n+1));if(n>=90&&n<116)return new Qe(e+7,""+(n+7));switch(this.extractNumericValueFromBitArray(e,8)){case 232:r="!";break;case 233:r='"';break;case 234:r="%";break;case 235:r="&";break;case 236:r="'";break;case 237:r="(";break;case 238:r=")";break;case 239:r="*";break;case 240:r="+";break;case 241:r=",";break;case 242:r="-";break;case 243:r=".";break;case 244:r="/";break;case 245:r=":";break;case 246:r=";";break;case 247:r="<";break;case 248:r="=";break;case 249:r=">";break;case 250:r="?";break;case 251:r="_";break;case 252:r=" ";break;default:throw new I}return new Qe(e+8,r)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,6);return r>=16&&r<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(15===t)return new Qe(e+5,Qe.FNC1);if(t>=5&&t<15)return new Qe(e+5,"0"+(t-5));let r,n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new Qe(e+6,""+(n+33));switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new de("Decoding invalid alphanumeric value: "+n)}return new Qe(e+6,r)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(2===t){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class et{constructor(e){this.information=e,this.generalDecoder=new Je(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class tt extends et{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let r=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,r)}encodeCompressedGtinWithoutAI(e,t,r){for(let n=0;n<4;++n){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*n,10);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r)}tt.appendCheckDigit(e,r)}static appendCheckDigit(e,t){let r=0;for(let n=0;n<13;n++){let i=e.charAt(n+t).charCodeAt(0)-"0".charCodeAt(0);r+=1&n?i:3*i}r=10-r%10,10===r&&(r=0),e.append(r)}}tt.GTIN_SIZE=40;class rt extends tt{constructor(e){super(e)}parseInformation(){let e=new D;e.append("(01)");let t=e.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(rt.HEADER_SIZE,4);return e.append(r),this.encodeCompressedGtinWithoutAI(e,rt.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,rt.HEADER_SIZE+44)}}rt.HEADER_SIZE=4;class nt extends et{constructor(e){super(e)}parseInformation(){let e=new D;return this.getGeneralDecoder().decodeAllCodes(e,nt.HEADER_SIZE)}}nt.HEADER_SIZE=5;class it extends tt{constructor(e){super(e)}encodeCompressedWeight(e,t,r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(t,r);this.addWeightCode(e,n);let i=this.checkWeight(n),s=1e5;for(let o=0;o<5;++o)i/s===0&&e.append("0"),s/=10;e.append(i)}}class st extends it{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=st.HEADER_SIZE+it.GTIN_SIZE+st.WEIGHT_SIZE)throw new R;let e=new D;return this.encodeCompressedGtin(e,st.HEADER_SIZE),this.encodeCompressedWeight(e,st.HEADER_SIZE+it.GTIN_SIZE,st.WEIGHT_SIZE),e.toString()}}st.HEADER_SIZE=5,st.WEIGHT_SIZE=15;class ot extends st{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class at extends st{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class lt extends tt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<lt.HEADER_SIZE+tt.GTIN_SIZE)throw new R;let e=new D;this.encodeCompressedGtin(e,lt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(lt.HEADER_SIZE+tt.GTIN_SIZE,lt.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(lt.HEADER_SIZE+tt.GTIN_SIZE+lt.LAST_DIGIT_SIZE,null);return e.append(r.getNewString()),e.toString()}}lt.HEADER_SIZE=8,lt.LAST_DIGIT_SIZE=2;class ct extends tt{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<ct.HEADER_SIZE+tt.GTIN_SIZE)throw new R;let e=new D;this.encodeCompressedGtin(e,ct.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(ct.HEADER_SIZE+tt.GTIN_SIZE,ct.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(ct.HEADER_SIZE+tt.GTIN_SIZE+ct.LAST_DIGIT_SIZE,ct.FIRST_THREE_DIGITS_SIZE);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r);let n=this.getGeneralDecoder().decodeGeneralPurposeField(ct.HEADER_SIZE+tt.GTIN_SIZE+ct.LAST_DIGIT_SIZE+ct.FIRST_THREE_DIGITS_SIZE,null);return e.append(n.getNewString()),e.toString()}}ct.HEADER_SIZE=8,ct.LAST_DIGIT_SIZE=2,ct.FIRST_THREE_DIGITS_SIZE=10;class dt extends it{constructor(e,t,r){super(e),this.dateCode=r,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=dt.HEADER_SIZE+dt.GTIN_SIZE+dt.WEIGHT_SIZE+dt.DATE_SIZE)throw new R;let e=new D;return this.encodeCompressedGtin(e,dt.HEADER_SIZE),this.encodeCompressedWeight(e,dt.HEADER_SIZE+dt.GTIN_SIZE,dt.WEIGHT_SIZE),this.encodeCompressedDate(e,dt.HEADER_SIZE+dt.GTIN_SIZE+dt.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,dt.DATE_SIZE);if(38400==r)return;e.append("("),e.append(this.dateCode),e.append(")");let n=r%32;r/=32;let i=r%12+1;r/=12;let s=r;s/10==0&&e.append("0"),e.append(s),i/10==0&&e.append("0"),e.append(i),n/10==0&&e.append("0"),e.append(n)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}function ht(e){try{if(e.get(1))return new rt(e);if(!e.get(2))return new nt(e);switch(Je.extractNumericValueFromBitArray(e,1,4)){case 4:return new ot(e);case 5:return new at(e)}switch(Je.extractNumericValueFromBitArray(e,1,5)){case 12:return new lt(e);case 13:return new ct(e)}switch(Je.extractNumericValueFromBitArray(e,1,7)){case 56:return new dt(e,"310","11");case 57:return new dt(e,"320","11");case 58:return new dt(e,"310","13");case 59:return new dt(e,"320","13");case 60:return new dt(e,"310","15");case 61:return new dt(e,"320","15");case 62:return new dt(e,"310","17");case 63:return new dt(e,"320","17")}}catch(Re){throw new de("unknown decoder: "+e)}}dt.HEADER_SIZE=8,dt.WEIGHT_SIZE=20,dt.DATE_SIZE=16;class ut{constructor(e,t,r,n){this.leftchar=e,this.rightchar=t,this.finderpattern=r,this.maybeLast=n}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return null==this.rightchar}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof ut&&ut.equalsOrNull(e.leftchar,t.leftchar)&&ut.equalsOrNull(e.rightchar,t.rightchar)&&ut.equalsOrNull(e.finderpattern,t.finderpattern)}static equalsOrNull(e,t){return null===e?null===t:ut.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ft{constructor(e,t,r){this.pairs=e,this.rowNumber=t,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof ft&&this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed}checkEqualitity(e,t){if(!e||!t)return;let r;return e.forEach((e,n)=>{t.forEach(t=>{e.getLeftChar().getValue()===t.getLeftChar().getValue()&&e.getRightChar().getValue()===t.getRightChar().getValue()&&e.getFinderPatter().getValue()===t.getFinderPatter().getValue()&&(r=!0)})}),r}}class gt extends Ve{constructor(e){super(...arguments),this.pairs=new Array(gt.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=!0===e}decodeRow(e,t,r){this.pairs.length=0,this.startFromEven=!1;try{return gt.constructResult(this.decodeRow2pairs(e,t))}catch(Re){this.verbose}return this.pairs.length=0,this.startFromEven=!0,gt.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let r,n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(i){if(i instanceof R){if(!this.pairs.length)throw new R;n=!0}}if(this.checkChecksum())return this.pairs;if(r=!!this.rows.length,this.storeRow(e,!1),r){let e=this.checkRowsBoolean(!1);if(null!=e)return e;if(e=this.checkRowsBoolean(!0),null!=e)return e}throw new R}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(Re){this.verbose}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let r=t;r<this.rows.length;r++){let t=this.rows[r];this.pairs.length=0;for(let r of e)this.pairs.push(r.getPairs());if(this.pairs.push(t.getPairs()),!gt.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let n=new Array(e);n.push(t);try{return this.checkRows(n,r+1)}catch(Re){this.verbose}}throw new R}static isValidSequence(e){for(let t of gt.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let r=!0;for(let n=0;n<e.length;n++)if(e[n].getFinderPattern().getValue()!=t[n]){r=!1;break}if(r)return!0}return!1}storeRow(e,t){let r=0,n=!1,i=!1;for(;r<this.rows.length;){let t=this.rows[r];if(t.getRowNumber()>e){i=t.isEquivalent(this.pairs);break}n=t.isEquivalent(this.pairs),r++}i||n||gt.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new ft(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let r of t)if(r.getPairs().length!==e.length)for(let t of r.getPairs())for(let r of e)if(ut.equals(t,r))break}static isPartialRow(e,t){for(let r of t){let t=!0;for(let n of e){let e=!1;for(let t of r.getPairs())if(n.equals(t)){e=!0;break}if(!e){t=!1;break}}if(t)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=ht(We.buildBitArray(e)).parseInformation(),r=e[0].getFinderPattern().getResultPoints(),n=e[e.length-1].getFinderPattern().getResultPoints(),i=[r[0],r[1],n[0],n[1]];return new V(t,null,null,i,Y.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),r=e.getRightChar();if(null==r)return!1;let n=r.getChecksumPortion(),i=2;for(let s=1;s<this.pairs.size();++s){let e=this.pairs.get(s);n+=e.getLeftChar().getChecksumPortion(),i++;let t=e.getRightChar();null!=t&&(n+=t.getChecksumPortion(),i++)}return n%=211,211*(i-4)+n==t.getValue()}static getNextSecondBar(e,t){let r;return e.get(t)?(r=e.getNextUnset(t),r=e.getNextSet(r)):(r=e.getNextSet(t),r=e.getNextUnset(r)),r}retrieveNextPair(e,t,r){let n,i=t.length%2==0;this.startFromEven&&(i=!i);let s=!0,o=-1;do{this.findNextPair(e,t,o),n=this.parseFoundFinderPattern(e,r,i),null==n?o=gt.getNextSecondBar(e,this.startEnd[0]):s=!1}while(s);let a,l=this.decodeDataCharacter(e,n,i,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new R;try{a=this.decodeDataCharacter(e,n,i,!1)}catch(Re){a=null,this.verbose}return new ut(l,a,n,!0)}isEmptyPair(e){return 0===e.length}findNextPair(e,t,r){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i,s=e.getSize();i=r>=0?r:this.isEmptyPair(t)?0:t[t.length-1].getFinderPattern().getStartEnd()[1];let o=t.length%2!=0;this.startFromEven&&(o=!o);let a=!1;for(;i<s&&(a=!e.get(i),a);)i++;let l=0,c=i;for(let d=i;d<s;d++)if(e.get(d)!=a)n[l]++;else{if(3==l){if(o&&gt.reverseCounters(n),gt.isFinderPattern(n))return this.startEnd[0]=c,void(this.startEnd[1]=d);o&&gt.reverseCounters(n),c+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,l--}else l++;n[l]=1,a=!a}throw new R}static reverseCounters(e){let t=e.length;for(let r=0;r<t/2;++r){let n=e[r];e[r]=e[t-r-1],e[t-r-1]=n}}parseFoundFinderPattern(e,t,r){let n,i,s;if(r){let t=this.startEnd[0]-1;for(;t>=0&&!e.get(t);)t--;t++,n=this.startEnd[0]-t,i=t,s=this.startEnd[1]}else i=this.startEnd[0],s=e.getNextUnset(this.startEnd[1]+1),n=s-this.startEnd[1];let o,a=this.getDecodeFinderCounters();m.arraycopy(a,0,a,1,a.length-1),a[0]=n;try{o=this.parseFinderValue(a,gt.FINDER_PATTERNS)}catch(Re){return null}return new Ge(o,[i,s],i,s,t)}decodeDataCharacter(e,t,r,n){let i=this.getDataCharacterCounters();for(let I=0;I<i.length;I++)i[I]=0;if(n)gt.recordPatternInReverse(e,t.getStartEnd()[0],i);else{gt.recordPattern(e,t.getStartEnd()[1],i);for(let e=0,t=i.length-1;e<t;e++,t--){let r=i[e];i[e]=i[t],i[t]=r}}let s=17,o=fe.sum(new Int32Array(i))/s,a=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(o-a)/a>.3)throw new R;let l=this.getOddCounts(),c=this.getEvenCounts(),d=this.getOddRoundingErrors(),h=this.getEvenRoundingErrors();for(let I=0;I<i.length;I++){let e=1*i[I]/o,t=e+.5;if(t<1){if(e<.3)throw new R;t=1}else if(t>8){if(e>8.7)throw new R;t=8}let r=I/2;1&I?(c[r]=t,h[r]=e-t):(l[r]=t,d[r]=e-t)}this.adjustOddEvenCounts(s);let u=4*t.getValue()+(r?0:2)+(n?0:1)-1,f=0,g=0;for(let I=l.length-1;I>=0;I--){if(gt.isNotA1left(t,r,n)){let e=gt.WEIGHTS[u][2*I];g+=l[I]*e}f+=l[I]}let m=0;for(let I=c.length-1;I>=0;I--)if(gt.isNotA1left(t,r,n)){let e=gt.WEIGHTS[u][2*I+1];m+=c[I]*e}let p=g+m;if(1&f||f>13||f<4)throw new R;let w=(13-f)/2,A=gt.SYMBOL_WIDEST[w],C=9-A,y=Ye.getRSSvalue(l,A,!0),E=Ye.getRSSvalue(c,C,!1),_=gt.EVEN_TOTAL_SUBSET[w],S=gt.GSUM[w];return new ze(y*_+E+S,p)}static isNotA1left(e,t,r){return!(0==e.getValue()&&t&&r)}adjustOddEvenCounts(e){let t=fe.sum(new Int32Array(this.getOddCounts())),r=fe.sum(new Int32Array(this.getEvenCounts())),n=!1,i=!1;t>13?i=!0:t<4&&(n=!0);let s=!1,o=!1;r>13?o=!0:r<4&&(s=!0);let a=t+r-e,l=!(1&~t),c=!(1&r);if(1==a)if(l){if(c)throw new R;i=!0}else{if(!c)throw new R;o=!0}else if(-1==a)if(l){if(c)throw new R;n=!0}else{if(!c)throw new R;s=!0}else{if(0!=a)throw new R;if(l){if(!c)throw new R;t<r?(n=!0,o=!0):(i=!0,s=!0)}else if(c)throw new R}if(n){if(i)throw new R;gt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&gt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(o)throw new R;gt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}o&&gt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}gt.SYMBOL_WIDEST=[7,5,4,3,1],gt.EVEN_TOTAL_SUBSET=[4,20,52,104,204],gt.GSUM=[0,348,1388,2948,3988],gt.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],gt.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],gt.FINDER_PAT_A=0,gt.FINDER_PAT_B=1,gt.FINDER_PAT_C=2,gt.FINDER_PAT_D=3,gt.FINDER_PAT_E=4,gt.FINDER_PAT_F=5,gt.FINDER_PATTERN_SEQUENCES=[[gt.FINDER_PAT_A,gt.FINDER_PAT_A],[gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B],[gt.FINDER_PAT_A,gt.FINDER_PAT_C,gt.FINDER_PAT_B,gt.FINDER_PAT_D],[gt.FINDER_PAT_A,gt.FINDER_PAT_E,gt.FINDER_PAT_B,gt.FINDER_PAT_D,gt.FINDER_PAT_C],[gt.FINDER_PAT_A,gt.FINDER_PAT_E,gt.FINDER_PAT_B,gt.FINDER_PAT_D,gt.FINDER_PAT_D,gt.FINDER_PAT_F],[gt.FINDER_PAT_A,gt.FINDER_PAT_E,gt.FINDER_PAT_B,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_F,gt.FINDER_PAT_F],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_D],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_E],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_F,gt.FINDER_PAT_F],[gt.FINDER_PAT_A,gt.FINDER_PAT_A,gt.FINDER_PAT_B,gt.FINDER_PAT_B,gt.FINDER_PAT_C,gt.FINDER_PAT_D,gt.FINDER_PAT_D,gt.FINDER_PAT_E,gt.FINDER_PAT_E,gt.FINDER_PAT_F,gt.FINDER_PAT_F]],gt.MAX_PAIRS=11;class mt extends ze{constructor(e,t,r){super(e,t),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class pt extends Ve{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,r){const n=this.decodePair(t,!1,e,r);pt.addOrTally(this.possibleLeftPairs,n),t.reverse();let i=this.decodePair(t,!0,e,r);pt.addOrTally(this.possibleRightPairs,i),t.reverse();for(let s of this.possibleLeftPairs)if(s.getCount()>1)for(let e of this.possibleRightPairs)if(e.getCount()>1&&pt.checkChecksum(s,e))return pt.constructResult(s,e);throw new R}static addOrTally(e,t){if(null==t)return;let r=!1;for(let n of e)if(n.getValue()===t.getValue()){n.incrementCount(),r=!0;break}r||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let r=4537077*e.getValue()+t.getValue(),n=new String(r).toString(),i=new D;for(let l=13-n.length;l>0;l--)i.append("0");i.append(n);let s=0;for(let l=0;l<13;l++){let e=i.charAt(l).charCodeAt(0)-"0".charCodeAt(0);s+=1&l?e:3*e}s=10-s%10,10===s&&(s=0),i.append(s.toString());let o=e.getFinderPattern().getResultPoints(),a=t.getFinderPattern().getResultPoints();return new V(i.toString(),null,0,[o[0],o[1],a[0],a[1]],Y.RSS_14,(new Date).getTime())}static checkChecksum(e,t){let r=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,n=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return n>72&&n--,n>8&&n--,r===n}decodePair(e,t,r,n){try{let i=this.findFinderPattern(e,t),s=this.parseFoundFinderPattern(e,r,t,i),o=null==n?null:n.get(S.NEED_RESULT_POINT_CALLBACK);if(null!=o){let n=(i[0]+i[1])/2;t&&(n=e.getSize()-1-n),o.foundPossibleResultPoint(new me(n,r))}let a=this.decodeDataCharacter(e,s,!0),l=this.decodeDataCharacter(e,s,!1);return new mt(1597*a.getValue()+l.getValue(),a.getChecksumPortion()+4*l.getChecksumPortion(),s)}catch(i){return null}}decodeDataCharacter(e,t,r){let n=this.getDataCharacterCounters();for(let m=0;m<n.length;m++)n[m]=0;if(r)be.recordPatternInReverse(e,t.getStartEnd()[0],n);else{be.recordPattern(e,t.getStartEnd()[1]+1,n);for(let e=0,t=n.length-1;e<t;e++,t--){let r=n[e];n[e]=n[t],n[t]=r}}let i=r?16:15,s=fe.sum(new Int32Array(n))/i,o=this.getOddCounts(),a=this.getEvenCounts(),l=this.getOddRoundingErrors(),c=this.getEvenRoundingErrors();for(let m=0;m<n.length;m++){let e=n[m]/s,t=Math.floor(e+.5);t<1?t=1:t>8&&(t=8);let r=Math.floor(m/2);1&m?(a[r]=t,c[r]=e-t):(o[r]=t,l[r]=e-t)}this.adjustOddEvenCounts(r,i);let d=0,h=0;for(let m=o.length-1;m>=0;m--)h*=9,h+=o[m],d+=o[m];let u=0,f=0;for(let m=a.length-1;m>=0;m--)u*=9,u+=a[m],f+=a[m];let g=h+3*u;if(r){if(1&d||d>12||d<4)throw new R;let e=(12-d)/2,t=pt.OUTSIDE_ODD_WIDEST[e],r=9-t,n=Ye.getRSSvalue(o,t,!1),i=Ye.getRSSvalue(a,r,!0),s=pt.OUTSIDE_EVEN_TOTAL_SUBSET[e],l=pt.OUTSIDE_GSUM[e];return new ze(n*s+i+l,g)}{if(1&f||f>10||f<4)throw new R;let e=(10-f)/2,t=pt.INSIDE_ODD_WIDEST[e],r=9-t,n=Ye.getRSSvalue(o,t,!0),i=Ye.getRSSvalue(a,r,!1),s=pt.INSIDE_ODD_TOTAL_SUBSET[e],l=pt.INSIDE_GSUM[e];return new ze(i*s+n+l,g)}}findFinderPattern(e,t){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let n=e.getSize(),i=!1,s=0;for(;s<n&&(i=!e.get(s),t!==i);)s++;let o=0,a=s;for(let l=s;l<n;l++)if(e.get(l)!==i)r[o]++;else{if(3===o){if(Ve.isFinderPattern(r))return[a,l];a+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,o--}else o++;r[o]=1,i=!i}throw new R}parseFoundFinderPattern(e,t,r,n){let i=e.get(n[0]),s=n[0]-1;for(;s>=0&&i!==e.get(s);)s--;s++;const o=n[0]-s,a=this.getDecodeFinderCounters(),l=new Int32Array(a.length);m.arraycopy(a,0,l,1,a.length-1),l[0]=o;const c=this.parseFinderValue(l,pt.FINDER_PATTERNS);let d=s,h=n[1];return r&&(d=e.getSize()-1-d,h=e.getSize()-1-h),new Ge(c,[s,n[1]],d,h,t)}adjustOddEvenCounts(e,t){let r=fe.sum(new Int32Array(this.getOddCounts())),n=fe.sum(new Int32Array(this.getEvenCounts())),i=!1,s=!1,o=!1,a=!1;e?(r>12?s=!0:r<4&&(i=!0),n>12?a=!0:n<4&&(o=!0)):(r>11?s=!0:r<5&&(i=!0),n>10?a=!0:n<4&&(o=!0));let l=r+n-t,c=(1&r)==(e?1:0),d=!(1&~n);if(1===l)if(c){if(d)throw new R;s=!0}else{if(!d)throw new R;a=!0}else if(-1===l)if(c){if(d)throw new R;i=!0}else{if(!d)throw new R;o=!0}else{if(0!==l)throw new R;if(c){if(!d)throw new R;r<n?(i=!0,a=!0):(s=!0,o=!0)}else if(d)throw new R}if(i){if(s)throw new R;Ve.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&Ve.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(a)throw new R;Ve.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&Ve.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}pt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],pt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],pt.OUTSIDE_GSUM=[0,161,961,2015,2715],pt.INSIDE_GSUM=[0,336,1036,1516],pt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],pt.INSIDE_ODD_WIDEST=[2,4,6,8],pt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class wt extends be{constructor(e,t){super(),this.readers=[],this.verbose=!0===t;const r=e?e.get(S.POSSIBLE_FORMATS):null,n=e&&void 0!==e.get(S.ASSUME_CODE_39_CHECK_DIGIT);r?((r.includes(Y.EAN_13)||r.includes(Y.UPC_A)||r.includes(Y.EAN_8)||r.includes(Y.UPC_E))&&this.readers.push(new He(e)),r.includes(Y.CODE_39)&&this.readers.push(new De(n)),r.includes(Y.CODE_128)&&this.readers.push(new xe),r.includes(Y.ITF)&&this.readers.push(new Me),r.includes(Y.RSS_14)&&this.readers.push(new pt),r.includes(Y.RSS_EXPANDED)&&this.readers.push(new gt(this.verbose))):(this.readers.push(new He(e)),this.readers.push(new De),this.readers.push(new He(e)),this.readers.push(new xe),this.readers.push(new Me),this.readers.push(new pt),this.readers.push(new gt(this.verbose)))}decodeRow(e,t,r){for(let i=0;i<this.readers.length;i++)try{return this.readers[i].decodeRow(e,t,r)}catch(n){}throw new R}reset(){this.readers.forEach(e=>e.reset())}}class At extends H{constructor(e=500,t){super(new wt(t),e,t)}}class Ct{constructor(e,t,r){this.ecCodewords=e,this.ecBlocks=[t],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class yt{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Et{constructor(e,t,r,n,i,s){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=r,this.dataRegionSizeRows=n,this.dataRegionSizeColumns=i,this.ecBlocks=s;let o=0;const a=s.getECCodewords(),l=s.getECBlocks();for(let c of l)o+=c.getCount()*(c.getDataCodewords()+a);this.totalCodewords=o}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(1&e||1&t)throw new I;for(let r of Et.VERSIONS)if(r.symbolSizeRows===e&&r.symbolSizeColumns===t)return r;throw new I}toString(){return""+this.versionNumber}static buildVersions(){return[new Et(1,10,10,8,8,new Ct(5,new yt(1,3))),new Et(2,12,12,10,10,new Ct(7,new yt(1,5))),new Et(3,14,14,12,12,new Ct(10,new yt(1,8))),new Et(4,16,16,14,14,new Ct(12,new yt(1,12))),new Et(5,18,18,16,16,new Ct(14,new yt(1,18))),new Et(6,20,20,18,18,new Ct(18,new yt(1,22))),new Et(7,22,22,20,20,new Ct(20,new yt(1,30))),new Et(8,24,24,22,22,new Ct(24,new yt(1,36))),new Et(9,26,26,24,24,new Ct(28,new yt(1,44))),new Et(10,32,32,14,14,new Ct(36,new yt(1,62))),new Et(11,36,36,16,16,new Ct(42,new yt(1,86))),new Et(12,40,40,18,18,new Ct(48,new yt(1,114))),new Et(13,44,44,20,20,new Ct(56,new yt(1,144))),new Et(14,48,48,22,22,new Ct(68,new yt(1,174))),new Et(15,52,52,24,24,new Ct(42,new yt(2,102))),new Et(16,64,64,14,14,new Ct(56,new yt(2,140))),new Et(17,72,72,16,16,new Ct(36,new yt(4,92))),new Et(18,80,80,18,18,new Ct(48,new yt(4,114))),new Et(19,88,88,20,20,new Ct(56,new yt(4,144))),new Et(20,96,96,22,22,new Ct(68,new yt(4,174))),new Et(21,104,104,24,24,new Ct(56,new yt(6,136))),new Et(22,120,120,18,18,new Ct(68,new yt(6,175))),new Et(23,132,132,20,20,new Ct(62,new yt(8,163))),new Et(24,144,144,22,22,new Ct(62,new yt(8,156),new yt(2,155))),new Et(25,8,18,6,16,new Ct(7,new yt(1,5))),new Et(26,8,32,6,14,new Ct(11,new yt(1,10))),new Et(27,12,26,10,24,new Ct(14,new yt(1,16))),new Et(28,12,36,10,16,new Ct(18,new yt(1,22))),new Et(29,16,36,14,16,new Ct(24,new yt(1,32))),new Et(30,16,48,14,22,new Ct(28,new yt(1,49)))]}}Et.VERSIONS=Et.buildVersions();class _t{constructor(e){const t=e.getHeight();if(t<8||t>144||1&t)throw new I;this.version=_t.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new M(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),r=e.getWidth();return Et.getVersionForDimensions(t,r)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,r=4,n=0;const i=this.mappingBitMatrix.getHeight(),s=this.mappingBitMatrix.getWidth();let o=!1,a=!1,l=!1,c=!1;do{if(r!==i||0!==n||o)if(r===i-2&&0===n&&3&s&&!a)e[t++]=255&this.readCorner2(i,s),r-=2,n+=2,a=!0;else if(r!==i+4||2!==n||7&s||l)if(r!==i-2||0!==n||4!=(7&s)||c){do{r<i&&n>=0&&!this.readMappingMatrix.get(n,r)&&(e[t++]=255&this.readUtah(r,n,i,s)),r-=2,n+=2}while(r>=0&&n<s);r+=1,n+=3;do{r>=0&&n<s&&!this.readMappingMatrix.get(n,r)&&(e[t++]=255&this.readUtah(r,n,i,s)),r+=2,n-=2}while(r<i&&n>=0);r+=3,n+=1}else e[t++]=255&this.readCorner4(i,s),r-=2,n+=2,c=!0;else e[t++]=255&this.readCorner3(i,s),r-=2,n+=2,l=!0;else e[t++]=255&this.readCorner1(i,s),r-=2,n+=2,o=!0}while(r<i||n<s);if(t!==this.version.getTotalCodewords())throw new I;return e}readModule(e,t,r,n){return e<0&&(e+=r,t+=4-(r+4&7)),t<0&&(t+=n,e+=4-(n+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,r,n){let i=0;return this.readModule(e-2,t-2,r,n)&&(i|=1),i<<=1,this.readModule(e-2,t-1,r,n)&&(i|=1),i<<=1,this.readModule(e-1,t-2,r,n)&&(i|=1),i<<=1,this.readModule(e-1,t-1,r,n)&&(i|=1),i<<=1,this.readModule(e-1,t,r,n)&&(i|=1),i<<=1,this.readModule(e,t-2,r,n)&&(i|=1),i<<=1,this.readModule(e,t-1,r,n)&&(i|=1),i<<=1,this.readModule(e,t,r,n)&&(i|=1),i}readCorner1(e,t){let r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,1,e,t)&&(r|=1),r<<=1,this.readModule(e-1,2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r}readCorner2(e,t){let r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-4,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r}readCorner3(e,t){let r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-3,e,t)&&(r|=1),r<<=1,this.readModule(1,t-2,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r}readCorner4(e,t){let r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new h("Dimension of bitMatrix must match the version size");const n=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),s=t/n|0,o=r/i|0,a=new M(o*i,s*n);for(let l=0;l<s;++l){const t=l*n;for(let r=0;r<o;++r){const s=r*i;for(let o=0;o<n;++o){const c=l*(n+2)+1+o,d=t+o;for(let t=0;t<i;++t){const n=r*(i+2)+1+t;if(e.get(n,c)){const e=s+t;a.set(e,d)}}}}}return a}}class St{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const r=t.getECBlocks();let n=0;const i=r.getECBlocks();for(let h of i)n+=h.getCount();const s=new Array(n);let o=0;for(let h of i)for(let e=0;e<h.getCount();e++){const e=h.getDataCodewords(),t=r.getECCodewords()+e;s[o++]=new St(e,new Uint8Array(t))}const a=s[0].codewords.length-r.getECCodewords(),l=a-1;let c=0;for(let h=0;h<l;h++)for(let t=0;t<o;t++)s[t].codewords[h]=e[c++];const d=24===t.getVersionNumber(),u=d?8:o;for(let h=0;h<u;h++)s[h].codewords[a-1]=e[c++];const f=s[0].codewords.length;for(let h=a;h<f;h++)for(let t=0;t<o;t++){const r=d?(t+8)%o:t,n=d&&r>7?h-1:h;s[r].codewords[n]=e[c++]}if(c!==e.length)throw new h;return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class It{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new h(""+e);let t=0,r=this.bitOffset,n=this.byteOffset;const i=this.bytes;if(r>0){const s=8-r,o=e<s?e:s,a=s-o,l=255>>8-o<<a;t=(i[n]&l)>>a,e-=o,r+=o,8===r&&(r=0,n++)}if(e>0){for(;e>=8;)t=t<<8|255&i[n],n++,e-=8;if(e>0){const s=8-e,o=255>>s<<s;t=t<<e|(i[n]&o)>>s,r+=e}}return this.bitOffset=r,this.byteOffset=n,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}(J=X||(X={}))[J.PAD_ENCODE=0]="PAD_ENCODE",J[J.ASCII_ENCODE=1]="ASCII_ENCODE",J[J.C40_ENCODE=2]="C40_ENCODE",J[J.TEXT_ENCODE=3]="TEXT_ENCODE",J[J.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",J[J.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",J[J.BASE256_ENCODE=6]="BASE256_ENCODE";class Nt{static decode(e){const t=new It(e),r=new D,n=new D,i=new Array;let s=X.ASCII_ENCODE;do{if(s===X.ASCII_ENCODE)s=this.decodeAsciiSegment(t,r,n);else{switch(s){case X.C40_ENCODE:this.decodeC40Segment(t,r);break;case X.TEXT_ENCODE:this.decodeTextSegment(t,r);break;case X.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,r);break;case X.EDIFACT_ENCODE:this.decodeEdifactSegment(t,r);break;case X.BASE256_ENCODE:this.decodeBase256Segment(t,r,i);break;default:throw new I}s=X.ASCII_ENCODE}}while(s!==X.PAD_ENCODE&&t.available()>0);return n.length()>0&&r.append(n.toString()),new ie(e,r.toString(),0===i.length?null:i,null)}static decodeAsciiSegment(e,t,r){let n=!1;do{let i=e.readBits(8);if(0===i)throw new I;if(i<=128)return n&&(i+=128),t.append(String.fromCharCode(i-1)),X.ASCII_ENCODE;if(129===i)return X.PAD_ENCODE;if(i<=229){const e=i-130;e<10&&t.append("0"),t.append(""+e)}else switch(i){case 230:return X.C40_ENCODE;case 231:return X.BASE256_ENCODE;case 232:t.append(String.fromCharCode(29));break;case 233:case 234:case 241:break;case 235:n=!0;break;case 236:t.append("[)>05"),r.insert(0,"");break;case 237:t.append("[)>06"),r.insert(0,"");break;case 238:return X.ANSIX12_ENCODE;case 239:return X.TEXT_ENCODE;case 240:return X.EDIFACT_ENCODE;default:if(254!==i||0!==e.available())throw new I}}while(e.available()>0);return X.ASCII_ENCODE}static decodeC40Segment(e,t){let r=!1;const n=[];let i=0;do{if(8===e.available())return;const s=e.readBits(8);if(254===s)return;this.parseTwoBytes(s,e.readBits(8),n);for(let e=0;e<3;e++){const s=n[e];switch(i){case 0:if(s<3)i=s+1;else{if(!(s<this.C40_BASIC_SET_CHARS.length))throw new I;{const e=this.C40_BASIC_SET_CHARS[s];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}}break;case 1:r?(t.append(String.fromCharCode(s+128)),r=!1):t.append(String.fromCharCode(s)),i=0;break;case 2:if(s<this.C40_SHIFT2_SET_CHARS.length){const e=this.C40_SHIFT2_SET_CHARS[s];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}else switch(s){case 27:t.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new I}i=0;break;case 3:r?(t.append(String.fromCharCode(s+224)),r=!1):t.append(String.fromCharCode(s+96)),i=0;break;default:throw new I}}}while(e.available()>0)}static decodeTextSegment(e,t){let r=!1,n=[],i=0;do{if(8===e.available())return;const s=e.readBits(8);if(254===s)return;this.parseTwoBytes(s,e.readBits(8),n);for(let e=0;e<3;e++){const s=n[e];switch(i){case 0:if(s<3)i=s+1;else{if(!(s<this.TEXT_BASIC_SET_CHARS.length))throw new I;{const e=this.TEXT_BASIC_SET_CHARS[s];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}}break;case 1:r?(t.append(String.fromCharCode(s+128)),r=!1):t.append(String.fromCharCode(s)),i=0;break;case 2:if(s<this.TEXT_SHIFT2_SET_CHARS.length){const e=this.TEXT_SHIFT2_SET_CHARS[s];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e)}else switch(s){case 27:t.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new I}i=0;break;case 3:if(!(s<this.TEXT_SHIFT3_SET_CHARS.length))throw new I;{const e=this.TEXT_SHIFT3_SET_CHARS[s];r?(t.append(String.fromCharCode(e.charCodeAt(0)+128)),r=!1):t.append(e),i=0}break;default:throw new I}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const r=[];do{if(8===e.available())return;const n=e.readBits(8);if(254===n)return;this.parseTwoBytes(n,e.readBits(8),r);for(let e=0;e<3;e++){const n=r[e];switch(n){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(n<14)t.append(String.fromCharCode(n+44));else{if(!(n<40))throw new I;t.append(String.fromCharCode(n+51))}}}}while(e.available()>0)}static parseTwoBytes(e,t,r){let n=(e<<8)+t-1,i=Math.floor(n/1600);r[0]=i,n-=1600*i,i=Math.floor(n/40),r[1]=i,r[2]=n-40*i}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let r=0;r<4;r++){let r=e.readBits(6);if(31===r){const t=8-e.getBitOffset();return void(8!==t&&e.readBits(t))}32&r||(r|=64),t.append(String.fromCharCode(r))}}while(e.available()>0)}static decodeBase256Segment(e,t,r){let n=1+e.getByteOffset();const i=this.unrandomize255State(e.readBits(8),n++);let s;if(s=0===i?e.available()/8|0:i<250?i:250*(i-249)+this.unrandomize255State(e.readBits(8),n++),s<0)throw new I;const o=new Uint8Array(s);for(let l=0;l<s;l++){if(e.available()<8)throw new I;o[l]=this.unrandomize255State(e.readBits(8),n++)}r.push(o);try{t.append(b.decode(o,x.ISO88591))}catch(a){throw new de("Platform does not support required encoding: "+a.message)}}static unrandomize255State(e,t){const r=e-(149*t%255+1);return r>=0?r:r+256}}Nt.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Nt.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Nt.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Nt.TEXT_SHIFT2_SET_CHARS=Nt.C40_SHIFT2_SET_CHARS,Nt.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Tt{constructor(){this.rsDecoder=new he(le.DATA_MATRIX_FIELD_256)}decode(e){const t=new _t(e),r=t.getVersion(),n=t.readCodewords(),i=St.getDataBlocks(n,r);let s=0;for(let l of i)s+=l.getNumDataCodewords();const o=new Uint8Array(s),a=i.length;for(let l=0;l<a;l++){const e=i[l],t=e.getCodewords(),r=e.getNumDataCodewords();this.correctErrors(t,r);for(let n=0;n<r;n++)o[n*a+l]=t[n]}return Nt.decode(o)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch(n){throw new f}for(let i=0;i<t;i++)e[i]=r[i]}}class bt{constructor(e){this.image=e,this.rectangleDetector=new Ae(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new R;t=this.shiftToModuleCenter(t);const r=t[0],n=t[1],i=t[2],s=t[3];let o=this.transitionsBetween(r,s)+1,a=this.transitionsBetween(i,s)+1;1&~o||(o+=1),1&~a||(a+=1),4*o<7*a&&4*a<7*o&&(o=a=Math.max(o,a));let l=bt.sampleGrid(this.image,r,n,i,s,o,a);return new pe(l,[r,n,i,s])}static shiftPoint(e,t,r){let n=(t.getX()-e.getX())/(r+1),i=(t.getY()-e.getY())/(r+1);return new me(e.getX()+n,e.getY()+i)}static moveAway(e,t,r){let n=e.getX(),i=e.getY();return n<t?n-=1:n+=1,i<r?i-=1:i+=1,new me(n,i)}detectSolid1(e){let t=e[0],r=e[1],n=e[3],i=e[2],s=this.transitionsBetween(t,r),o=this.transitionsBetween(r,n),a=this.transitionsBetween(n,i),l=this.transitionsBetween(i,t),c=s,d=[i,t,r,n];return c>o&&(c=o,d[0]=t,d[1]=r,d[2]=n,d[3]=i),c>a&&(c=a,d[0]=r,d[1]=n,d[2]=i,d[3]=t),c>l&&(d[0]=n,d[1]=i,d[2]=t,d[3]=r),d}detectSolid2(e){let t=e[0],r=e[1],n=e[2],i=e[3],s=this.transitionsBetween(t,i),o=bt.shiftPoint(r,n,4*(s+1)),a=bt.shiftPoint(n,r,4*(s+1));return this.transitionsBetween(o,t)<this.transitionsBetween(a,i)?(e[0]=t,e[1]=r,e[2]=n,e[3]=i):(e[0]=r,e[1]=n,e[2]=i,e[3]=t),e}correctTopRight(e){let t=e[0],r=e[1],n=e[2],i=e[3],s=this.transitionsBetween(t,i),o=this.transitionsBetween(r,i),a=bt.shiftPoint(t,r,4*(o+1)),l=bt.shiftPoint(n,r,4*(s+1));s=this.transitionsBetween(a,i),o=this.transitionsBetween(l,i);let c=new me(i.getX()+(n.getX()-r.getX())/(s+1),i.getY()+(n.getY()-r.getY())/(s+1)),d=new me(i.getX()+(t.getX()-r.getX())/(o+1),i.getY()+(t.getY()-r.getY())/(o+1));return this.isValid(c)?this.isValid(d)?this.transitionsBetween(a,c)+this.transitionsBetween(l,c)>this.transitionsBetween(a,d)+this.transitionsBetween(l,d)?c:d:c:this.isValid(d)?d:null}shiftToModuleCenter(e){let t=e[0],r=e[1],n=e[2],i=e[3],s=this.transitionsBetween(t,i)+1,o=this.transitionsBetween(n,i)+1,a=bt.shiftPoint(t,r,4*o),l=bt.shiftPoint(n,r,4*s);s=this.transitionsBetween(a,i)+1,o=this.transitionsBetween(l,i)+1,1&~s||(s+=1),1&~o||(o+=1);let c,d,h=(t.getX()+r.getX()+n.getX()+i.getX())/4,u=(t.getY()+r.getY()+n.getY()+i.getY())/4;return t=bt.moveAway(t,h,u),r=bt.moveAway(r,h,u),n=bt.moveAway(n,h,u),i=bt.moveAway(i,h,u),a=bt.shiftPoint(t,r,4*o),a=bt.shiftPoint(a,i,4*s),c=bt.shiftPoint(r,t,4*o),c=bt.shiftPoint(c,n,4*s),l=bt.shiftPoint(n,i,4*o),l=bt.shiftPoint(l,r,4*s),d=bt.shiftPoint(i,n,4*o),d=bt.shiftPoint(d,t,4*s),[a,c,l,d]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,r,n,i,s,o){return _e.getInstance().sampleGrid(e,s,o,.5,.5,s-.5,.5,s-.5,o-.5,.5,o-.5,t.getX(),t.getY(),i.getX(),i.getY(),n.getX(),n.getY(),r.getX(),r.getY())}transitionsBetween(e,t){let r=Math.trunc(e.getX()),n=Math.trunc(e.getY()),i=Math.trunc(t.getX()),s=Math.trunc(t.getY()),o=Math.abs(s-n)>Math.abs(i-r);if(o){let e=r;r=n,n=e,e=i,i=s,s=e}let a=Math.abs(i-r),l=Math.abs(s-n),c=-a/2,d=n<s?1:-1,h=r<i?1:-1,u=0,f=this.image.get(o?n:r,o?r:n);for(let g=r,m=n;g!==i;g+=h){let e=this.image.get(o?m:g,o?g:m);if(e!==f&&(u++,f=e),c+=l,c>0){if(m===s)break;m+=d,c-=a}}return u}}class xt{constructor(){this.decoder=new Tt}decode(e,t=null){let r,n;if(null!=t&&t.has(S.PURE_BARCODE)){const t=xt.extractPureBits(e.getBlackMatrix());r=this.decoder.decode(t),n=xt.NO_POINTS}else{const t=new bt(e.getBlackMatrix()).detect();r=this.decoder.decode(t.getBits()),n=t.getPoints()}const i=r.getRawBytes(),s=new V(r.getText(),i,8*i.length,n,Y.DATA_MATRIX,m.currentTimeMillis()),o=r.getByteSegments();null!=o&&s.putMetadata(ne.BYTE_SEGMENTS,o);const a=r.getECLevel();return null!=a&&s.putMetadata(ne.ERROR_CORRECTION_LEVEL,a),s}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(null==t||null==r)throw new R;const n=this.moduleSize(t,e);let i=t[1];const s=r[1];let o=t[0];const a=(r[0]-o+1)/n,l=(s-i+1)/n;if(a<=0||l<=0)throw new R;const c=n/2;i+=c,o+=c;const d=new M(a,l);for(let h=0;h<l;h++){const t=i+h*n;for(let r=0;r<a;r++)e.get(o+r*n,t)&&d.set(r,h)}return d}static moduleSize(e,t){const r=t.getWidth();let n=e[0];const i=e[1];for(;n<r&&t.get(n,i);)n++;if(n===r)throw new R;const s=n-e[0];if(0===s)throw new R;return s}}xt.NO_POINTS=[];class Dt extends H{constructor(e=500){super(new xt,e)}}(ee=Z||(Z={}))[ee.L=0]="L",ee[ee.M=1]="M",ee[ee.Q=2]="Q",ee[ee.H=3]="H";class Mt{constructor(e,t,r){this.value=e,this.stringValue=t,this.bits=r,Mt.FOR_BITS.set(r,this),Mt.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return Mt.L;case"M":return Mt.M;case"Q":return Mt.Q;case"H":return Mt.H;default:throw new d(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof Mt))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=Mt.FOR_BITS.size)throw new h;return Mt.FOR_BITS.get(e)}}Mt.FOR_BITS=new Map,Mt.FOR_VALUE=new Map,Mt.L=new Mt(Z.L,"L",1),Mt.M=new Mt(Z.M,"M",0),Mt.Q=new Mt(Z.Q,"Q",3),Mt.H=new Mt(Z.H,"H",2);class Rt{constructor(e){this.errorCorrectionLevel=Mt.forBits(e>>3&3),this.dataMask=7&e}static numBitsDiffering(e,t){return C.bitCount(e^t)}static decodeFormatInformation(e,t){const r=Rt.doDecodeFormatInformation(e,t);return null!==r?r:Rt.doDecodeFormatInformation(e^Rt.FORMAT_INFO_MASK_QR,t^Rt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let r=Number.MAX_SAFE_INTEGER,n=0;for(const i of Rt.FORMAT_INFO_DECODE_LOOKUP){const s=i[0];if(s===e||s===t)return new Rt(i[1]);let o=Rt.numBitsDiffering(e,s);o<r&&(n=i[1],r=o),e!==t&&(o=Rt.numBitsDiffering(t,s),o<r&&(n=i[1],r=o))}return r<=3?new Rt(n):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof Rt))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}Rt.FORMAT_INFO_MASK_QR=21522,Rt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class vt{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const r of t)e+=r.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Ot{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Pt{constructor(e,t,...r){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=r;let n=0;const i=r[0].getECCodewordsPerBlock(),s=r[0].getECBlocks();for(const o of s)n+=o.getCount()*(o.getDataCodewords()+i);this.totalCodewords=n}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!=1)throw new I;try{return this.getVersionForNumber((e-17)/4)}catch(t){throw new I}}static getVersionForNumber(e){if(e<1||e>40)throw new h;return Pt.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,r=0;for(let n=0;n<Pt.VERSION_DECODE_INFO.length;n++){const i=Pt.VERSION_DECODE_INFO[n];if(i===e)return Pt.getVersionForNumber(n+7);const s=Rt.numBitsDiffering(e,i);s<t&&(r=n+7,t=s)}return t<=3?Pt.getVersionForNumber(r):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new M(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const r=this.alignmentPatternCenters.length;for(let n=0;n<r;n++){const e=this.alignmentPatternCenters[n]-2;for(let i=0;i<r;i++)0===n&&(0===i||i===r-1)||n===r-1&&0===i||t.setRegion(this.alignmentPatternCenters[i]-2,e,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}Pt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Pt.VERSIONS=[new Pt(1,new Int32Array(0),new vt(7,new Ot(1,19)),new vt(10,new Ot(1,16)),new vt(13,new Ot(1,13)),new vt(17,new Ot(1,9))),new Pt(2,Int32Array.from([6,18]),new vt(10,new Ot(1,34)),new vt(16,new Ot(1,28)),new vt(22,new Ot(1,22)),new vt(28,new Ot(1,16))),new Pt(3,Int32Array.from([6,22]),new vt(15,new Ot(1,55)),new vt(26,new Ot(1,44)),new vt(18,new Ot(2,17)),new vt(22,new Ot(2,13))),new Pt(4,Int32Array.from([6,26]),new vt(20,new Ot(1,80)),new vt(18,new Ot(2,32)),new vt(26,new Ot(2,24)),new vt(16,new Ot(4,9))),new Pt(5,Int32Array.from([6,30]),new vt(26,new Ot(1,108)),new vt(24,new Ot(2,43)),new vt(18,new Ot(2,15),new Ot(2,16)),new vt(22,new Ot(2,11),new Ot(2,12))),new Pt(6,Int32Array.from([6,34]),new vt(18,new Ot(2,68)),new vt(16,new Ot(4,27)),new vt(24,new Ot(4,19)),new vt(28,new Ot(4,15))),new Pt(7,Int32Array.from([6,22,38]),new vt(20,new Ot(2,78)),new vt(18,new Ot(4,31)),new vt(18,new Ot(2,14),new Ot(4,15)),new vt(26,new Ot(4,13),new Ot(1,14))),new Pt(8,Int32Array.from([6,24,42]),new vt(24,new Ot(2,97)),new vt(22,new Ot(2,38),new Ot(2,39)),new vt(22,new Ot(4,18),new Ot(2,19)),new vt(26,new Ot(4,14),new Ot(2,15))),new Pt(9,Int32Array.from([6,26,46]),new vt(30,new Ot(2,116)),new vt(22,new Ot(3,36),new Ot(2,37)),new vt(20,new Ot(4,16),new Ot(4,17)),new vt(24,new Ot(4,12),new Ot(4,13))),new Pt(10,Int32Array.from([6,28,50]),new vt(18,new Ot(2,68),new Ot(2,69)),new vt(26,new Ot(4,43),new Ot(1,44)),new vt(24,new Ot(6,19),new Ot(2,20)),new vt(28,new Ot(6,15),new Ot(2,16))),new Pt(11,Int32Array.from([6,30,54]),new vt(20,new Ot(4,81)),new vt(30,new Ot(1,50),new Ot(4,51)),new vt(28,new Ot(4,22),new Ot(4,23)),new vt(24,new Ot(3,12),new Ot(8,13))),new Pt(12,Int32Array.from([6,32,58]),new vt(24,new Ot(2,92),new Ot(2,93)),new vt(22,new Ot(6,36),new Ot(2,37)),new vt(26,new Ot(4,20),new Ot(6,21)),new vt(28,new Ot(7,14),new Ot(4,15))),new Pt(13,Int32Array.from([6,34,62]),new vt(26,new Ot(4,107)),new vt(22,new Ot(8,37),new Ot(1,38)),new vt(24,new Ot(8,20),new Ot(4,21)),new vt(22,new Ot(12,11),new Ot(4,12))),new Pt(14,Int32Array.from([6,26,46,66]),new vt(30,new Ot(3,115),new Ot(1,116)),new vt(24,new Ot(4,40),new Ot(5,41)),new vt(20,new Ot(11,16),new Ot(5,17)),new vt(24,new Ot(11,12),new Ot(5,13))),new Pt(15,Int32Array.from([6,26,48,70]),new vt(22,new Ot(5,87),new Ot(1,88)),new vt(24,new Ot(5,41),new Ot(5,42)),new vt(30,new Ot(5,24),new Ot(7,25)),new vt(24,new Ot(11,12),new Ot(7,13))),new Pt(16,Int32Array.from([6,26,50,74]),new vt(24,new Ot(5,98),new Ot(1,99)),new vt(28,new Ot(7,45),new Ot(3,46)),new vt(24,new Ot(15,19),new Ot(2,20)),new vt(30,new Ot(3,15),new Ot(13,16))),new Pt(17,Int32Array.from([6,30,54,78]),new vt(28,new Ot(1,107),new Ot(5,108)),new vt(28,new Ot(10,46),new Ot(1,47)),new vt(28,new Ot(1,22),new Ot(15,23)),new vt(28,new Ot(2,14),new Ot(17,15))),new Pt(18,Int32Array.from([6,30,56,82]),new vt(30,new Ot(5,120),new Ot(1,121)),new vt(26,new Ot(9,43),new Ot(4,44)),new vt(28,new Ot(17,22),new Ot(1,23)),new vt(28,new Ot(2,14),new Ot(19,15))),new Pt(19,Int32Array.from([6,30,58,86]),new vt(28,new Ot(3,113),new Ot(4,114)),new vt(26,new Ot(3,44),new Ot(11,45)),new vt(26,new Ot(17,21),new Ot(4,22)),new vt(26,new Ot(9,13),new Ot(16,14))),new Pt(20,Int32Array.from([6,34,62,90]),new vt(28,new Ot(3,107),new Ot(5,108)),new vt(26,new Ot(3,41),new Ot(13,42)),new vt(30,new Ot(15,24),new Ot(5,25)),new vt(28,new Ot(15,15),new Ot(10,16))),new Pt(21,Int32Array.from([6,28,50,72,94]),new vt(28,new Ot(4,116),new Ot(4,117)),new vt(26,new Ot(17,42)),new vt(28,new Ot(17,22),new Ot(6,23)),new vt(30,new Ot(19,16),new Ot(6,17))),new Pt(22,Int32Array.from([6,26,50,74,98]),new vt(28,new Ot(2,111),new Ot(7,112)),new vt(28,new Ot(17,46)),new vt(30,new Ot(7,24),new Ot(16,25)),new vt(24,new Ot(34,13))),new Pt(23,Int32Array.from([6,30,54,78,102]),new vt(30,new Ot(4,121),new Ot(5,122)),new vt(28,new Ot(4,47),new Ot(14,48)),new vt(30,new Ot(11,24),new Ot(14,25)),new vt(30,new Ot(16,15),new Ot(14,16))),new Pt(24,Int32Array.from([6,28,54,80,106]),new vt(30,new Ot(6,117),new Ot(4,118)),new vt(28,new Ot(6,45),new Ot(14,46)),new vt(30,new Ot(11,24),new Ot(16,25)),new vt(30,new Ot(30,16),new Ot(2,17))),new Pt(25,Int32Array.from([6,32,58,84,110]),new vt(26,new Ot(8,106),new Ot(4,107)),new vt(28,new Ot(8,47),new Ot(13,48)),new vt(30,new Ot(7,24),new Ot(22,25)),new vt(30,new Ot(22,15),new Ot(13,16))),new Pt(26,Int32Array.from([6,30,58,86,114]),new vt(28,new Ot(10,114),new Ot(2,115)),new vt(28,new Ot(19,46),new Ot(4,47)),new vt(28,new Ot(28,22),new Ot(6,23)),new vt(30,new Ot(33,16),new Ot(4,17))),new Pt(27,Int32Array.from([6,34,62,90,118]),new vt(30,new Ot(8,122),new Ot(4,123)),new vt(28,new Ot(22,45),new Ot(3,46)),new vt(30,new Ot(8,23),new Ot(26,24)),new vt(30,new Ot(12,15),new Ot(28,16))),new Pt(28,Int32Array.from([6,26,50,74,98,122]),new vt(30,new Ot(3,117),new Ot(10,118)),new vt(28,new Ot(3,45),new Ot(23,46)),new vt(30,new Ot(4,24),new Ot(31,25)),new vt(30,new Ot(11,15),new Ot(31,16))),new Pt(29,Int32Array.from([6,30,54,78,102,126]),new vt(30,new Ot(7,116),new Ot(7,117)),new vt(28,new Ot(21,45),new Ot(7,46)),new vt(30,new Ot(1,23),new Ot(37,24)),new vt(30,new Ot(19,15),new Ot(26,16))),new Pt(30,Int32Array.from([6,26,52,78,104,130]),new vt(30,new Ot(5,115),new Ot(10,116)),new vt(28,new Ot(19,47),new Ot(10,48)),new vt(30,new Ot(15,24),new Ot(25,25)),new vt(30,new Ot(23,15),new Ot(25,16))),new Pt(31,Int32Array.from([6,30,56,82,108,134]),new vt(30,new Ot(13,115),new Ot(3,116)),new vt(28,new Ot(2,46),new Ot(29,47)),new vt(30,new Ot(42,24),new Ot(1,25)),new vt(30,new Ot(23,15),new Ot(28,16))),new Pt(32,Int32Array.from([6,34,60,86,112,138]),new vt(30,new Ot(17,115)),new vt(28,new Ot(10,46),new Ot(23,47)),new vt(30,new Ot(10,24),new Ot(35,25)),new vt(30,new Ot(19,15),new Ot(35,16))),new Pt(33,Int32Array.from([6,30,58,86,114,142]),new vt(30,new Ot(17,115),new Ot(1,116)),new vt(28,new Ot(14,46),new Ot(21,47)),new vt(30,new Ot(29,24),new Ot(19,25)),new vt(30,new Ot(11,15),new Ot(46,16))),new Pt(34,Int32Array.from([6,34,62,90,118,146]),new vt(30,new Ot(13,115),new Ot(6,116)),new vt(28,new Ot(14,46),new Ot(23,47)),new vt(30,new Ot(44,24),new Ot(7,25)),new vt(30,new Ot(59,16),new Ot(1,17))),new Pt(35,Int32Array.from([6,30,54,78,102,126,150]),new vt(30,new Ot(12,121),new Ot(7,122)),new vt(28,new Ot(12,47),new Ot(26,48)),new vt(30,new Ot(39,24),new Ot(14,25)),new vt(30,new Ot(22,15),new Ot(41,16))),new Pt(36,Int32Array.from([6,24,50,76,102,128,154]),new vt(30,new Ot(6,121),new Ot(14,122)),new vt(28,new Ot(6,47),new Ot(34,48)),new vt(30,new Ot(46,24),new Ot(10,25)),new vt(30,new Ot(2,15),new Ot(64,16))),new Pt(37,Int32Array.from([6,28,54,80,106,132,158]),new vt(30,new Ot(17,122),new Ot(4,123)),new vt(28,new Ot(29,46),new Ot(14,47)),new vt(30,new Ot(49,24),new Ot(10,25)),new vt(30,new Ot(24,15),new Ot(46,16))),new Pt(38,Int32Array.from([6,32,58,84,110,136,162]),new vt(30,new Ot(4,122),new Ot(18,123)),new vt(28,new Ot(13,46),new Ot(32,47)),new vt(30,new Ot(48,24),new Ot(14,25)),new vt(30,new Ot(42,15),new Ot(32,16))),new Pt(39,Int32Array.from([6,26,54,82,110,138,166]),new vt(30,new Ot(20,117),new Ot(4,118)),new vt(28,new Ot(40,47),new Ot(7,48)),new vt(30,new Ot(43,24),new Ot(22,25)),new vt(30,new Ot(10,15),new Ot(67,16))),new Pt(40,Int32Array.from([6,30,58,86,114,142,170]),new vt(30,new Ot(19,118),new Ot(6,119)),new vt(28,new Ot(18,47),new Ot(31,48)),new vt(30,new Ot(34,24),new Ot(34,25)),new vt(30,new Ot(20,15),new Ot(61,16)))],(te=Q||(Q={}))[te.DATA_MASK_000=0]="DATA_MASK_000",te[te.DATA_MASK_001=1]="DATA_MASK_001",te[te.DATA_MASK_010=2]="DATA_MASK_010",te[te.DATA_MASK_011=3]="DATA_MASK_011",te[te.DATA_MASK_100=4]="DATA_MASK_100",te[te.DATA_MASK_101=5]="DATA_MASK_101",te[te.DATA_MASK_110=6]="DATA_MASK_110",te[te.DATA_MASK_111=7]="DATA_MASK_111";class Bt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let r=0;r<t;r++)for(let n=0;n<t;n++)this.isMasked(r,n)&&e.flip(n,r)}}Bt.values=new Map([[Q.DATA_MASK_000,new Bt(Q.DATA_MASK_000,(e,t)=>!(e+t&1))],[Q.DATA_MASK_001,new Bt(Q.DATA_MASK_001,(e,t)=>!(1&e))],[Q.DATA_MASK_010,new Bt(Q.DATA_MASK_010,(e,t)=>t%3==0)],[Q.DATA_MASK_011,new Bt(Q.DATA_MASK_011,(e,t)=>(e+t)%3==0)],[Q.DATA_MASK_100,new Bt(Q.DATA_MASK_100,(e,t)=>!(Math.floor(e/2)+Math.floor(t/3)&1))],[Q.DATA_MASK_101,new Bt(Q.DATA_MASK_101,(e,t)=>e*t%6==0)],[Q.DATA_MASK_110,new Bt(Q.DATA_MASK_110,(e,t)=>e*t%6<3)],[Q.DATA_MASK_111,new Bt(Q.DATA_MASK_111,(e,t)=>!(e+t+e*t%3&1))]]);class Lt{constructor(e){const t=e.getHeight();if(t<21||1!=(3&t))throw new I;this.bitMatrix=e}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let e=0;for(let i=0;i<6;i++)e=this.copyBit(i,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let i=5;i>=0;i--)e=this.copyBit(8,i,e);const t=this.bitMatrix.getHeight();let r=0;const n=t-7;for(let i=t-1;i>=n;i--)r=this.copyBit(8,i,r);for(let i=t-8;i<t;i++)r=this.copyBit(i,8,r);if(this.parsedFormatInfo=Rt.decodeFormatInformation(e,r),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new I}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Pt.getVersionForNumber(t);let r=0;const n=e-11;for(let s=5;s>=0;s--)for(let t=e-9;t>=n;t--)r=this.copyBit(t,s,r);let i=Pt.decodeVersionInformation(r);if(null!==i&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;r=0;for(let s=5;s>=0;s--)for(let t=e-9;t>=n;t--)r=this.copyBit(s,t,r);if(i=Pt.decodeVersionInformation(r),null!==i&&i.getDimensionForVersion()===e)return this.parsedVersion=i,i;throw new I}copyBit(e,t,r){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?r<<1|1:r<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),r=Bt.values.get(e.getDataMask()),n=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,n);const i=t.buildFunctionPattern();let s=!0;const o=new Uint8Array(t.getTotalCodewords());let a=0,l=0,c=0;for(let d=n-1;d>0;d-=2){6===d&&d--;for(let e=0;e<n;e++){const t=s?n-1-e:e;for(let e=0;e<2;e++)i.get(d-e,t)||(c++,l<<=1,this.bitMatrix.get(d-e,t)&&(l|=1),8===c&&(o[a++]=l,c=0,l=0))}s=!s}if(a!==t.getTotalCodewords())throw new I;return o}remask(){if(null===this.parsedFormatInfo)return;const e=Bt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,r=e.getWidth();t<r;t++)for(let n=t+1,i=e.getHeight();n<i;n++)e.get(t,n)!==e.get(n,t)&&(e.flip(n,t),e.flip(t,n))}}class kt{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,r){if(e.length!==t.getTotalCodewords())throw new h;const n=t.getECBlocksForLevel(r);let i=0;const s=n.getECBlocks();for(const h of s)i+=h.getCount();const o=new Array(i);let a=0;for(const h of s)for(let e=0;e<h.getCount();e++){const e=h.getDataCodewords(),t=n.getECCodewordsPerBlock()+e;o[a++]=new kt(e,new Uint8Array(t))}const l=o[0].codewords.length;let c=o.length-1;for(;c>=0&&o[c].codewords.length!==l;)c--;c++;const d=l-n.getECCodewordsPerBlock();let u=0;for(let h=0;h<d;h++)for(let t=0;t<a;t++)o[t].codewords[h]=e[u++];for(let h=c;h<a;h++)o[h].codewords[d]=e[u++];const f=o[0].codewords.length;for(let h=d;h<f;h++)for(let t=0;t<a;t++){const r=t<c?h:h+1;o[t].codewords[r]=e[u++]}return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}(re=q||(q={}))[re.TERMINATOR=0]="TERMINATOR",re[re.NUMERIC=1]="NUMERIC",re[re.ALPHANUMERIC=2]="ALPHANUMERIC",re[re.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",re[re.BYTE=4]="BYTE",re[re.ECI=5]="ECI",re[re.KANJI=6]="KANJI",re[re.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",re[re.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",re[re.HANZI=9]="HANZI";class jt{constructor(e,t,r,n){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=r,this.bits=n,jt.FOR_BITS.set(n,this),jt.FOR_VALUE.set(e,this)}static forBits(e){const t=jt.FOR_BITS.get(e);if(void 0===t)throw new h;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let r;return r=t<=9?0:t<=26?1:2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof jt))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}jt.FOR_BITS=new Map,jt.FOR_VALUE=new Map,jt.TERMINATOR=new jt(q.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),jt.NUMERIC=new jt(q.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),jt.ALPHANUMERIC=new jt(q.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),jt.STRUCTURED_APPEND=new jt(q.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),jt.BYTE=new jt(q.BYTE,"BYTE",Int32Array.from([8,16,16]),4),jt.ECI=new jt(q.ECI,"ECI",Int32Array.from([0,0,0]),7),jt.KANJI=new jt(q.KANJI,"KANJI",Int32Array.from([8,10,12]),8),jt.FNC1_FIRST_POSITION=new jt(q.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),jt.FNC1_SECOND_POSITION=new jt(q.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),jt.HANZI=new jt(q.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Ft{static decode(e,t,r,n){const i=new It(e);let s=new D;const o=new Array;let a=-1,l=-1;try{let e,r=null,c=!1;do{if(i.available()<4)e=jt.TERMINATOR;else{const t=i.readBits(4);e=jt.forBits(t)}switch(e){case jt.TERMINATOR:break;case jt.FNC1_FIRST_POSITION:case jt.FNC1_SECOND_POSITION:c=!0;break;case jt.STRUCTURED_APPEND:if(i.available()<16)throw new I;a=i.readBits(8),l=i.readBits(8);break;case jt.ECI:const d=Ft.parseECIValue(i);if(r=N.getCharacterSetECIByValue(d),null===r)throw new I;break;case jt.HANZI:const h=i.readBits(4),u=i.readBits(e.getCharacterCountBits(t));h===Ft.GB2312_SUBSET&&Ft.decodeHanziSegment(i,s,u);break;default:const f=i.readBits(e.getCharacterCountBits(t));switch(e){case jt.NUMERIC:Ft.decodeNumericSegment(i,s,f);break;case jt.ALPHANUMERIC:Ft.decodeAlphanumericSegment(i,s,f,c);break;case jt.BYTE:Ft.decodeByteSegment(i,s,f,r,o,n);break;case jt.KANJI:Ft.decodeKanjiSegment(i,s,f);break;default:throw new I}}}while(e!==jt.TERMINATOR)}catch(c){throw new I}return new ie(e,s.toString(),0===o.length?null:o,null===r?null:r.toString(),a,l)}static decodeHanziSegment(e,t,r){if(13*r>e.available())throw new I;const n=new Uint8Array(2*r);let i=0;for(;r>0;){const t=e.readBits(13);let s=t/96<<8&4294967295|t%96;s+=s<959?41377:42657,n[i]=s>>8&255,n[i+1]=255&s,i+=2,r--}try{t.append(b.decode(n,x.GB2312))}catch(s){throw new I(s)}}static decodeKanjiSegment(e,t,r){if(13*r>e.available())throw new I;const n=new Uint8Array(2*r);let i=0;for(;r>0;){const t=e.readBits(13);let s=t/192<<8&4294967295|t%192;s+=s<7936?33088:49472,n[i]=s>>8,n[i+1]=s,i+=2,r--}try{t.append(b.decode(n,x.SHIFT_JIS))}catch(s){throw new I(s)}}static decodeByteSegment(e,t,r,n,i,s){if(8*r>e.available())throw new I;const o=new Uint8Array(r);for(let c=0;c<r;c++)o[c]=e.readBits(8);let a;a=null===n?x.guessEncoding(o,s):n.getName();try{t.append(b.decode(o,a))}catch(l){throw new I(l)}i.push(o)}static toAlphaNumericChar(e){if(e>=Ft.ALPHANUMERIC_CHARS.length)throw new I;return Ft.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,r,n){const i=t.length();for(;r>1;){if(e.available()<11)throw new I;const n=e.readBits(11);t.append(Ft.toAlphaNumericChar(Math.floor(n/45))),t.append(Ft.toAlphaNumericChar(n%45)),r-=2}if(1===r){if(e.available()<6)throw new I;t.append(Ft.toAlphaNumericChar(e.readBits(6)))}if(n)for(let s=i;s<t.length();s++)"%"===t.charAt(s)&&(s<t.length()-1&&"%"===t.charAt(s+1)?t.deleteCharAt(s+1):t.setCharAt(s,String.fromCharCode(29)))}static decodeNumericSegment(e,t,r){for(;r>=3;){if(e.available()<10)throw new I;const n=e.readBits(10);if(n>=1e3)throw new I;t.append(Ft.toAlphaNumericChar(Math.floor(n/100))),t.append(Ft.toAlphaNumericChar(Math.floor(n/10)%10)),t.append(Ft.toAlphaNumericChar(n%10)),r-=3}if(2===r){if(e.available()<7)throw new I;const r=e.readBits(7);if(r>=100)throw new I;t.append(Ft.toAlphaNumericChar(Math.floor(r/10))),t.append(Ft.toAlphaNumericChar(r%10))}else if(1===r){if(e.available()<4)throw new I;const r=e.readBits(4);if(r>=10)throw new I;t.append(Ft.toAlphaNumericChar(r))}}static parseECIValue(e){const t=e.readBits(8);if(!(128&t))return 127&t;if(128==(192&t))return(63&t)<<8&4294967295|e.readBits(8);if(192==(224&t))return(31&t)<<16&4294967295|e.readBits(16);throw new I}}Ft.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Ft.GB2312_SUBSET=1;class Ut{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||null===e||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Ht{constructor(){this.rsDecoder=new he(le.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(M.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const r=new Lt(e);let n=null;try{return this.decodeBitMatrixParser(r,t)}catch(Re){n=Re}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const e=this.decodeBitMatrixParser(r,t);return e.setOther(new Ut(!0)),e}catch(Re){if(null!==n)throw n;throw Re}}decodeBitMatrixParser(e,t){const r=e.readVersion(),n=e.readFormatInformation().getErrorCorrectionLevel(),i=e.readCodewords(),s=kt.getDataBlocks(i,r,n);let o=0;for(const c of s)o+=c.getNumDataCodewords();const a=new Uint8Array(o);let l=0;for(const c of s){const e=c.getCodewords(),t=c.getNumDataCodewords();this.correctErrors(e,t);for(let r=0;r<t;r++)a[l++]=e[r]}return Ft.decode(a,r,n,t)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch(n){throw new f}for(let i=0;i<t;i++)e[i]=r[i]}}class Vt extends me{constructor(e,t,r){super(e,t),this.estimatedModuleSize=r}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const n=(this.getX()+t)/2,i=(this.getY()+e)/2,s=(this.estimatedModuleSize+r)/2;return new Vt(n,i,s)}}class zt{constructor(e,t,r,n,i,s,o){this.image=e,this.startX=t,this.startY=r,this.width=n,this.height=i,this.moduleSize=s,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,r=e+this.width,n=this.startY+t/2,i=new Int32Array(3),s=this.image;for(let o=0;o<t;o++){const t=n+(1&o?-Math.floor((o+1)/2):Math.floor((o+1)/2));i[0]=0,i[1]=0,i[2]=0;let a=e;for(;a<r&&!s.get(a,t);)a++;let l=0;for(;a<r;){if(s.get(a,t))if(1===l)i[1]++;else if(2===l){if(this.foundPatternCross(i)){const e=this.handlePossibleCenter(i,t,a);if(null!==e)return e}i[0]=i[2],i[1]=1,i[2]=0,l=1}else i[++l]++;else 1===l&&l++,i[l]++;a++}if(this.foundPatternCross(i)){const e=this.handlePossibleCenter(i,t,r);if(null!==e)return e}}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new R}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,r=t/2;for(let n=0;n<3;n++)if(Math.abs(t-e[n])>=r)return!1;return!0}crossCheckVertical(e,t,r,n){const i=this.image,s=i.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let a=e;for(;a>=0&&i.get(t,a)&&o[1]<=r;)o[1]++,a--;if(a<0||o[1]>r)return NaN;for(;a>=0&&!i.get(t,a)&&o[0]<=r;)o[0]++,a--;if(o[0]>r)return NaN;for(a=e+1;a<s&&i.get(t,a)&&o[1]<=r;)o[1]++,a++;if(a===s||o[1]>r)return NaN;for(;a<s&&!i.get(t,a)&&o[2]<=r;)o[2]++,a++;if(o[2]>r)return NaN;const l=o[0]+o[1]+o[2];return 5*Math.abs(l-n)>=2*n?NaN:this.foundPatternCross(o)?zt.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,r){const n=e[0]+e[1]+e[2],i=zt.centerFromEnd(e,r),s=this.crossCheckVertical(t,i,2*e[1],n);if(!isNaN(s)){const t=(e[0]+e[1]+e[2])/3;for(const e of this.possibleCenters)if(e.aboutEquals(t,s,i))return e.combineEstimate(s,i,t);const r=new Vt(i,s,t);this.possibleCenters.push(r),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(r)}return null}}class Gt extends me{constructor(e,t,r,n){super(e,t),this.estimatedModuleSize=r,this.count=n,void 0===n&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const t=Math.abs(e-this.estimatedModuleSize);return t<=1||t<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const n=this.count+1,i=(this.count*this.getX()+t)/n,s=(this.count*this.getY()+e)/n,o=(this.count*this.estimatedModuleSize+r)/n;return new Gt(i,s,o,n)}}class Yt{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Wt{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=null!=e&&void 0!==e.get(S.TRY_HARDER),r=null!=e&&void 0!==e.get(S.PURE_BARCODE),n=this.image,i=n.getHeight(),s=n.getWidth();let o=Math.floor(3*i/(4*Wt.MAX_MODULES));(o<Wt.MIN_SKIP||t)&&(o=Wt.MIN_SKIP);let a=!1;const l=new Int32Array(5);for(let d=o-1;d<i&&!a;d+=o){l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0;let e=0;for(let t=0;t<s;t++)if(n.get(t,d))1&~e||e++,l[e]++;else if(1&e)l[e]++;else if(4===e)if(Wt.foundPatternCross(l)){if(!0!==this.handlePossibleCenter(l,d,t,r)){l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,e=3;continue}if(o=2,!0===this.hasSkipped)a=this.haveMultiplyConfirmedCenters();else{const e=this.findRowSkip();e>l[2]&&(d+=e-l[2]-o,t=s-1)}e=0,l[0]=0,l[1]=0,l[2]=0,l[3]=0,l[4]=0}else l[0]=l[2],l[1]=l[3],l[2]=l[4],l[3]=1,l[4]=0,e=3;else l[++e]++;Wt.foundPatternCross(l)&&!0===this.handlePossibleCenter(l,d,s,r)&&(o=l[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}const c=this.selectBestPatterns();return me.orderBestPatterns(c),new Yt(c)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let i=0;i<5;i++){const r=e[i];if(0===r)return!1;t+=r}if(t<7)return!1;const r=t/7,n=r/2;return Math.abs(r-e[0])<n&&Math.abs(r-e[1])<n&&Math.abs(3*r-e[2])<3*n&&Math.abs(r-e[3])<n&&Math.abs(r-e[4])<n}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,r,n){const i=this.getCrossCheckStateCount();let s=0;const o=this.image;for(;e>=s&&t>=s&&o.get(t-s,e-s);)i[2]++,s++;if(e<s||t<s)return!1;for(;e>=s&&t>=s&&!o.get(t-s,e-s)&&i[1]<=r;)i[1]++,s++;if(e<s||t<s||i[1]>r)return!1;for(;e>=s&&t>=s&&o.get(t-s,e-s)&&i[0]<=r;)i[0]++,s++;if(i[0]>r)return!1;const a=o.getHeight(),l=o.getWidth();for(s=1;e+s<a&&t+s<l&&o.get(t+s,e+s);)i[2]++,s++;if(e+s>=a||t+s>=l)return!1;for(;e+s<a&&t+s<l&&!o.get(t+s,e+s)&&i[3]<r;)i[3]++,s++;if(e+s>=a||t+s>=l||i[3]>=r)return!1;for(;e+s<a&&t+s<l&&o.get(t+s,e+s)&&i[4]<r;)i[4]++,s++;if(i[4]>=r)return!1;const c=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(c-n)<2*n&&Wt.foundPatternCross(i)}crossCheckVertical(e,t,r,n){const i=this.image,s=i.getHeight(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&i.get(t,a);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(t,a)&&o[1]<=r;)o[1]++,a--;if(a<0||o[1]>r)return NaN;for(;a>=0&&i.get(t,a)&&o[0]<=r;)o[0]++,a--;if(o[0]>r)return NaN;for(a=e+1;a<s&&i.get(t,a);)o[2]++,a++;if(a===s)return NaN;for(;a<s&&!i.get(t,a)&&o[3]<r;)o[3]++,a++;if(a===s||o[3]>=r)return NaN;for(;a<s&&i.get(t,a)&&o[4]<r;)o[4]++,a++;if(o[4]>=r)return NaN;const l=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(l-n)>=2*n?NaN:Wt.foundPatternCross(o)?Wt.centerFromEnd(o,a):NaN}crossCheckHorizontal(e,t,r,n){const i=this.image,s=i.getWidth(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&i.get(a,t);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(a,t)&&o[1]<=r;)o[1]++,a--;if(a<0||o[1]>r)return NaN;for(;a>=0&&i.get(a,t)&&o[0]<=r;)o[0]++,a--;if(o[0]>r)return NaN;for(a=e+1;a<s&&i.get(a,t);)o[2]++,a++;if(a===s)return NaN;for(;a<s&&!i.get(a,t)&&o[3]<r;)o[3]++,a++;if(a===s||o[3]>=r)return NaN;for(;a<s&&i.get(a,t)&&o[4]<r;)o[4]++,a++;if(o[4]>=r)return NaN;const l=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(l-n)>=n?NaN:Wt.foundPatternCross(o)?Wt.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,r,n){const i=e[0]+e[1]+e[2]+e[3]+e[4];let s=Wt.centerFromEnd(e,r),o=this.crossCheckVertical(t,Math.floor(s),e[2],i);if(!isNaN(o)&&(s=this.crossCheckHorizontal(Math.floor(s),Math.floor(o),e[2],i),!isNaN(s)&&(!n||this.crossCheckDiagonal(Math.floor(o),Math.floor(s),e[2],i)))){const e=i/7;let t=!1;const r=this.possibleCenters;for(let n=0,i=r.length;n<i;n++){const i=r[n];if(i.aboutEquals(e,o,s)){r[n]=i.combineEstimate(o,s,e),t=!0;break}}if(!t){const t=new Gt(s,o,e);r.push(t),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(t)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let e=null;for(const t of this.possibleCenters)if(t.getCount()>=Wt.CENTER_QUORUM){if(null!=e)return this.hasSkipped=!0,Math.floor((Math.abs(e.getX()-t.getX())-Math.abs(e.getY()-t.getY()))/2);e=t}return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const r=this.possibleCenters.length;for(const s of this.possibleCenters)s.getCount()>=Wt.CENTER_QUORUM&&(e++,t+=s.getEstimatedModuleSize());if(e<3)return!1;const n=t/r;let i=0;for(const s of this.possibleCenters)i+=Math.abs(s.getEstimatedModuleSize()-n);return i<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new R;const t=this.possibleCenters;let r;if(e>3){let n=0,i=0;for(const e of this.possibleCenters){const t=e.getEstimatedModuleSize();n+=t,i+=t*t}r=n/e;let s=Math.sqrt(i/e-r*r);t.sort((e,t)=>{const n=Math.abs(t.getEstimatedModuleSize()-r),i=Math.abs(e.getEstimatedModuleSize()-r);return n<i?-1:n>i?1:0});const o=Math.max(.2*r,s);for(let e=0;e<t.length&&t.length>3;e++){const n=t[e];Math.abs(n.getEstimatedModuleSize()-r)>o&&(t.splice(e,1),e--)}}if(t.length>3){let e=0;for(const r of t)e+=r.getEstimatedModuleSize();r=e/t.length,t.sort((e,t)=>{if(t.getCount()===e.getCount()){const n=Math.abs(t.getEstimatedModuleSize()-r),i=Math.abs(e.getEstimatedModuleSize()-r);return n<i?1:n>i?-1:0}return t.getCount()-e.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}Wt.CENTER_QUORUM=2,Wt.MIN_SKIP=3,Wt.MAX_MODULES=57;class Xt{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=null==e?null:e.get(S.NEED_RESULT_POINT_CALLBACK);const t=new Wt(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(t)}processFinderPatternInfo(e){const t=e.getTopLeft(),r=e.getTopRight(),n=e.getBottomLeft(),i=this.calculateModuleSize(t,r,n);if(i<1)throw new R("No pattern found in proccess finder.");const s=Xt.computeDimension(t,r,n,i),o=Pt.getProvisionalVersionForDimension(s),a=o.getDimensionForVersion()-7;let l=null;if(o.getAlignmentPatternCenters().length>0){const e=r.getX()-t.getX()+n.getX(),s=r.getY()-t.getY()+n.getY(),o=1-3/a,c=Math.floor(t.getX()+o*(e-t.getX())),d=Math.floor(t.getY()+o*(s-t.getY()));for(let t=4;t<=16;t<<=1)try{l=this.findAlignmentInRegion(i,c,d,t);break}catch(u){if(!(u instanceof R))throw u}}const c=Xt.createTransform(t,r,n,l,s),d=Xt.sampleGrid(this.image,c,s);let h;return h=null===l?[n,t,r]:[n,t,r,l],new pe(d,h)}static createTransform(e,t,r,n,i){const s=i-3.5;let o,a,l,c;return null!==n?(o=n.getX(),a=n.getY(),l=s-3,c=l):(o=t.getX()-e.getX()+r.getX(),a=t.getY()-e.getY()+r.getY(),l=s,c=s),ye.quadrilateralToQuadrilateral(3.5,3.5,s,3.5,l,c,3.5,s,e.getX(),e.getY(),t.getX(),t.getY(),o,a,r.getX(),r.getY())}static sampleGrid(e,t,r){return _e.getInstance().sampleGridWithTransform(e,r,r,t)}static computeDimension(e,t,r,n){const i=fe.round(me.distance(e,t)/n),s=fe.round(me.distance(e,r)/n);let o=Math.floor((i+s)/2)+7;switch(3&o){case 0:o++;break;case 2:o--;break;case 3:throw new R("Dimensions could be not found.")}return o}calculateModuleSize(e,t,r){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,r))/2}calculateModuleSizeOneWay(e,t){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(r)?n/7:isNaN(n)?r/7:(r+n)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,r,n){let i=this.sizeOfBlackWhiteBlackRun(e,t,r,n),s=1,o=e-(r-e);o<0?(s=e/(e-o),o=0):o>=this.image.getWidth()&&(s=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);let a=Math.floor(t-(n-t)*s);return s=1,a<0?(s=t/(t-a),a=0):a>=this.image.getHeight()&&(s=(this.image.getHeight()-1-t)/(a-t),a=this.image.getHeight()-1),o=Math.floor(e+(o-e)*s),i+=this.sizeOfBlackWhiteBlackRun(e,t,o,a),i-1}sizeOfBlackWhiteBlackRun(e,t,r,n){const i=Math.abs(n-t)>Math.abs(r-e);if(i){let i=e;e=t,t=i,i=r,r=n,n=i}const s=Math.abs(r-e),o=Math.abs(n-t);let a=-s/2;const l=e<r?1:-1,c=t<n?1:-1;let d=0;const h=r+l;for(let u=e,f=t;u!==h;u+=l){const r=i?f:u,l=i?u:f;if(1===d===this.image.get(r,l)){if(2===d)return fe.distance(u,f,e,t);d++}if(a+=o,a>0){if(f===n)break;f+=c,a-=s}}return 2===d?fe.distance(r+l,n,e,t):NaN}findAlignmentInRegion(e,t,r,n){const i=Math.floor(n*e),s=Math.max(0,t-i),o=Math.min(this.image.getWidth()-1,t+i);if(o-s<3*e)throw new R("Alignment top exceeds estimated module size.");const a=Math.max(0,r-i),l=Math.min(this.image.getHeight()-1,r+i);if(l-a<3*e)throw new R("Alignment bottom exceeds estimated module size.");return new zt(this.image,s,a,o-s,l-a,e,this.resultPointCallback).find()}}class Zt{constructor(){this.decoder=new Ht}getDecoder(){return this.decoder}decode(e,t){let r,n;if(null!=t&&void 0!==t.get(S.PURE_BARCODE)){const i=Zt.extractPureBits(e.getBlackMatrix());r=this.decoder.decodeBitMatrix(i,t),n=Zt.NO_POINTS}else{const i=new Xt(e.getBlackMatrix()).detect(t);r=this.decoder.decodeBitMatrix(i.getBits(),t),n=i.getPoints()}r.getOther()instanceof Ut&&r.getOther().applyMirroredCorrection(n);const i=new V(r.getText(),r.getRawBytes(),void 0,n,Y.QR_CODE,void 0),s=r.getByteSegments();null!==s&&i.putMetadata(ne.BYTE_SEGMENTS,s);const o=r.getECLevel();return null!==o&&i.putMetadata(ne.ERROR_CORRECTION_LEVEL,o),r.hasStructuredAppend()&&(i.putMetadata(ne.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),i.putMetadata(ne.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),i}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(null===t||null===r)throw new R;const n=this.moduleSize(t,e);let i=t[1],s=r[1],o=t[0],a=r[0];if(o>=a||i>=s)throw new R;if(s-i!==a-o&&(a=o+(s-i),a>=e.getWidth()))throw new R;const l=Math.round((a-o+1)/n),c=Math.round((s-i+1)/n);if(l<=0||c<=0)throw new R;if(c!==l)throw new R;const d=Math.floor(n/2);i+=d,o+=d;const h=o+Math.floor((l-1)*n)-a;if(h>0){if(h>d)throw new R;o-=h}const u=i+Math.floor((c-1)*n)-s;if(u>0){if(u>d)throw new R;i-=u}const f=new M(l,c);for(let g=0;g<c;g++){const t=i+Math.floor(g*n);for(let r=0;r<l;r++)e.get(o+Math.floor(r*n),t)&&f.set(r,g)}return f}static moduleSize(e,t){const r=t.getHeight(),n=t.getWidth();let i=e[0],s=e[1],o=!0,a=0;for(;i<n&&s<r;){if(o!==t.get(i,s)){if(5===++a)break;o=!o}i++,s++}if(i===n||s===r)throw new R;return(i-e[0])/7}}Zt.NO_POINTS=new Array;class Qt{PDF417Common(){}static getBitCountSum(e){return fe.sum(e)}static toIntArray(e){if(null==e||!e.length)return Qt.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let r=0;for(const n of e)t[r++]=n;return t}static getCodeword(e){const t=A.binarySearch(Qt.SYMBOL_TABLE,262143&e);return t<0?-1:(Qt.CODEWORD_TABLE[t]-1)%Qt.NUMBER_OF_CODEWORDS}}Qt.NUMBER_OF_CODEWORDS=929,Qt.MAX_CODEWORDS_IN_BARCODE=Qt.NUMBER_OF_CODEWORDS-1,Qt.MIN_ROWS_IN_BARCODE=3,Qt.MAX_ROWS_IN_BARCODE=90,Qt.MODULES_IN_CODEWORD=17,Qt.MODULES_IN_STOP_PATTERN=18,Qt.BARS_IN_MODULE=8,Qt.EMPTY_INT_ARRAY=new Int32Array([]),Qt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Qt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class qt{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Kt{static detectMultiple(e,t,r){let n=e.getBlackMatrix(),i=Kt.detect(r,n);return i.length||(n=n.clone(),n.rotate180(),i=Kt.detect(r,n)),new qt(n,i)}static detect(e,t){const r=new Array;let n=0,i=0,s=!1;for(;n<t.getHeight();){const o=Kt.findVertices(t,n,i);if(null!=o[0]||null!=o[3]){if(s=!0,r.push(o),!e)break;null!=o[2]?(i=Math.trunc(o[2].getX()),n=Math.trunc(o[2].getY())):(i=Math.trunc(o[4].getX()),n=Math.trunc(o[4].getY()))}else{if(!s)break;s=!1,i=0;for(const e of r)null!=e[1]&&(n=Math.trunc(Math.max(n,e[1].getY()))),null!=e[3]&&(n=Math.max(n,Math.trunc(e[3].getY())));n+=Kt.ROW_STEP}}return r}static findVertices(e,t,r){const n=e.getHeight(),i=e.getWidth(),s=new Array(8);return Kt.copyToResult(s,Kt.findRowsWithPattern(e,n,i,t,r,Kt.START_PATTERN),Kt.INDEXES_START_PATTERN),null!=s[4]&&(r=Math.trunc(s[4].getX()),t=Math.trunc(s[4].getY())),Kt.copyToResult(s,Kt.findRowsWithPattern(e,n,i,t,r,Kt.STOP_PATTERN),Kt.INDEXES_STOP_PATTERN),s}static copyToResult(e,t,r){for(let n=0;n<r.length;n++)e[r[n]]=t[n]}static findRowsWithPattern(e,t,r,n,i,s){const o=new Array(4);let a=!1;const l=new Int32Array(s.length);for(;n<t;n+=Kt.ROW_STEP){let t=Kt.findGuardPattern(e,i,n,r,!1,s,l);if(null!=t){for(;n>0;){const o=Kt.findGuardPattern(e,i,--n,r,!1,s,l);if(null==o){n++;break}t=o}o[0]=new me(t[0],n),o[1]=new me(t[1],n),a=!0;break}}let c=n+1;if(a){let n=0,i=Int32Array.from([Math.trunc(o[0].getX()),Math.trunc(o[1].getX())]);for(;c<t;c++){const t=Kt.findGuardPattern(e,i[0],c,r,!1,s,l);if(null!=t&&Math.abs(i[0]-t[0])<Kt.MAX_PATTERN_DRIFT&&Math.abs(i[1]-t[1])<Kt.MAX_PATTERN_DRIFT)i=t,n=0;else{if(n>Kt.SKIPPED_ROW_COUNT_MAX)break;n++}}c-=n+1,o[2]=new me(i[0],c),o[3]=new me(i[1],c)}return c-n<Kt.BARCODE_MIN_HEIGHT&&A.fill(o,null),o}static findGuardPattern(e,t,r,n,i,s,o){A.fillWithin(o,0,o.length,0);let a=t,l=0;for(;e.get(a,r)&&a>0&&l++<Kt.MAX_PIXEL_DRIFT;)a--;let c=a,d=0,h=s.length;for(let u=i;c<n;c++)if(e.get(c,r)!==u)o[d]++;else{if(d===h-1){if(Kt.patternMatchVariance(o,s,Kt.MAX_INDIVIDUAL_VARIANCE)<Kt.MAX_AVG_VARIANCE)return new Int32Array([a,c]);a+=o[0]+o[1],m.arraycopy(o,2,o,0,d-1),o[d-1]=0,o[d]=0,d--}else d++;o[d]=1,u=!u}return d===h-1&&Kt.patternMatchVariance(o,s,Kt.MAX_INDIVIDUAL_VARIANCE)<Kt.MAX_AVG_VARIANCE?new Int32Array([a,c-1]):null}static patternMatchVariance(e,t,r){let n=e.length,i=0,s=0;for(let l=0;l<n;l++)i+=e[l],s+=t[l];if(i<s)return 1/0;let o=i/s;r*=o;let a=0;for(let l=0;l<n;l++){let n=e[l],i=t[l]*o,s=n>i?n-i:i-n;if(s>r)return 1/0;a+=s}return a/i}}Kt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Kt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Kt.MAX_AVG_VARIANCE=.42,Kt.MAX_INDIVIDUAL_VARIANCE=.8,Kt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Kt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Kt.MAX_PIXEL_DRIFT=3,Kt.MAX_PATTERN_DRIFT=5,Kt.SKIPPED_ROW_COUNT_MAX=25,Kt.ROW_STEP=5,Kt.BARCODE_MIN_HEIGHT=10;class $t{constructor(e,t){if(0===t.length)throw new h;this.field=e;let r=t.length;if(r>1&&0===t[0]){let e=1;for(;e<r&&0===t[e];)e++;e===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-e),m.arraycopy(t,e,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(0===e)return this.getCoefficient(0);if(1===e){let e=0;for(let t of this.coefficients)e=this.field.add(e,t);return e}let t=this.coefficients[0],r=this.coefficients.length;for(let n=1;n<r;n++)t=this.field.add(this.field.multiply(e,t),this.coefficients[n]);return t}add(e){if(!this.field.equals(e.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){let e=t;t=r,r=e}let n=new Int32Array(r.length),i=r.length-t.length;m.arraycopy(r,0,n,0,i);for(let s=i;s<r.length;s++)n[s]=this.field.add(t[s-i],r[s]);return new $t(this.field,n)}subtract(e){if(!this.field.equals(e.field))throw new h("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof $t?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new $t(this.field,new Int32Array([0]));let t=this.coefficients,r=t.length,n=e.coefficients,i=n.length,s=new Int32Array(r+i-1);for(let o=0;o<r;o++){let e=t[o];for(let t=0;t<i;t++)s[o+t]=this.field.add(s[o+t],this.field.multiply(e,n[t]))}return new $t(this.field,s)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=this.field.subtract(0,this.coefficients[r]);return new $t(this.field,t)}multiplyScalar(e){if(0===e)return new $t(this.field,new Int32Array([0]));if(1===e)return this;let t=this.coefficients.length,r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=this.field.multiply(this.coefficients[n],e);return new $t(this.field,r)}multiplyByMonomial(e,t){if(e<0)throw new h;if(0===t)return new $t(this.field,new Int32Array([0]));let r=this.coefficients.length,n=new Int32Array(r+e);for(let i=0;i<r;i++)n[i]=this.field.multiply(this.coefficients[i],t);return new $t(this.field,n)}toString(){let e=new D;for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);0!==r&&(r<0?(e.append(" - "),r=-r):e.length()>0&&e.append(" + "),0!==t&&1===r||e.append(r),0!==t&&(1===t?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class Jt{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(0===e)throw new h;return this.logTable[e]}inverse(e){if(0===e)throw new ae;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return 0===e||0===t?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class er extends Jt{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let r=1;for(let n=0;n<e;n++)this.expTable[n]=r,r=r*t%e;for(let n=0;n<e-1;n++)this.logTable[this.expTable[n]]=n;this.zero=new $t(this,new Int32Array([0])),this.one=new $t(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new h;if(0===t)return this.zero;let r=new Int32Array(e+1);return r[0]=t,new $t(this,r)}}er.PDF417_GF=new er(Qt.NUMBER_OF_CODEWORDS,3);class tr{constructor(){this.field=er.PDF417_GF}decode(e,t,r){let n=new $t(this.field,e),i=new Int32Array(t),s=!1;for(let f=t;f>0;f--){let e=n.evaluateAt(this.field.exp(f));i[t-f]=e,0!==e&&(s=!0)}if(!s)return 0;let o=this.field.getOne();if(null!=r)for(const f of r){let t=this.field.exp(e.length-1-f),r=new $t(this.field,new Int32Array([this.field.subtract(0,t),1]));o=o.multiply(r)}let a=new $t(this.field,i),l=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),a,t),c=l[0],d=l[1],h=this.findErrorLocations(c),u=this.findErrorMagnitudes(d,c,h);for(let g=0;g<h.length;g++){let t=e.length-1-this.field.log(h[g]);if(t<0)throw f.getChecksumInstance();e[t]=this.field.subtract(e[t],u[g])}return h.length}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){let r=e;e=t,t=r}let n=e,i=t,s=this.field.getZero(),o=this.field.getOne();for(;i.getDegree()>=Math.round(r/2);){let e=n,t=s;if(n=i,s=o,n.isZero())throw f.getChecksumInstance();i=e;let r=this.field.getZero(),a=n.getCoefficient(n.getDegree()),l=this.field.inverse(a);for(;i.getDegree()>=n.getDegree()&&!i.isZero();){let e=i.getDegree()-n.getDegree(),t=this.field.multiply(i.getCoefficient(i.getDegree()),l);r=r.add(this.field.buildMonomial(e,t)),i=i.subtract(n.multiplyByMonomial(e,t))}o=r.multiply(s).subtract(t).negative()}let a=o.getCoefficient(0);if(0===a)throw f.getChecksumInstance();let l=this.field.inverse(a);return[o.multiply(l),i.multiply(l)]}findErrorLocations(e){let t=e.getDegree(),r=new Int32Array(t),n=0;for(let i=1;i<this.field.getSize()&&n<t;i++)0===e.evaluateAt(i)&&(r[n]=this.field.inverse(i),n++);if(n!==t)throw f.getChecksumInstance();return r}findErrorMagnitudes(e,t,r){let n=t.getDegree(),i=new Int32Array(n);for(let l=1;l<=n;l++)i[n-l]=this.field.multiply(l,t.getCoefficient(l));let s=new $t(this.field,i),o=r.length,a=new Int32Array(o);for(let l=0;l<o;l++){let t=this.field.inverse(r[l]),n=this.field.subtract(0,e.evaluateAt(t)),i=this.field.inverse(s.evaluateAt(t));a[l]=this.field.multiply(n,i)}return a}}class rr{constructor(e,t,r,n,i){e instanceof rr?this.constructor_2(e):this.constructor_1(e,t,r,n,i)}constructor_1(e,t,r,n,i){const s=null==t||null==r,o=null==n||null==i;if(s&&o)throw new R;s?(t=new me(0,n.getY()),r=new me(0,i.getY())):o&&(n=new me(e.getWidth()-1,t.getY()),i=new me(e.getWidth()-1,r.getY())),this.image=e,this.topLeft=t,this.bottomLeft=r,this.topRight=n,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),r.getX())),this.maxX=Math.trunc(Math.max(n.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),n.getY())),this.maxY=Math.trunc(Math.max(r.getY(),i.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return null==e?t:null==t?e:new rr(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,r){let n=this.topLeft,i=this.bottomLeft,s=this.topRight,o=this.bottomRight;if(e>0){let t=r?this.topLeft:this.topRight,i=Math.trunc(t.getY()-e);i<0&&(i=0);let o=new me(t.getX(),i);r?n=o:s=o}if(t>0){let e=r?this.bottomLeft:this.bottomRight,n=Math.trunc(e.getY()+t);n>=this.image.getHeight()&&(n=this.image.getHeight()-1);let s=new me(e.getX(),n);r?i=s:o=s}return new rr(this.image,n,i,s,o)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class nr{constructor(e,t,r,n){this.columnCount=e,this.errorCorrectionLevel=n,this.rowCountUpperPart=t,this.rowCountLowerPart=r,this.rowCount=t+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class ir{constructor(){this.buffer=""}static form(e,t){let r=-1;function n(e,n,i,s,o,a){if("%%"===e)return"%";if(void 0===t[++r])return;e=s?parseInt(s.substr(1)):void 0;let l,c=o?parseInt(o.substr(1)):void 0;switch(a){case"s":l=t[r];break;case"c":l=t[r][0];break;case"f":l=parseFloat(t[r]).toFixed(e);break;case"p":l=parseFloat(t[r]).toPrecision(e);break;case"e":l=parseFloat(t[r]).toExponential(e);break;case"x":l=parseInt(t[r]).toString(c||16);break;case"d":l=parseFloat(parseInt(t[r],c||10).toPrecision(e)).toFixed(0)}l="object"==typeof l?JSON.stringify(l):(+l).toString(c);let d=parseInt(i),h=i&&i[0]+""=="0"?"0":" ";for(;l.length<d;)l=void 0!==n?l+h:h+l;return l}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,n)}format(e,...t){this.buffer+=ir.form(e,t)}toString(){return this.buffer}}class sr{constructor(e){this.boundingBox=new rr(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(null!=t)return t;for(let r=1;r<sr.MAX_NEARBY_DISTANCE;r++){let n=this.imageRowToCodewordIndex(e)-r;if(n>=0&&(t=this.codewords[n],null!=t))return t;if(n=this.imageRowToCodewordIndex(e)+r,n<this.codewords.length&&(t=this.codewords[n],null!=t))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new ir;let t=0;for(const r of this.codewords)null!=r?e.format("%3d: %3d|%3d%n",t++,r.getRowNumber(),r.getValue()):e.format("%3d:    |   %n",t++);return e.toString()}}sr.MAX_NEARBY_DISTANCE=5;class or{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);null==t&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[r,n]of this.values.entries()){const i={getKey:()=>r,getValue:()=>n};i.getValue()>e?(e=i.getValue(),t=[],t.push(i.getKey())):i.getValue()===e&&t.push(i.getKey())}return Qt.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class ar extends sr{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())null!=e&&e.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let r=this.getBoundingBox(),n=this._isLeft?r.getTopLeft():r.getTopRight(),i=this._isLeft?r.getBottomLeft():r.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(n.getY())),o=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=-1,l=1,c=0;for(let d=s;d<o;d++){if(null==t[d])continue;let r=t[d],n=r.getRowNumber()-a;if(0===n)c++;else if(1===n)l=Math.max(l,c),c=1,a=r.getRowNumber();else if(n<0||r.getRowNumber()>=e.getRowCount()||n>d)t[d]=null;else{let e;e=l>2?(l-2)*n:n;let i=e>=d;for(let r=1;r<=e&&!i;r++)i=null!=t[d-r];i?t[d]=null:(a=r.getRowNumber(),c=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(null==e)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let r of this.getCodewords())if(null!=r){let e=r.getRowNumber();if(e>=t.length)continue;t[e]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),r=this._isLeft?t.getTopLeft():t.getTopRight(),n=this._isLeft?t.getBottomLeft():t.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(r.getY())),s=this.imageRowToCodewordIndex(Math.trunc(n.getY())),o=this.getCodewords(),a=-1;for(let l=i;l<s;l++){if(null==o[l])continue;let t=o[l];t.setRowNumberAsRowIndicatorColumn();let r=t.getRowNumber()-a;0===r||(1===r?a=t.getRowNumber():t.getRowNumber()>=e.getRowCount()?o[l]=null:a=t.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new or,r=new or,n=new or,i=new or;for(let o of e){if(null==o)continue;o.setRowNumberAsRowIndicatorColumn();let e=o.getValue()%30,s=o.getRowNumber();switch(this._isLeft||(s+=2),s%3){case 0:r.setValue(3*e+1);break;case 1:i.setValue(e/3),n.setValue(e%3);break;case 2:t.setValue(e+1)}}if(0===t.getValue().length||0===r.getValue().length||0===n.getValue().length||0===i.getValue().length||t.getValue()[0]<1||r.getValue()[0]+n.getValue()[0]<Qt.MIN_ROWS_IN_BARCODE||r.getValue()[0]+n.getValue()[0]>Qt.MAX_ROWS_IN_BARCODE)return null;let s=new nr(t.getValue()[0],r.getValue()[0],n.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(e,s),s}removeIncorrectCodewords(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(null==e[r])continue;let i=n.getValue()%30,s=n.getRowNumber();if(s>t.getRowCount())e[r]=null;else switch(this._isLeft||(s+=2),s%3){case 0:3*i+1!==t.getRowCountUpperPart()&&(e[r]=null);break;case 1:Math.trunc(i/3)===t.getErrorCorrectionLevel()&&i%3===t.getRowCountLowerPart()||(e[r]=null);break;case 2:i+1!==t.getColumnCount()&&(e[r]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}class lr{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e,t=Qt.MAX_CODEWORDS_IN_BARCODE;do{e=t,t=this.adjustRowNumbersAndGetCount()}while(t>0&&t<e);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){null!=e&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(0===e)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let e=this.detectionResultColumns[t].getCodewords();for(let r=0;r<e.length;r++)null!=e[r]&&(e[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,e))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<e.length;r++)if(null!=e[r]&&null!=t[r]&&e[r].getRowNumber()===t[r].getRowNumber())for(let t=1;t<=this.barcodeColumnCount;t++){let n=this.detectionResultColumns[t].getCodewords()[r];null!=n&&(n.setRowNumber(e[r].getRowNumber()),n.hasValidRowNumber()||(this.detectionResultColumns[t].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<t.length;r++){if(null==t[r])continue;let n=t[r].getRowNumber(),i=0;for(let t=this.barcodeColumnCount+1;t>0&&i<this.ADJUST_ROW_NUMBER_SKIP;t--){let s=this.detectionResultColumns[t].getCodewords()[r];null!=s&&(i=lr.adjustRowNumberIfValid(n,i,s),s.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let r=0;r<t.length;r++){if(null==t[r])continue;let n=t[r].getRowNumber(),i=0;for(let t=1;t<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;t++){let s=this.detectionResultColumns[t].getCodewords()[r];null!=s&&(i=lr.adjustRowNumberIfValid(n,i,s),s.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,r){return null==r||r.hasValidRowNumber()||(r.isValidRowNumber(e)?(r.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,r){if(!this.detectionResultColumns[e-1])return;let n=r[t],i=this.detectionResultColumns[e-1].getCodewords(),s=i;null!=this.detectionResultColumns[e+1]&&(s=this.detectionResultColumns[e+1].getCodewords());let o=new Array(14);o[2]=i[t],o[3]=s[t],t>0&&(o[0]=r[t-1],o[4]=i[t-1],o[5]=s[t-1]),t>1&&(o[8]=r[t-2],o[10]=i[t-2],o[11]=s[t-2]),t<r.length-1&&(o[1]=r[t+1],o[6]=i[t+1],o[7]=s[t+1]),t<r.length-2&&(o[9]=r[t+2],o[12]=i[t+2],o[13]=s[t+2]);for(let a of o)if(lr.adjustRowNumber(n,a))return}static adjustRowNumber(e,t){return!(null==t||!t.hasValidRowNumber()||t.getBucket()!==e.getBucket()||(e.setRowNumber(t.getRowNumber()),0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];null==e&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new ir;for(let r=0;r<e.getCodewords().length;r++){t.format("CW %3d:",r);for(let e=0;e<this.barcodeColumnCount+2;e++){if(null==this.detectionResultColumns[e]){t.format("    |   ");continue}let n=this.detectionResultColumns[e].getCodewords()[r];null!=n?t.format(" %3d|%3d",n.getRowNumber(),n.getValue()):t.format("    |   ")}t.format("%n")}return t.toString()}}class cr{constructor(e,t,r,n){this.rowNumber=cr.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(r),this.value=Math.trunc(n)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==cr.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}cr.BARCODE_ROW_UNKNOWN=-1;class dr{static initialize(){for(let e=0;e<Qt.SYMBOL_TABLE.length;e++){let t=Qt.SYMBOL_TABLE[e],r=1&t;for(let n=0;n<Qt.BARS_IN_MODULE;n++){let i=0;for(;(1&t)===r;)i+=1,t>>=1;r=1&t,dr.RATIOS_TABLE[e]||(dr.RATIOS_TABLE[e]=new Array(Qt.BARS_IN_MODULE)),dr.RATIOS_TABLE[e][Qt.BARS_IN_MODULE-n-1]=Math.fround(i/Qt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=dr.getDecodedCodewordValue(dr.sampleBitCounts(e));return-1!==t?t:dr.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=fe.sum(e),r=new Int32Array(Qt.BARS_IN_MODULE),n=0,i=0;for(let s=0;s<Qt.MODULES_IN_CODEWORD;s++){let o=t/(2*Qt.MODULES_IN_CODEWORD)+s*t/Qt.MODULES_IN_CODEWORD;i+e[n]<=o&&(i+=e[n],n++),r[n]++}return r}static getDecodedCodewordValue(e){let t=dr.getBitValue(e);return-1===Qt.getCodeword(t)?-1:t}static getBitValue(e){let t=0;for(let r=0;r<e.length;r++)for(let n=0;n<e[r];n++)t=t<<1|(r%2==0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=fe.sum(e),r=new Array(Qt.BARS_IN_MODULE);if(t>1)for(let s=0;s<r.length;s++)r[s]=Math.fround(e[s]/t);let n=ge.MAX_VALUE,i=-1;this.bSymbolTableReady||dr.initialize();for(let s=0;s<dr.RATIOS_TABLE.length;s++){let e=0,t=dr.RATIOS_TABLE[s];for(let i=0;i<Qt.BARS_IN_MODULE;i++){let s=Math.fround(t[i]-r[i]);if(e+=Math.fround(s*s),e>=n)break}e<n&&(n=e,i=Qt.SYMBOL_TABLE[s])}return i}}dr.bSymbolTableReady=!1,dr.RATIOS_TABLE=new Array(Qt.SYMBOL_TABLE.length).map(e=>new Array(Qt.BARS_IN_MODULE));class hr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class ur{static parseLong(e,t=void 0){return parseInt(e,t)}}class fr extends c{}fr.kind="NullPointerException";class gr{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,r){if(null==e)throw new fr;if(t<0||t>e.length||r<0||t+r>e.length||t+r<0)throw new p;if(0!==r)for(let n=0;n<r;n++)this.write(e[t+n])}flush(){}close(){}}class mr extends c{}class pr extends gr{constructor(e=32){if(super(),this.count=0,e<0)throw new h("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let t=this.buf.length<<1;if(t-e<0&&(t=e),t<0){if(e<0)throw new mr;t=C.MAX_VALUE}this.buf=A.copyOfUint8Array(this.buf,t)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,r){if(t<0||t>e.length||r<0||t+r-e.length>0)throw new p;this.ensureCapacity(this.count+r),m.arraycopy(e,t,this.buf,this.count,r),this.count+=r}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return A.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?"string"==typeof e?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}function wr(){if("undefined"!=typeof window)return window.BigInt||null;if("undefined"!=typeof globalThis)return globalThis.BigInt||null;if("undefined"!=typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ar;function Cr(e){if(void 0===Ar&&(Ar=wr()),null===Ar)throw new Error("BigInt is not supported!");return Ar(e)}function yr(){let e=[];e[0]=Cr(1);let t=Cr(900);e[1]=t;for(let r=2;r<16;r++)e[r]=e[r-1]*t;return e}!function(e){e[e.ALPHA=0]="ALPHA",e[e.LOWER=1]="LOWER",e[e.MIXED=2]="MIXED",e[e.PUNCT=3]="PUNCT",e[e.ALPHA_SHIFT=4]="ALPHA_SHIFT",e[e.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(K||(K={}));class Er{static decode(e,t){let r=new D(""),n=N.ISO8859_1;r.enableDecoding(n);let i=1,s=e[i++],o=new hr;for(;i<e[0];){switch(s){case Er.TEXT_COMPACTION_MODE_LATCH:i=Er.textCompaction(e,i,r);break;case Er.BYTE_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH_6:i=Er.byteCompaction(s,e,n,i,r);break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[i++]);break;case Er.NUMERIC_COMPACTION_MODE_LATCH:i=Er.numericCompaction(e,i,r);break;case Er.ECI_CHARSET:N.getCharacterSetECIByValue(e[i++]);break;case Er.ECI_GENERAL_PURPOSE:i+=2;break;case Er.ECI_USER_DEFINED:i++;break;case Er.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=Er.decodeMacroBlock(e,i,o);break;case Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Er.MACRO_PDF417_TERMINATOR:throw new I;default:i--,i=Er.textCompaction(e,i,r)}if(!(i<e.length))throw I.getFormatInstance();s=e[i++]}if(0===r.length())throw I.getFormatInstance();let a=new ie(null,r.toString(),null,t);return a.setOther(o),a}static decodeMacroBlock(e,t,r){if(t+Er.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw I.getFormatInstance();let n=new Int32Array(Er.NUMBER_OF_SEQUENCE_CODEWORDS);for(let o=0;o<Er.NUMBER_OF_SEQUENCE_CODEWORDS;o++,t++)n[o]=e[t];r.setSegmentIndex(C.parseInt(Er.decodeBase900toBase10(n,Er.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new D;t=Er.textCompaction(e,t,i),r.setFileId(i.toString());let s=-1;for(e[t]===Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=t+1);t<e[0];)switch(e[t]){case Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(e[++t]){case Er.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let n=new D;t=Er.textCompaction(e,t+1,n),r.setFileName(n.toString());break;case Er.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let i=new D;t=Er.textCompaction(e,t+1,i),r.setSender(i.toString());break;case Er.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let s=new D;t=Er.textCompaction(e,t+1,s),r.setAddressee(s.toString());break;case Er.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let o=new D;t=Er.numericCompaction(e,t+1,o),r.setSegmentCount(C.parseInt(o.toString()));break;case Er.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let a=new D;t=Er.numericCompaction(e,t+1,a),r.setTimestamp(ur.parseLong(a.toString()));break;case Er.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let l=new D;t=Er.numericCompaction(e,t+1,l),r.setChecksum(C.parseInt(l.toString()));break;case Er.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let c=new D;t=Er.numericCompaction(e,t+1,c),r.setFileSize(ur.parseLong(c.toString()));break;default:throw I.getFormatInstance()}break;case Er.MACRO_PDF417_TERMINATOR:t++,r.setLastSegment(!0);break;default:throw I.getFormatInstance()}if(-1!==s){let n=t-s;r.isLastSegment()&&n--,r.setOptionalData(A.copyOfRange(e,s,s+n))}return t}static textCompaction(e,t,r){let n=new Int32Array(2*(e[0]-t)),i=new Int32Array(2*(e[0]-t)),s=0,o=!1;for(;t<e[0]&&!o;){let r=e[t++];if(r<Er.TEXT_COMPACTION_MODE_LATCH)n[s]=r/30,n[s+1]=r%30,s+=2;else switch(r){case Er.TEXT_COMPACTION_MODE_LATCH:n[s++]=Er.TEXT_COMPACTION_MODE_LATCH;break;case Er.BYTE_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH_6:case Er.NUMERIC_COMPACTION_MODE_LATCH:case Er.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Er.MACRO_PDF417_TERMINATOR:t--,o=!0;break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n[s]=Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,r=e[t++],i[s]=r,s++}}return Er.decodeTextCompaction(n,i,s,r),t}static decodeTextCompaction(e,t,r,n){let i=K.ALPHA,s=K.ALPHA,o=0;for(;o<r;){let r=e[o],a="";switch(i){case K.ALPHA:if(r<26)a=String.fromCharCode(65+r);else switch(r){case 26:a=" ";break;case Er.LL:i=K.LOWER;break;case Er.ML:i=K.MIXED;break;case Er.PS:s=i,i=K.PUNCT_SHIFT;break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[o]);break;case Er.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.LOWER:if(r<26)a=String.fromCharCode(97+r);else switch(r){case 26:a=" ";break;case Er.AS:s=i,i=K.ALPHA_SHIFT;break;case Er.ML:i=K.MIXED;break;case Er.PS:s=i,i=K.PUNCT_SHIFT;break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[o]);break;case Er.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.MIXED:if(r<Er.PL)a=Er.MIXED_CHARS[r];else switch(r){case Er.PL:i=K.PUNCT;break;case 26:a=" ";break;case Er.LL:i=K.LOWER;break;case Er.AL:i=K.ALPHA;break;case Er.PS:s=i,i=K.PUNCT_SHIFT;break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[o]);break;case Er.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.PUNCT:if(r<Er.PAL)a=Er.PUNCT_CHARS[r];else switch(r){case Er.PAL:i=K.ALPHA;break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[o]);break;case Er.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.ALPHA_SHIFT:if(i=s,r<26)a=String.fromCharCode(65+r);else switch(r){case 26:a=" ";break;case Er.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.PUNCT_SHIFT:if(i=s,r<Er.PAL)a=Er.PUNCT_CHARS[r];else switch(r){case Er.PAL:i=K.ALPHA;break;case Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[o]);break;case Er.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}}""!==a&&n.append(a),o++}}static byteCompaction(e,t,r,n,i){let s=new pr,o=0,a=0,l=!1;switch(e){case Er.BYTE_COMPACTION_MODE_LATCH:let e=new Int32Array(6),r=t[n++];for(;n<t[0]&&!l;)switch(e[o++]=r,a=900*a+r,r=t[n++],r){case Er.TEXT_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH:case Er.NUMERIC_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH_6:case Er.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Er.MACRO_PDF417_TERMINATOR:n--,l=!0;break;default:if(o%5==0&&o>0){for(let e=0;e<6;++e)s.write(Number(Cr(a)>>Cr(8*(5-e))));a=0,o=0}}n===t[0]&&r<Er.TEXT_COMPACTION_MODE_LATCH&&(e[o++]=r);for(let t=0;t<o;t++)s.write(e[t]);break;case Er.BYTE_COMPACTION_MODE_LATCH_6:for(;n<t[0]&&!l;){let e=t[n++];if(e<Er.TEXT_COMPACTION_MODE_LATCH)o++,a=900*a+e;else switch(e){case Er.TEXT_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH:case Er.NUMERIC_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH_6:case Er.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Er.MACRO_PDF417_TERMINATOR:n--,l=!0}if(o%5==0&&o>0){for(let e=0;e<6;++e)s.write(Number(Cr(a)>>Cr(8*(5-e))));a=0,o=0}}}return i.append(b.decode(s.toByteArray(),r)),n}static numericCompaction(e,t,r){let n=0,i=!1,s=new Int32Array(Er.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!i;){let o=e[t++];if(t===e[0]&&(i=!0),o<Er.TEXT_COMPACTION_MODE_LATCH)s[n]=o,n++;else switch(o){case Er.TEXT_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH:case Er.BYTE_COMPACTION_MODE_LATCH_6:case Er.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Er.MACRO_PDF417_TERMINATOR:t--,i=!0}(n%Er.MAX_NUMERIC_CODEWORDS===0||o===Er.NUMERIC_COMPACTION_MODE_LATCH||i)&&n>0&&(r.append(Er.decodeBase900toBase10(s,n)),n=0)}return t}static decodeBase900toBase10(e,t){let r=Cr(0);for(let i=0;i<t;i++)r+=Er.EXP900[t-i-1]*Cr(e[i]);let n=r.toString();if("1"!==n.charAt(0))throw new I;return n.substring(1)}}Er.TEXT_COMPACTION_MODE_LATCH=900,Er.BYTE_COMPACTION_MODE_LATCH=901,Er.NUMERIC_COMPACTION_MODE_LATCH=902,Er.BYTE_COMPACTION_MODE_LATCH_6=924,Er.ECI_USER_DEFINED=925,Er.ECI_GENERAL_PURPOSE=926,Er.ECI_CHARSET=927,Er.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Er.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Er.MACRO_PDF417_TERMINATOR=922,Er.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Er.MAX_NUMERIC_CODEWORDS=15,Er.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Er.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Er.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Er.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Er.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Er.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Er.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Er.PL=25,Er.LL=27,Er.AS=27,Er.ML=28,Er.AL=28,Er.PS=29,Er.PAL=29,Er.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",Er.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",Er.EXP900=wr()?yr():[],Er.NUMBER_OF_SEQUENCE_CODEWORDS=2;class _r{constructor(){}static decode(e,t,r,n,i,s,o){let a,l=new rr(e,t,r,n,i),c=null,d=null;for(let f=!0;;f=!1){if(null!=t&&(c=_r.getRowIndicatorColumn(e,l,t,!0,s,o)),null!=n&&(d=_r.getRowIndicatorColumn(e,l,n,!1,s,o)),a=_r.merge(c,d),null==a)throw R.getNotFoundInstance();let r=a.getBoundingBox();if(!f||null==r||!(r.getMinY()<l.getMinY()||r.getMaxY()>l.getMaxY()))break;l=r}a.setBoundingBox(l);let h=a.getBarcodeColumnCount()+1;a.setDetectionResultColumn(0,c),a.setDetectionResultColumn(h,d);let u=null!=c;for(let f=1;f<=h;f++){let t,r=u?f:h-f;if(void 0!==a.getDetectionResultColumn(r))continue;t=0===r||r===h?new ar(l,0===r):new sr(l),a.setDetectionResultColumn(r,t);let n=-1,i=n;for(let c=l.getMinY();c<=l.getMaxY();c++){if(n=_r.getStartColumn(a,r,c,u),n<0||n>l.getMaxX()){if(-1===i)continue;n=i}let d=_r.detectCodeword(e,l.getMinX(),l.getMaxX(),u,n,c,s,o);null!=d&&(t.setCodeword(c,d),i=n,s=Math.min(s,d.getWidth()),o=Math.max(o,d.getWidth()))}}return _r.createDecoderResult(a)}static merge(e,t){if(null==e&&null==t)return null;let r=_r.getBarcodeMetadata(e,t);if(null==r)return null;let n=rr.merge(_r.adjustBoundingBox(e),_r.adjustBoundingBox(t));return new lr(r,n)}static adjustBoundingBox(e){if(null==e)return null;let t=e.getRowHeights();if(null==t)return null;let r=_r.getMax(t),n=0;for(let o of t)if(n+=r-o,o>0)break;let i=e.getCodewords();for(let o=0;n>0&&null==i[o];o++)n--;let s=0;for(let o=t.length-1;o>=0&&(s+=r-t[o],!(t[o]>0));o--);for(let o=i.length-1;s>0&&null==i[o];o--)s--;return e.getBoundingBox().addMissingRows(n,s,e.isLeft())}static getMax(e){let t=-1;for(let r of e)t=Math.max(t,r);return t}static getBarcodeMetadata(e,t){let r,n;return null==e||null==(r=e.getBarcodeMetadata())?null==t?null:t.getBarcodeMetadata():null==t||null==(n=t.getBarcodeMetadata())?r:r.getColumnCount()!==n.getColumnCount()&&r.getErrorCorrectionLevel()!==n.getErrorCorrectionLevel()&&r.getRowCount()!==n.getRowCount()?null:r}static getRowIndicatorColumn(e,t,r,n,i,s){let o=new ar(t,n);for(let a=0;a<2;a++){let l=0===a?1:-1,c=Math.trunc(Math.trunc(r.getX()));for(let a=Math.trunc(Math.trunc(r.getY()));a<=t.getMaxY()&&a>=t.getMinY();a+=l){let t=_r.detectCodeword(e,0,e.getWidth(),n,c,a,i,s);null!=t&&(o.setCodeword(a,t),c=n?t.getStartX():t.getEndX())}}return o}static adjustCodewordCount(e,t){let r=t[0][1],n=r.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-_r.getNumberOfECCodeWords(e.getBarcodeECLevel());if(0===n.length){if(i<1||i>Qt.MAX_CODEWORDS_IN_BARCODE)throw R.getNotFoundInstance();r.setValue(i)}else n[0]!==i&&r.setValue(i)}static createDecoderResult(e){let t=_r.createBarcodeMatrix(e);_r.adjustCodewordCount(e,t);let r=new Array,n=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],s=new Array;for(let a=0;a<e.getBarcodeRowCount();a++)for(let o=0;o<e.getBarcodeColumnCount();o++){let l=t[a][o+1].getValue(),c=a*e.getBarcodeColumnCount()+o;0===l.length?r.push(c):1===l.length?n[c]=l[0]:(s.push(c),i.push(l))}let o=new Array(i.length);for(let a=0;a<o.length;a++)o[a]=i[a];return _r.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),n,Qt.toIntArray(r),Qt.toIntArray(s),o)}static createDecoderResultFromAmbiguousValues(e,t,r,n,i){let s=new Int32Array(n.length),o=100;for(;o-- >0;){for(let e=0;e<s.length;e++)t[n[e]]=i[e][s[e]];try{return _r.decodeCodewords(t,e,r)}catch(a){if(!(a instanceof f))throw a}if(0===s.length)throw f.getChecksumInstance();for(let e=0;e<s.length;e++){if(s[e]<i[e].length-1){s[e]++;break}if(s[e]=0,e===s.length-1)throw f.getChecksumInstance()}}throw f.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let n=0;n<t.length;n++)for(let e=0;e<t[n].length;e++)t[n][e]=new or;let r=0;for(let n of e.getDetectionResultColumns()){if(null!=n)for(let e of n.getCodewords())if(null!=e){let n=e.getRowNumber();if(n>=0){if(n>=t.length)continue;t[n][r].setValue(e.getValue())}}r++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,r,n){let i=n?1:-1,s=null;if(_r.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodeword(r)),null!=s)return n?s.getEndX():s.getStartX();if(s=e.getDetectionResultColumn(t).getCodewordNearby(r),null!=s)return n?s.getStartX():s.getEndX();if(_r.isValidBarcodeColumn(e,t-i)&&(s=e.getDetectionResultColumn(t-i).getCodewordNearby(r)),null!=s)return n?s.getEndX():s.getStartX();let o=0;for(;_r.isValidBarcodeColumn(e,t-i);){t-=i;for(let r of e.getDetectionResultColumn(t).getCodewords())if(null!=r)return(n?r.getEndX():r.getStartX())+i*o*(r.getEndX()-r.getStartX());o++}return n?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,r,n,i,s,o,a){i=_r.adjustCodewordStartColumn(e,t,r,n,i,s);let l,c=_r.getModuleBitCount(e,t,r,n,i,s);if(null==c)return null;let d=fe.sum(c);if(n)l=i+d;else{for(let e=0;e<c.length/2;e++){let t=c[e];c[e]=c[c.length-1-e],c[c.length-1-e]=t}l=i,i=l-d}if(!_r.checkCodewordSkew(d,o,a))return null;let h=dr.getDecodedValue(c),u=Qt.getCodeword(h);return-1===u?null:new cr(i,l,_r.getCodewordBucketNumber(h),u)}static getModuleBitCount(e,t,r,n,i,s){let o=i,a=new Int32Array(8),l=0,c=n?1:-1,d=n;for(;(n?o<r:o>=t)&&l<a.length;)e.get(o,s)===d?(a[l]++,o+=c):(l++,d=!d);return l===a.length||o===(n?r:t)&&l===a.length-1?a:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,r,n,i,s){let o=i,a=n?-1:1;for(let l=0;l<2;l++){for(;(n?o>=t:o<r)&&n===e.get(o,s);){if(Math.abs(i-o)>_r.CODEWORD_SKEW_SIZE)return i;o+=a}a=-a,n=!n}return o}static checkCodewordSkew(e,t,r){return t-_r.CODEWORD_SKEW_SIZE<=e&&e<=r+_r.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,r){if(0===e.length)throw I.getFormatInstance();let n=1<<t+1,i=_r.correctErrors(e,r,n);_r.verifyCodewordCount(e,n);let s=Er.decode(e,""+t);return s.setErrorsCorrected(i),s.setErasures(r.length),s}static correctErrors(e,t,r){if(null!=t&&t.length>r/2+_r.MAX_ERRORS||r<0||r>_r.MAX_EC_CODEWORDS)throw f.getChecksumInstance();return _r.errorCorrection.decode(e,r,t)}static verifyCodewordCount(e,t){if(e.length<4)throw I.getFormatInstance();let r=e[0];if(r>e.length)throw I.getFormatInstance();if(0===r){if(!(t<e.length))throw I.getFormatInstance();e[0]=e.length-t}}static getBitCountForCodeword(e){let t=new Int32Array(8),r=0,n=t.length-1;for(;!((1&e)!==r&&(r=1&e,n--,n<0));)t[n]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return _r.getCodewordBucketNumber(_r.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new ir;for(let r=0;r<e.length;r++){t.format("Row %2d: ",r);for(let n=0;n<e[r].length;n++){let i=e[r][n];0===i.getValue().length?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()}}_r.CODEWORD_SKEW_SIZE=2,_r.MAX_ERRORS=3,_r.MAX_EC_CODEWORDS=512,_r.errorCorrection=new tr;class Sr{decode(e,t=null){let r=Sr.decode(e,t,!1);if(null==r||0===r.length||null==r[0])throw R.getNotFoundInstance();return r[0]}decodeMultiple(e,t=null){try{return Sr.decode(e,t,!0)}catch(r){if(r instanceof I||r instanceof f)throw R.getNotFoundInstance();throw r}}static decode(e,t,r){const n=new Array,i=Kt.detectMultiple(e,t,r);for(const s of i.getPoints()){const e=_r.decode(i.getBits(),s[4],s[5],s[6],s[7],Sr.getMinCodewordWidth(s),Sr.getMaxCodewordWidth(s)),t=new V(e.getText(),e.getRawBytes(),void 0,s,Y.PDF_417);t.putMetadata(ne.ERROR_CORRECTION_LEVEL,e.getECLevel());const r=e.getOther();null!=r&&t.putMetadata(ne.PDF417_EXTRA_METADATA,r),n.push(t)}return n.map(e=>e)}static getMaxWidth(e,t){return null==e||null==t?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return null==e||null==t?C.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(Sr.getMaxWidth(e[0],e[4]),Sr.getMaxWidth(e[6],e[2])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN),Math.max(Sr.getMaxWidth(e[1],e[5]),Sr.getMaxWidth(e[7],e[3])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(Sr.getMinWidth(e[0],e[4]),Sr.getMinWidth(e[6],e[2])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN),Math.min(Sr.getMinWidth(e[1],e[5]),Sr.getMinWidth(e[7],e[3])*Qt.MODULES_IN_CODEWORD/Qt.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ir extends c{}Ir.kind="ReaderException";class Nr{constructor(e,t){this.verbose=!0===e,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const r=!t(e)&&!0===e.get(S.TRY_HARDER),n=t(e)?null:e.get(S.POSSIBLE_FORMATS),i=new Array;if(!t(n)){const t=n.some(e=>e===Y.UPC_A||e===Y.UPC_E||e===Y.EAN_13||e===Y.EAN_8||e===Y.CODABAR||e===Y.CODE_39||e===Y.CODE_93||e===Y.CODE_128||e===Y.ITF||e===Y.RSS_14||e===Y.RSS_EXPANDED);t&&!r&&i.push(new wt(e,this.verbose)),n.includes(Y.QR_CODE)&&i.push(new Zt),n.includes(Y.DATA_MATRIX)&&i.push(new xt),n.includes(Y.AZTEC)&&i.push(new Ne),n.includes(Y.PDF_417)&&i.push(new Sr),t&&r&&i.push(new wt(e,this.verbose))}0===i.length&&(r||i.push(new wt(e,this.verbose)),i.push(new Zt),i.push(new xt),i.push(new Ne),i.push(new Sr),r&&i.push(new wt(e,this.verbose))),this.readers=i}reset(){if(null!==this.readers)for(const e of this.readers)e.reset()}decodeInternal(e){if(null===this.readers)throw new Ir("No readers where selected, nothing can be read.");for(const r of this.readers)try{return r.decode(e,this.hints)}catch(t){if(t instanceof Ir)continue}throw new R("No MultiFormat Readers were able to detect the code.")}}class Tr extends H{constructor(e=null,t=500){const r=new Nr;r.setHints(e),super(r,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class br extends H{constructor(e=500){super(new Sr,e)}}class xr extends H{constructor(e=500){super(new Zt,e)}}var Dr,Mr;(Mr=Dr||(Dr={}))[Mr.ERROR_CORRECTION=0]="ERROR_CORRECTION",Mr[Mr.CHARACTER_SET=1]="CHARACTER_SET",Mr[Mr.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",Mr[Mr.MIN_SIZE=3]="MIN_SIZE",Mr[Mr.MAX_SIZE=4]="MAX_SIZE",Mr[Mr.MARGIN=5]="MARGIN",Mr[Mr.PDF417_COMPACT=6]="PDF417_COMPACT",Mr[Mr.PDF417_COMPACTION=7]="PDF417_COMPACTION",Mr[Mr.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",Mr[Mr.AZTEC_LAYERS=9]="AZTEC_LAYERS",Mr[Mr.QR_VERSION=10]="QR_VERSION";var Rr=Dr;class vr{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new oe(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let r=t[t.length-1];const n=this.field;for(let i=t.length;i<=e;i++){const e=r.multiply(new oe(n,Int32Array.from([1,n.exp(i-1+n.getGeneratorBase())])));t.push(e),r=e}}return t[e]}encode(e,t){if(0===t)throw new h("No error correction bytes");const r=e.length-t;if(r<=0)throw new h("No data bytes provided");const n=this.buildGenerator(t),i=new Int32Array(r);m.arraycopy(e,0,i,0,r);let s=new oe(this.field,i);s=s.multiplyByMonomial(t,1);const o=s.divide(n)[1].getCoefficients(),a=t-o.length;for(let l=0;l<a;l++)e[r+l]=0;m.arraycopy(o,0,e,r+a,o.length)}}class Or{constructor(){}static applyMaskPenaltyRule1(e){return Or.applyMaskPenaltyRule1Internal(e,!0)+Or.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const r=e.getArray(),n=e.getWidth(),i=e.getHeight();for(let s=0;s<i-1;s++){const e=r[s];for(let i=0;i<n-1;i++){const n=e[i];n===e[i+1]&&n===r[s+1][i]&&n===r[s+1][i+1]&&t++}}return Or.N2*t}static applyMaskPenaltyRule3(e){let t=0;const r=e.getArray(),n=e.getWidth(),i=e.getHeight();for(let s=0;s<i;s++)for(let e=0;e<n;e++){const o=r[s];e+6<n&&1===o[e]&&0===o[e+1]&&1===o[e+2]&&1===o[e+3]&&1===o[e+4]&&0===o[e+5]&&1===o[e+6]&&(Or.isWhiteHorizontal(o,e-4,e)||Or.isWhiteHorizontal(o,e+7,e+11))&&t++,s+6<i&&1===r[s][e]&&0===r[s+1][e]&&1===r[s+2][e]&&1===r[s+3][e]&&1===r[s+4][e]&&0===r[s+5][e]&&1===r[s+6][e]&&(Or.isWhiteVertical(r,e,s-4,s)||Or.isWhiteVertical(r,e,s+7,s+11))&&t++}return t*Or.N3}static isWhiteHorizontal(e,t,r){t=Math.max(t,0),r=Math.min(r,e.length);for(let n=t;n<r;n++)if(1===e[n])return!1;return!0}static isWhiteVertical(e,t,r,n){r=Math.max(r,0),n=Math.min(n,e.length);for(let i=r;i<n;i++)if(1===e[i][t])return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const r=e.getArray(),n=e.getWidth(),i=e.getHeight();for(let o=0;o<i;o++){const e=r[o];for(let r=0;r<n;r++)1===e[r]&&t++}const s=e.getHeight()*e.getWidth();return Math.floor(10*Math.abs(2*t-s)/s)*Or.N4}static getDataMaskBit(e,t,r){let n,i;switch(e){case 0:n=r+t&1;break;case 1:n=1&r;break;case 2:n=t%3;break;case 3:n=(r+t)%3;break;case 4:n=Math.floor(r/2)+Math.floor(t/3)&1;break;case 5:i=r*t,n=(1&i)+i%3;break;case 6:i=r*t,n=(1&i)+i%3&1;break;case 7:i=r*t,n=i%3+(r+t&1)&1;break;default:throw new h("Invalid mask pattern: "+e)}return 0===n}static applyMaskPenaltyRule1Internal(e,t){let r=0;const n=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),s=e.getArray();for(let o=0;o<n;o++){let e=0,n=-1;for(let a=0;a<i;a++){const i=t?s[o][a]:s[a][o];i===n?e++:(e>=5&&(r+=Or.N1+(e-5)),e=1,n=i)}e>=5&&(r+=Or.N1+(e-5))}return r}}Or.N1=3,Or.N2=3,Or.N3=40,Or.N4=10;class Pr{constructor(e,t){this.width=e,this.height=t;const r=new Array(t);for(let n=0;n!==t;n++)r[n]=new Uint8Array(e);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,r){this.bytes[t][e]=r}setBoolean(e,t,r){this.bytes[t][e]=r?1:0}clear(e){for(const t of this.bytes)A.fill(t,e)}equals(e){if(!(e instanceof Pr))return!1;const t=e;if(this.width!==t.width)return!1;if(this.height!==t.height)return!1;for(let r=0,n=this.height;r<n;++r){const e=this.bytes[r],n=t.bytes[r];for(let t=0,r=this.width;t<r;++t)if(e[t]!==n[t])return!1}return!0}toString(){const e=new D;for(let t=0,r=this.height;t<r;++t){const r=this.bytes[t];for(let t=0,n=this.width;t<n;++t)switch(r[t]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ")}e.append("\n")}return e.toString()}}class Br{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new D;return e.append("<<\n"),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append("\n ecLevel: "),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append("\n version: "),e.append(this.version?this.version.toString():"null"),e.append("\n maskPattern: "),e.append(this.maskPattern.toString()),this.matrix?(e.append("\n matrix:\n"),e.append(this.matrix.toString())):e.append("\n matrix: null\n"),e.append(">>\n"),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<Br.NUM_MASK_PATTERNS}}Br.NUM_MASK_PATTERNS=8;class Lr extends c{}Lr.kind="WriterException";class kr{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,r,n,i){kr.clearMatrix(i),kr.embedBasicPatterns(r,i),kr.embedTypeInfo(t,n,i),kr.maybeEmbedVersionInfo(r,i),kr.embedDataBits(e,n,i)}static embedBasicPatterns(e,t){kr.embedPositionDetectionPatternsAndSeparators(t),kr.embedDarkDotAtLeftBottomCorner(t),kr.maybeEmbedPositionAdjustmentPatterns(e,t),kr.embedTimingPatterns(t)}static embedTypeInfo(e,t,r){const n=new y;kr.makeTypeInfoBits(e,t,n);for(let i=0,s=n.getSize();i<s;++i){const e=n.get(n.getSize()-1-i),t=kr.TYPE_INFO_COORDINATES[i],s=t[0],o=t[1];if(r.setBoolean(s,o,e),i<8){const t=r.getWidth()-i-1,n=8;r.setBoolean(t,n,e)}else{const t=8,n=r.getHeight()-7+(i-8);r.setBoolean(t,n,e)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const r=new y;kr.makeVersionInfoBits(e,r);let n=17;for(let i=0;i<6;++i)for(let e=0;e<3;++e){const s=r.get(n);n--,t.setBoolean(i,t.getHeight()-11+e,s),t.setBoolean(t.getHeight()-11+e,i,s)}}static embedDataBits(e,t,r){let n=0,i=-1,s=r.getWidth()-1,o=r.getHeight()-1;for(;s>0;){for(6===s&&(s-=1);o>=0&&o<r.getHeight();){for(let i=0;i<2;++i){const a=s-i;if(!kr.isEmpty(r.get(a,o)))continue;let l;n<e.getSize()?(l=e.get(n),++n):l=!1,255!==t&&Or.getDataMaskBit(t,a,o)&&(l=!l),r.setBoolean(a,o,l)}o+=i}i=-i,o+=i,s-=2}if(n!==e.getSize())throw new Lr("Not all bits consumed: "+n+"/"+e.getSize())}static findMSBSet(e){return 32-C.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(0===t)throw new h("0 polynomial");const r=kr.findMSBSet(t);for(e<<=r-1;kr.findMSBSet(e)>=r;)e^=t<<kr.findMSBSet(e)-r;return e}static makeTypeInfoBits(e,t,r){if(!Br.isValidMaskPattern(t))throw new Lr("Invalid mask pattern");const n=e.getBits()<<3|t;r.appendBits(n,5);const i=kr.calculateBCHCode(n,kr.TYPE_INFO_POLY);r.appendBits(i,10);const s=new y;if(s.appendBits(kr.TYPE_INFO_MASK_PATTERN,15),r.xor(s),15!==r.getSize())throw new Lr("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const r=kr.calculateBCHCode(e.getVersionNumber(),kr.VERSION_INFO_POLY);if(t.appendBits(r,12),18!==t.getSize())throw new Lr("should not happen but we got: "+t.getSize())}static isEmpty(e){return 255===e}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const r=(t+1)%2;kr.isEmpty(e.get(t,6))&&e.setNumber(t,6,r),kr.isEmpty(e.get(6,t))&&e.setNumber(6,t,r)}}static embedDarkDotAtLeftBottomCorner(e){if(0===e.get(8,e.getHeight()-8))throw new Lr;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,r){for(let n=0;n<8;++n){if(!kr.isEmpty(r.get(e+n,t)))throw new Lr;r.setNumber(e+n,t,0)}}static embedVerticalSeparationPattern(e,t,r){for(let n=0;n<7;++n){if(!kr.isEmpty(r.get(e,t+n)))throw new Lr;r.setNumber(e,t+n,0)}}static embedPositionAdjustmentPattern(e,t,r){for(let n=0;n<5;++n){const i=kr.POSITION_ADJUSTMENT_PATTERN[n];for(let s=0;s<5;++s)r.setNumber(e+s,t+n,i[s])}}static embedPositionDetectionPattern(e,t,r){for(let n=0;n<7;++n){const i=kr.POSITION_DETECTION_PATTERN[n];for(let s=0;s<7;++s)r.setNumber(e+s,t+n,i[s])}}static embedPositionDetectionPatternsAndSeparators(e){const t=kr.POSITION_DETECTION_PATTERN[0].length;kr.embedPositionDetectionPattern(0,0,e),kr.embedPositionDetectionPattern(e.getWidth()-t,0,e),kr.embedPositionDetectionPattern(0,e.getWidth()-t,e);const r=8;kr.embedHorizontalSeparationPattern(0,r-1,e),kr.embedHorizontalSeparationPattern(e.getWidth()-r,r-1,e),kr.embedHorizontalSeparationPattern(0,e.getWidth()-r,e);const n=7;kr.embedVerticalSeparationPattern(n,0,e),kr.embedVerticalSeparationPattern(e.getHeight()-n-1,0,e),kr.embedVerticalSeparationPattern(n,e.getHeight()-n,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const r=e.getVersionNumber()-1,n=kr.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let i=0,s=n.length;i!==s;i++){const e=n[i];if(e>=0)for(let r=0;r!==s;r++){const i=n[r];i>=0&&kr.isEmpty(t.get(i,e))&&kr.embedPositionAdjustmentPattern(i-2,e-2,t)}}}}kr.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),kr.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),kr.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),kr.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),kr.VERSION_INFO_POLY=7973,kr.TYPE_INFO_POLY=1335,kr.TYPE_INFO_MASK_PATTERN=21522;class jr{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Fr{constructor(){}static calculateMaskPenalty(e){return Or.applyMaskPenaltyRule1(e)+Or.applyMaskPenaltyRule2(e)+Or.applyMaskPenaltyRule3(e)+Or.applyMaskPenaltyRule4(e)}static encode(e,t,r=null){let n=Fr.DEFAULT_BYTE_MODE_ENCODING;const i=null!==r&&void 0!==r.get(Rr.CHARACTER_SET);i&&(n=r.get(Rr.CHARACTER_SET).toString());const s=this.chooseMode(e,n),o=new y;if(s===jt.BYTE&&(i||Fr.DEFAULT_BYTE_MODE_ENCODING!==n)){const e=N.getCharacterSetECIByName(n);void 0!==e&&this.appendECI(e,o)}this.appendModeInfo(s,o);const a=new y;let l;if(this.appendBytes(e,s,a,n),null!==r&&void 0!==r.get(Rr.QR_VERSION)){const e=Number.parseInt(r.get(Rr.QR_VERSION).toString(),10);l=Pt.getVersionForNumber(e);const n=this.calculateBitsNeeded(s,o,a,l);if(!this.willFit(n,l,t))throw new Lr("Data too big for requested version")}else l=this.recommendVersion(t,s,o,a);const c=new y;c.appendBitArray(o);const d=s===jt.BYTE?a.getSizeInBytes():e.length;this.appendLengthInfo(d,l,s,c),c.appendBitArray(a);const h=l.getECBlocksForLevel(t),u=l.getTotalCodewords()-h.getTotalECCodewords();this.terminateBits(u,c);const f=this.interleaveWithECBytes(c,l.getTotalCodewords(),u,h.getNumBlocks()),g=new Br;g.setECLevel(t),g.setMode(s),g.setVersion(l);const m=l.getDimensionForVersion(),p=new Pr(m,m),w=this.chooseMaskPattern(f,t,l,p);return g.setMaskPattern(w),kr.buildMatrix(f,t,l,w,p),g.setMatrix(p),g}static recommendVersion(e,t,r,n){const i=this.calculateBitsNeeded(t,r,n,Pt.getVersionForNumber(1)),s=this.chooseVersion(i,e),o=this.calculateBitsNeeded(t,r,n,s);return this.chooseVersion(o,e)}static calculateBitsNeeded(e,t,r,n){return t.getSize()+e.getCharacterCountBits(n)+r.getSize()}static getAlphanumericCode(e){return e<Fr.ALPHANUMERIC_TABLE.length?Fr.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(N.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return jt.KANJI;let r=!1,n=!1;for(let i=0,s=e.length;i<s;++i){const t=e.charAt(i);if(Fr.isDigit(t))r=!0;else{if(-1===this.getAlphanumericCode(t.charCodeAt(0)))return jt.BYTE;n=!0}}return n?jt.ALPHANUMERIC:r?jt.NUMERIC:jt.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=b.encode(e,N.SJIS)}catch(n){return!1}const r=t.length;if(r%2!=0)return!1;for(let i=0;i<r;i+=2){const e=255&t[i];if((e<129||e>159)&&(e<224||e>235))return!1}return!0}static chooseMaskPattern(e,t,r,n){let i=Number.MAX_SAFE_INTEGER,s=-1;for(let o=0;o<Br.NUM_MASK_PATTERNS;o++){kr.buildMatrix(e,t,r,o,n);let a=this.calculateMaskPenalty(n);a<i&&(i=a,s=o)}return s}static chooseVersion(e,t){for(let r=1;r<=40;r++){const n=Pt.getVersionForNumber(r);if(Fr.willFit(e,n,t))return n}throw new Lr("Data too big")}static willFit(e,t,r){return t.getTotalCodewords()-t.getECBlocksForLevel(r).getTotalECCodewords()>=(e+7)/8}static terminateBits(e,t){const r=8*e;if(t.getSize()>r)throw new Lr("data bits cannot fit in the QR Code"+t.getSize()+" > "+r);for(let s=0;s<4&&t.getSize()<r;++s)t.appendBit(!1);const n=7&t.getSize();if(n>0)for(let s=n;s<8;s++)t.appendBit(!1);const i=e-t.getSizeInBytes();for(let s=0;s<i;++s)t.appendBits(1&s?17:236,8);if(t.getSize()!==r)throw new Lr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,r,n,i,s){if(n>=r)throw new Lr("Block ID too large");const o=e%r,a=r-o,l=Math.floor(e/r),c=l+1,d=Math.floor(t/r),h=d+1,u=l-d,f=c-h;if(u!==f)throw new Lr("EC bytes mismatch");if(r!==a+o)throw new Lr("RS blocks mismatch");if(e!==(d+u)*a+(h+f)*o)throw new Lr("Total bytes mismatch");n<a?(i[0]=d,s[0]=u):(i[0]=h,s[0]=f)}static interleaveWithECBytes(e,t,r,n){if(e.getSizeInBytes()!==r)throw new Lr("Number of bits and data bytes does not match");let i=0,s=0,o=0;const a=new Array;for(let c=0;c<n;++c){const l=new Int32Array(1),d=new Int32Array(1);Fr.getNumDataBytesAndNumECBytesForBlockID(t,r,n,c,l,d);const h=l[0],u=new Uint8Array(h);e.toBytes(8*i,u,0,h);const f=Fr.generateECBytes(u,d[0]);a.push(new jr(u,f)),s=Math.max(s,h),o=Math.max(o,f.length),i+=l[0]}if(r!==i)throw new Lr("Data bytes does not match offset");const l=new y;for(let c=0;c<s;++c)for(const e of a){const t=e.getDataBytes();c<t.length&&l.appendBits(t[c],8)}for(let c=0;c<o;++c)for(const e of a){const t=e.getErrorCorrectionBytes();c<t.length&&l.appendBits(t[c],8)}if(t!==l.getSizeInBytes())throw new Lr("Interleaving error: "+t+" and "+l.getSizeInBytes()+" differ.");return l}static generateECBytes(e,t){const r=e.length,n=new Int32Array(r+t);for(let s=0;s<r;s++)n[s]=255&e[s];new vr(le.QR_CODE_FIELD_256).encode(n,t);const i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=n[r+s];return i}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,r,n){const i=r.getCharacterCountBits(t);if(e>=1<<i)throw new Lr(e+" is bigger than "+((1<<i)-1));n.appendBits(e,i)}static appendBytes(e,t,r,n){switch(t){case jt.NUMERIC:Fr.appendNumericBytes(e,r);break;case jt.ALPHANUMERIC:Fr.appendAlphanumericBytes(e,r);break;case jt.BYTE:Fr.append8BitBytes(e,r,n);break;case jt.KANJI:Fr.appendKanjiBytes(e,r);break;default:throw new Lr("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=Fr.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const r=e.length;let n=0;for(;n<r;){const i=Fr.getDigit(e.charAt(n));if(n+2<r){const r=Fr.getDigit(e.charAt(n+1)),s=Fr.getDigit(e.charAt(n+2));t.appendBits(100*i+10*r+s,10),n+=3}else if(n+1<r){const r=Fr.getDigit(e.charAt(n+1));t.appendBits(10*i+r,7),n+=2}else t.appendBits(i,4),n++}}static appendAlphanumericBytes(e,t){const r=e.length;let n=0;for(;n<r;){const i=Fr.getAlphanumericCode(e.charCodeAt(n));if(-1===i)throw new Lr;if(n+1<r){const r=Fr.getAlphanumericCode(e.charCodeAt(n+1));if(-1===r)throw new Lr;t.appendBits(45*i+r,11),n+=2}else t.appendBits(i,6),n++}}static append8BitBytes(e,t,r){let n;try{n=b.encode(e,r)}catch(i){throw new Lr(i)}for(let s=0,o=n.length;s!==o;s++){const e=n[s];t.appendBits(e,8)}}static appendKanjiBytes(e,t){let r;try{r=b.encode(e,N.SJIS)}catch(i){throw new Lr(i)}const n=r.length;for(let s=0;s<n;s+=2){const e=(255&r[s])<<8&4294967295|255&r[s+1];let n=-1;if(e>=33088&&e<=40956?n=e-33088:e>=57408&&e<=60351&&(n=e-49472),-1===n)throw new Lr("Invalid byte sequence");const i=192*(n>>8)+(255&n);t.appendBits(i,13)}}static appendECI(e,t){t.appendBits(jt.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}Fr.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Fr.DEFAULT_BYTE_MODE_ENCODING=N.UTF8.getName();class Ur{write(e,t,r,n=null){if(0===e.length)throw new h("Found empty contents");if(t<0||r<0)throw new h("Requested dimensions are too small: "+t+"x"+r);let i=Mt.L,s=Ur.QUIET_ZONE_SIZE;null!==n&&(void 0!==n.get(Rr.ERROR_CORRECTION)&&(i=Mt.fromString(n.get(Rr.ERROR_CORRECTION).toString())),void 0!==n.get(Rr.MARGIN)&&(s=Number.parseInt(n.get(Rr.MARGIN).toString(),10)));const o=Fr.encode(e,i,n);return this.renderResult(o,t,r,s)}writeToDom(e,t,r,n,i=null){"string"==typeof e&&(e=document.querySelector(e));const s=this.write(t,r,n,i);e&&e.appendChild(s)}renderResult(e,t,r,n){const i=e.getMatrix();if(null===i)throw new de;const s=i.getWidth(),o=i.getHeight(),a=s+2*n,l=o+2*n,c=Math.max(t,a),d=Math.max(r,l),h=Math.min(Math.floor(c/a),Math.floor(d/l)),u=Math.floor((c-s*h)/2),f=Math.floor((d-o*h)/2),g=this.createSVGElement(c,d);for(let m=0,p=f;m<o;m++,p+=h)for(let e=0,t=u;e<s;e++,t+=h)if(1===i.get(e,m)){const e=this.createSvgRectElement(t,p,h,h);g.appendChild(e)}return g}createSVGElement(e,t){const r=document.createElementNS(Ur.SVG_NS,"svg");return r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"width",t.toString()),r}createSvgRectElement(e,t,r,n){const i=document.createElementNS(Ur.SVG_NS,"rect");return i.setAttributeNS(null,"x",e.toString()),i.setAttributeNS(null,"y",t.toString()),i.setAttributeNS(null,"height",r.toString()),i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"fill","#000000"),i}}Ur.QUIET_ZONE_SIZE=4,Ur.SVG_NS="http://www.w3.org/2000/svg";class Hr{encode(e,t,r,n,i){if(0===e.length)throw new h("Found empty contents");if(t!==Y.QR_CODE)throw new h("Can only encode QR_CODE, but got "+t);if(r<0||n<0)throw new h(`Requested dimensions are too small: ${r}x${n}`);let s=Mt.L,o=Hr.QUIET_ZONE_SIZE;null!==i&&(void 0!==i.get(Rr.ERROR_CORRECTION)&&(s=Mt.fromString(i.get(Rr.ERROR_CORRECTION).toString())),void 0!==i.get(Rr.MARGIN)&&(o=Number.parseInt(i.get(Rr.MARGIN).toString(),10)));const a=Fr.encode(e,s,i);return Hr.renderResult(a,r,n,o)}static renderResult(e,t,r,n){const i=e.getMatrix();if(null===i)throw new de;const s=i.getWidth(),o=i.getHeight(),a=s+2*n,l=o+2*n,c=Math.max(t,a),d=Math.max(r,l),h=Math.min(Math.floor(c/a),Math.floor(d/l)),u=Math.floor((c-s*h)/2),f=Math.floor((d-o*h)/2),g=new M(c,d);for(let m=0,p=f;m<o;m++,p+=h)for(let e=0,t=u;e<s;e++,t+=h)1===i.get(e,m)&&g.setRegion(t,p,h,h);return g}}Hr.QUIET_ZONE_SIZE=4;class Vr{encode(e,t,r,n,i){let s;if(t!==Y.QR_CODE)throw new h("No encoder available for format "+t);return s=new Hr,s.encode(e,t,r,n,i)}}class zr extends P{constructor(e,t,r,n,i,s,o,a){if(super(s,o),this.yuvData=e,this.dataWidth=t,this.dataHeight=r,this.left=n,this.top=i,n+s>t||i+o>r)throw new h("Crop rectangle does not fit within image data.");a&&this.reverseHorizontal(s,o)}getRow(e,t){if(e<0||e>=this.getHeight())throw new h("Requested row is outside the image: "+e);const r=this.getWidth();(null==t||t.length<r)&&(t=new Uint8ClampedArray(r));const n=(e+this.top)*this.dataWidth+this.left;return m.arraycopy(this.yuvData,n,t,0,r),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const r=e*t,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return m.arraycopy(this.yuvData,i,n,0,r),n;for(let s=0;s<t;s++){const t=s*e;m.arraycopy(this.yuvData,i,n,t,e),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(e,t,r,n){return new zr(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,r,n,!1)}renderThumbnail(){const e=this.getWidth()/zr.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/zr.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(e*t),n=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let s=0;s<t;s++){const t=s*e;for(let s=0;s<e;s++){const e=255&n[i+s*zr.THUMBNAIL_SCALE_FACTOR];r[t+s]=4278190080|65793*e}i+=this.dataWidth*zr.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/zr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/zr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const r=this.yuvData;for(let n=0,i=this.top*this.dataWidth+this.left;n<t;n++,i+=this.dataWidth){const t=i+e/2;for(let n=i,s=i+e-1;n<t;n++,s--){const e=r[n];r[n]=r[s],r[s]=e}}}invert(){return new B(this)}}zr.THUMBNAIL_SCALE_FACTOR=2;class Gr extends P{constructor(e,t,r,n,i,s,o){if(super(t,r),this.dataWidth=n,this.dataHeight=i,this.left=s,this.top=o,4===e.BYTES_PER_ELEMENT){const n=t*r,i=new Uint8ClampedArray(n);for(let t=0;t<n;t++){const r=e[t],n=r>>16&255,s=r>>7&510,o=255&r;i[t]=(n+s+o)/4&255}this.luminances=i}else this.luminances=e;if(void 0===n&&(this.dataWidth=t),void 0===i&&(this.dataHeight=r),void 0===s&&(this.left=0),void 0===o&&(this.top=0),this.left+t>this.dataWidth||this.top+r>this.dataHeight)throw new h("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new h("Requested row is outside the image: "+e);const r=this.getWidth();(null==t||t.length<r)&&(t=new Uint8ClampedArray(r));const n=(e+this.top)*this.dataWidth+this.left;return m.arraycopy(this.luminances,n,t,0,r),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const r=e*t,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return m.arraycopy(this.luminances,i,n,0,r),n;for(let s=0;s<t;s++){const t=s*e;m.arraycopy(this.luminances,i,n,t,e),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(e,t,r,n){return new Gr(this.luminances,r,n,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new B(this)}}class Yr extends N{static forName(e){return this.getCharacterSetECIByName(e)}}class Wr{}Wr.ISO_8859_1=N.ISO8859_1;class Xr{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Zr{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class Qr{constructor(e){this.previous=e}getPrevious(){return this.previous}}class qr extends Qr{constructor(e,t,r){super(e),this.value=t,this.bitCount=r}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new qr(this,e,t)}addBinaryShift(e,t){return new qr(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+C.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class Kr extends qr{constructor(e,t,r){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=r}appendTo(e,t){for(let r=0;r<this.binaryShiftByteCount;r++)(0===r||31===r&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):0===r?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+r],8)}addBinaryShift(e,t){return new Kr(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function $r(e,t,r){return new Kr(e,t,r)}function Jr(e,t,r){return new qr(e,t,r)}const en=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],tn=0,rn=1,nn=2,sn=3,on=4,an=new qr(null,0,0),ln=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])];function cn(e){for(let t of e)A.fill(t,-1);return e[tn][on]=0,e[rn][on]=0,e[rn][tn]=28,e[sn][on]=0,e[nn][on]=0,e[nn][tn]=15,e}const dn=cn(A.createInt32Array(6,6));class hn{constructor(e,t,r,n){this.token=e,this.mode=t,this.binaryShiftByteCount=r,this.bitCount=n}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let r=this.bitCount,n=this.token;if(e!==this.mode){let t=ln[this.mode][e];n=Jr(n,65535&t,t>>16),r+=t>>16}let i=e===nn?4:5;return n=Jr(n,t,i),new hn(n,e,0,r+i)}shiftAndAppend(e,t){let r=this.token,n=this.mode===nn?4:5;return r=Jr(r,dn[this.mode][e],n),r=Jr(r,t,5),new hn(r,this.mode,0,this.bitCount+n+5)}addBinaryShiftChar(e){let t=this.token,r=this.mode,n=this.bitCount;if(this.mode===on||this.mode===nn){let e=ln[r][tn];t=Jr(t,65535&e,e>>16),n+=e>>16,r=tn}let i=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,s=new hn(t,r,this.binaryShiftByteCount+1,n+i);return 2078===s.binaryShiftByteCount&&(s=s.endBinaryShift(e+1)),s}endBinaryShift(e){if(0===this.binaryShiftByteCount)return this;let t=this.token;return t=$r(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new hn(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(ln[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=hn.calculateBinaryShiftCost(e)-hn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let n=this.endBinaryShift(e.length).token;null!==n;n=n.getPrevious())t.unshift(n);let r=new y;for(const n of t)n.appendTo(r,e);return r}toString(){return x.format("%s bits=%d bytes=%d",en[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}function un(e){const t=x.getCharCode(" "),r=x.getCharCode("."),n=x.getCharCode(",");e[tn][t]=1;const i=x.getCharCode("Z"),s=x.getCharCode("A");for(let u=s;u<=i;u++)e[tn][u]=u-s+2;e[rn][t]=1;const o=x.getCharCode("z"),a=x.getCharCode("a");for(let u=a;u<=o;u++)e[rn][u]=u-a+2;e[nn][t]=1;const l=x.getCharCode("9"),c=x.getCharCode("0");for(let u=c;u<=l;u++)e[nn][u]=u-c+2;e[nn][n]=12,e[nn][r]=13;const d=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""];for(let u=0;u<d.length;u++)e[sn][x.getCharCode(d[u])]=u;const h=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let u=0;u<h.length;u++)x.getCharCode(h[u])>0&&(e[on][x.getCharCode(h[u])]=u);return e}hn.INITIAL_STATE=new hn(an,tn,0,0);const fn=un(A.createInt32Array(5,256));class gn{constructor(e){this.text=e}encode(){const e=x.getCharCode(" "),t=x.getCharCode("\n");let r=Zr.singletonList(hn.INITIAL_STATE);for(let n=0;n<this.text.length;n++){let i,s=n+1<this.text.length?this.text[n+1]:0;switch(this.text[n]){case x.getCharCode("\r"):i=s===t?2:0;break;case x.getCharCode("."):i=s===e?3:0;break;case x.getCharCode(","):i=s===e?4:0;break;case x.getCharCode(":"):i=s===e?5:0;break;default:i=0}i>0?(r=gn.updateStateListForPair(r,n,i),n++):r=this.updateStateListForChar(r,n)}return Zr.min(r,(e,t)=>e.getBitCount()-t.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const r=[];for(let n of e)this.updateStateForChar(n,t,r);return gn.simplifyStates(r)}updateStateForChar(e,t,r){let n=255&this.text[t],i=fn[e.getMode()][n]>0,s=null;for(let o=0;o<=on;o++){let a=fn[o][n];if(a>0){if(null==s&&(s=e.endBinaryShift(t)),!i||o===e.getMode()||o===nn){const e=s.latchAndAppend(o,a);r.push(e)}if(!i&&dn[e.getMode()][o]>=0){const e=s.shiftAndAppend(o,a);r.push(e)}}}if(e.getBinaryShiftByteCount()>0||0===fn[e.getMode()][n]){let n=e.addBinaryShiftChar(t);r.push(n)}}static updateStateListForPair(e,t,r){const n=[];for(let i of e)this.updateStateForPair(i,t,r,n);return this.simplifyStates(n)}static updateStateForPair(e,t,r,n){let i=e.endBinaryShift(t);if(n.push(i.latchAndAppend(on,r)),e.getMode()!==on&&n.push(i.shiftAndAppend(on,r)),3===r||4===r){let e=i.latchAndAppend(nn,16-r).latchAndAppend(nn,1);n.push(e)}if(e.getBinaryShiftByteCount()>0){let r=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);n.push(r)}}static simplifyStates(e){let t=[];for(const r of e){let e=!0;for(const n of t){if(n.isBetterThanOrEqualTo(r)){e=!1;break}r.isBetterThanOrEqualTo(n)&&(t=t.filter(e=>e!==n))}e&&t.push(r)}return t}}class mn{constructor(){}static encodeBytes(e){return mn.encode(e,mn.DEFAULT_EC_PERCENT,mn.DEFAULT_AZTEC_LAYERS)}static encode(e,t,r){let n,i,s,o,a,l=new gn(e).encode(),c=C.truncDivision(l.getSize()*t,100)+11,d=l.getSize()+c;if(r!==mn.DEFAULT_AZTEC_LAYERS){if(n=r<0,i=Math.abs(r),i>(n?mn.MAX_NB_BITS_COMPACT:mn.MAX_NB_BITS))throw new h(x.format("Illegal value %s for layers",r));s=mn.totalBitsInLayer(i,n),o=mn.WORD_SIZE[i];let e=s-s%o;if(a=mn.stuffBits(l,o),a.getSize()+c>e)throw new h("Data to large for user specified layer");if(n&&a.getSize()>64*o)throw new h("Data to large for user specified layer")}else{o=0,a=null;for(let e=0;;e++){if(e>mn.MAX_NB_BITS)throw new h("Data too large for an Aztec code");if(n=e<=3,i=n?e+1:e,s=mn.totalBitsInLayer(i,n),d>s)continue;null!=a&&o===mn.WORD_SIZE[i]||(o=mn.WORD_SIZE[i],a=mn.stuffBits(l,o));let t=s-s%o;if(!(n&&a.getSize()>64*o)&&a.getSize()+c<=t)break}}let u,f=mn.generateCheckWords(a,s,o),g=a.getSize()/o,m=mn.generateModeMessage(n,i,g),p=(n?11:14)+4*i,w=new Int32Array(p);if(n){u=p;for(let e=0;e<w.length;e++)w[e]=e}else{u=p+1+2*C.truncDivision(C.truncDivision(p,2)-1,15);let e=C.truncDivision(p,2),t=C.truncDivision(u,2);for(let r=0;r<e;r++){let n=r+C.truncDivision(r,15);w[e-r-1]=t-n-1,w[e+r]=t+n+1}}let A=new M(u);for(let h=0,C=0;h<i;h++){let e=4*(i-h)+(n?9:12);for(let t=0;t<e;t++){let r=2*t;for(let n=0;n<2;n++)f.get(C+r+n)&&A.set(w[2*h+n],w[2*h+t]),f.get(C+2*e+r+n)&&A.set(w[2*h+t],w[p-1-2*h-n]),f.get(C+4*e+r+n)&&A.set(w[p-1-2*h-n],w[p-1-2*h-t]),f.get(C+6*e+r+n)&&A.set(w[p-1-2*h-t],w[2*h+n])}C+=8*e}if(mn.drawModeMessage(A,n,u,m),n)mn.drawBullsEye(A,C.truncDivision(u,2),5);else{mn.drawBullsEye(A,C.truncDivision(u,2),7);for(let e=0,t=0;e<C.truncDivision(p,2)-1;e+=15,t+=16)for(let r=1&C.truncDivision(u,2);r<u;r+=2)A.set(C.truncDivision(u,2)-t,r),A.set(C.truncDivision(u,2)+t,r),A.set(r,C.truncDivision(u,2)-t),A.set(r,C.truncDivision(u,2)+t)}let y=new Xr;return y.setCompact(n),y.setSize(u),y.setLayers(i),y.setCodeWords(g),y.setMatrix(A),y}static drawBullsEye(e,t,r){for(let n=0;n<r;n+=2)for(let r=t-n;r<=t+n;r++)e.set(r,t-n),e.set(r,t+n),e.set(t-n,r),e.set(t+n,r);e.set(t-r,t-r),e.set(t-r+1,t-r),e.set(t-r,t-r+1),e.set(t+r,t-r),e.set(t+r,t-r+1),e.set(t+r,t+r-1)}static generateModeMessage(e,t,r){let n=new y;return e?(n.appendBits(t-1,2),n.appendBits(r-1,6),n=mn.generateCheckWords(n,28,4)):(n.appendBits(t-1,5),n.appendBits(r-1,11),n=mn.generateCheckWords(n,40,4)),n}static drawModeMessage(e,t,r,n){let i=C.truncDivision(r,2);if(t)for(let s=0;s<7;s++){let t=i-3+s;n.get(s)&&e.set(t,i-5),n.get(s+7)&&e.set(i+5,t),n.get(20-s)&&e.set(t,i+5),n.get(27-s)&&e.set(i-5,t)}else for(let s=0;s<10;s++){let t=i-5+s+C.truncDivision(s,5);n.get(s)&&e.set(t,i-7),n.get(s+10)&&e.set(i+7,t),n.get(29-s)&&e.set(t,i+7),n.get(39-s)&&e.set(i-7,t)}}static generateCheckWords(e,t,r){let n=e.getSize()/r,i=new vr(mn.getGF(r)),s=C.truncDivision(t,r),o=mn.bitsToWords(e,r,s);i.encode(o,s-n);let a=t%r,l=new y;l.appendBits(0,a);for(const c of Array.from(o))l.appendBits(c,r);return l}static bitsToWords(e,t,r){let n,i,s=new Int32Array(r);for(n=0,i=e.getSize()/t;n<i;n++){let r=0;for(let i=0;i<t;i++)r|=e.get(n*t+i)?1<<t-i-1:0;s[n]=r}return s}static getGF(e){switch(e){case 4:return le.AZTEC_PARAM;case 6:return le.AZTEC_DATA_6;case 8:return le.AZTEC_DATA_8;case 10:return le.AZTEC_DATA_10;case 12:return le.AZTEC_DATA_12;default:throw new h("Unsupported word size "+e)}}static stuffBits(e,t){let r=new y,n=e.getSize(),i=(1<<t)-2;for(let s=0;s<n;s+=t){let o=0;for(let r=0;r<t;r++)(s+r>=n||e.get(s+r))&&(o|=1<<t-1-r);(o&i)===i?(r.appendBits(o&i,t),s--):0===(o&i)?(r.appendBits(1|o,t),s--):r.appendBits(o,t)}return r}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}mn.DEFAULT_EC_PERCENT=33,mn.DEFAULT_AZTEC_LAYERS=0,mn.MAX_NB_BITS=32,mn.MAX_NB_BITS_COMPACT=4,mn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class pn{encode(e,t,r,n){return this.encodeWithHints(e,t,r,n,null)}encodeWithHints(e,t,r,n,i){let s=Wr.ISO_8859_1,o=mn.DEFAULT_EC_PERCENT,a=mn.DEFAULT_AZTEC_LAYERS;return null!=i&&(i.has(Rr.CHARACTER_SET)&&(s=Yr.forName(i.get(Rr.CHARACTER_SET).toString())),i.has(Rr.ERROR_CORRECTION)&&(o=C.parseInt(i.get(Rr.ERROR_CORRECTION).toString())),i.has(Rr.AZTEC_LAYERS)&&(a=C.parseInt(i.get(Rr.AZTEC_LAYERS).toString()))),pn.encodeLayers(e,t,r,n,s,o,a)}static encodeLayers(e,t,r,n,i,s,o){if(t!==Y.AZTEC)throw new h("Can only encode AZTEC, but got "+t);let a=mn.encode(x.getBytes(e,i),s,o);return pn.renderResult(a,r,n)}static renderResult(e,t,r){let n=e.getMatrix();if(null==n)throw new de;let i=n.getWidth(),s=n.getHeight(),o=Math.max(t,i),a=Math.max(r,s),l=Math.min(o/i,a/s),c=(o-i*l)/2,d=(a-s*l)/2,h=new M(o,a);for(let u=0,f=d;u<s;u++,f+=l)for(let e=0,t=c;e<i;e++,t+=l)n.get(e,u)&&h.setRegion(t,f,l,l);return h}}e.AbstractExpandedDecoder=et,e.ArgumentException=d,e.ArithmeticException=ae,e.AztecCode=Xr,e.AztecCodeReader=Ne,e.AztecCodeWriter=pn,e.AztecDecoder=ue,e.AztecDetector=Ie,e.AztecDetectorResult=we,e.AztecEncoder=mn,e.AztecHighLevelEncoder=gn,e.AztecPoint=Se,e.BarcodeFormat=Y,e.Binarizer=g,e.BinaryBitmap=u,e.BitArray=y,e.BitMatrix=M,e.BitSource=It,e.BrowserAztecCodeReader=Te,e.BrowserBarcodeReader=At,e.BrowserCodeReader=H,e.BrowserDatamatrixCodeReader=Dt,e.BrowserMultiFormatReader=Tr,e.BrowserPDF417Reader=br,e.BrowserQRCodeReader=xr,e.BrowserQRCodeSvgWriter=Ur,e.CharacterSetECI=N,e.ChecksumException=f,e.Code128Reader=xe,e.Code39Reader=De,e.DataMatrixDecodedBitStreamParser=Nt,e.DataMatrixReader=xt,e.DecodeHintType=S,e.DecoderResult=ie,e.DefaultGridSampler=Ee,e.DetectorResult=pe,e.EAN13Reader=ke,e.EncodeHintType=Rr,e.Exception=c,e.FormatException=I,e.GenericGF=le,e.GenericGFPoly=oe,e.GlobalHistogramBinarizer=v,e.GridSampler=Ce,e.GridSamplerInstance=_e,e.HTMLCanvasElementLuminanceSource=L,e.HybridBinarizer=O,e.ITFReader=Me,e.IllegalArgumentException=h,e.IllegalStateException=de,e.InvertedLuminanceSource=B,e.LuminanceSource=P,e.MathUtils=fe,e.MultiFormatOneDReader=wt,e.MultiFormatReader=Nr,e.MultiFormatWriter=Vr,e.NotFoundException=R,e.OneDReader=be,e.PDF417DecodedBitStreamParser=Er,e.PDF417DecoderErrorCorrection=tr,e.PDF417Reader=Sr,e.PDF417ResultMetadata=hr,e.PerspectiveTransform=ye,e.PlanarYUVLuminanceSource=zr,e.QRCodeByteMatrix=Pr,e.QRCodeDataMask=Bt,e.QRCodeDecodedBitStreamParser=Ft,e.QRCodeDecoderErrorCorrectionLevel=Mt,e.QRCodeDecoderFormatInformation=Rt,e.QRCodeEncoder=Fr,e.QRCodeEncoderQRCode=Br,e.QRCodeMaskUtil=Or,e.QRCodeMatrixUtil=kr,e.QRCodeMode=jt,e.QRCodeReader=Zt,e.QRCodeVersion=Pt,e.QRCodeWriter=Hr,e.RGBLuminanceSource=Gr,e.RSS14Reader=pt,e.RSSExpandedReader=gt,e.ReaderException=Ir,e.ReedSolomonDecoder=he,e.ReedSolomonEncoder=vr,e.ReedSolomonException=ce,e.Result=V,e.ResultMetadataType=ne,e.ResultPoint=me,e.StringUtils=x,e.UnsupportedOperationException=T,e.VideoInputDevice=k,e.WhiteRectangleDetector=Ae,e.WriterException=Lr,e.ZXingArrays=A,e.ZXingCharset=Yr,e.ZXingInteger=C,e.ZXingStandardCharsets=Wr,e.ZXingStringBuilder=D,e.ZXingStringEncoding=b,e.ZXingSystem=m,e.createAbstractExpandedDecoder=ht,Object.defineProperty(e,"__esModule",{value:!0})}(et.exports);var tt=et.exports;const rt=Me({__proto__:null,default:$(tt)},[tt]);var nt,it,st=function(){function e(e,t,r){if(this.formatMap=new Map([[Oe.QR_CODE,tt.BarcodeFormat.QR_CODE],[Oe.AZTEC,tt.BarcodeFormat.AZTEC],[Oe.CODABAR,tt.BarcodeFormat.CODABAR],[Oe.CODE_39,tt.BarcodeFormat.CODE_39],[Oe.CODE_93,tt.BarcodeFormat.CODE_93],[Oe.CODE_128,tt.BarcodeFormat.CODE_128],[Oe.DATA_MATRIX,tt.BarcodeFormat.DATA_MATRIX],[Oe.MAXICODE,tt.BarcodeFormat.MAXICODE],[Oe.ITF,tt.BarcodeFormat.ITF],[Oe.EAN_13,tt.BarcodeFormat.EAN_13],[Oe.EAN_8,tt.BarcodeFormat.EAN_8],[Oe.PDF_417,tt.BarcodeFormat.PDF_417],[Oe.RSS_14,tt.BarcodeFormat.RSS_14],[Oe.RSS_EXPANDED,tt.BarcodeFormat.RSS_EXPANDED],[Oe.UPC_A,tt.BarcodeFormat.UPC_A],[Oe.UPC_E,tt.BarcodeFormat.UPC_E],[Oe.UPC_EAN_EXTENSION,tt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!rt)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=r;var n=this.createZXingFormats(e),i=new Map;i.set(tt.DecodeHintType.POSSIBLE_FORMATS,n),i.set(tt.DecodeHintType.TRY_HARDER,!1),this.hints=i}return e.prototype.decodeAsync=function(e){var t=this;return new Promise(function(r,n){try{r(t.decode(e))}catch(i){n(i)}})},e.prototype.decode=function(e){var t=new tt.MultiFormatReader(this.verbose,this.hints),r=new tt.HTMLCanvasElementLuminanceSource(e),n=new tt.BinaryBitmap(new tt.HybridBinarizer(r)),i=t.decode(n);return{text:i.text,format:Ye.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,r,n){e.set(t,r)}),e},e.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},e.prototype.createZXingFormats=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];this.formatMap.has(i)?t.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return t},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),ot=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},at=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},lt=function(){function e(t,r,n){if(this.formatMap=new Map([[Oe.QR_CODE,"qr_code"],[Oe.AZTEC,"aztec"],[Oe.CODABAR,"codabar"],[Oe.CODE_39,"code_39"],[Oe.CODE_93,"code_93"],[Oe.CODE_128,"code_128"],[Oe.DATA_MATRIX,"data_matrix"],[Oe.ITF,"itf"],[Oe.EAN_13,"ean_13"],[Oe.EAN_8,"ean_8"],[Oe.PDF_417,"pdf417"],[Oe.UPC_A,"upc_a"],[Oe.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=n;var i=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){return"BarcodeDetector"in window&&void 0!==new BarcodeDetector({formats:["qr_code"]})},e.prototype.decodeAsync=function(e){return ot(this,void 0,void 0,function(){var t,r;return at(this,function(n){switch(n.label){case 0:return[4,this.detector.detect(e)];case 1:if(!(t=n.sent())||0===t.length)throw"No barcode or QR code detected.";return[2,{text:(r=this.selectLargestBarcode(t)).rawValue,format:Ye.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(e){for(var t=null,r=0,n=0,i=e;n<i.length;n++){var s=i[n],o=s.boundingBox.width*s.boundingBox.height;o>r&&(r=o,t=s)}if(!t)throw"No largest barcode found";return t},e.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];this.formatMap.has(i)?t.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},e.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},e.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,r,n){e.set(t,r)}),e},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),ct=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},dt=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},ht=function(){function e(e,t,r,n){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,t&&lt.isSupported()?(this.primaryDecoder=new lt(e,r,n),this.secondaryDecoder=new st(e,r,n)):this.primaryDecoder=new st(e,r,n)}return e.prototype.decodeAsync=function(e){return ct(this,void 0,void 0,function(){var t;return dt(this,function(r){switch(r.label){case 0:t=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(e){return ct(this,void 0,void 0,function(){var t,r;return dt(this,function(n){switch(n.label){case 0:t=performance.now(),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,n.sent()];case 3:if(r=n.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw r;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?!1===this.wasPrimaryDecoderUsedInLastDecode?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,r=this.executionResults;t<r.length;t++){e+=r[t]}this.executionResults.length;this.executions=0,this.executionResults=[]}},e}(),ut=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ft=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},gt=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},mt=function(){function e(e,t){this.name=e,this.track=t}return e.prototype.isSupported=function(){return!!this.track.getCapabilities&&this.name in this.track.getCapabilities()},e.prototype.apply=function(e){var t={};t[this.name]=e;var r={advanced:[t]};return this.track.applyConstraints(r)},e.prototype.value=function(){var e=this.track.getSettings();return this.name in e?e[this.name]:null},e}(),pt=function(e){function t(t){return e.call(this,"zoom",t)||this}return ut(t,e),t}(function(e){function t(t,r){return e.call(this,t,r)||this}return ut(t,e),t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(e){var t={};t[this.name]=e;var r={advanced:[t]};return this.track.applyConstraints(r)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities()[this.name];return{min:e.min,max:e.max,step:e.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(mt)),wt=function(e){function t(t){return e.call(this,"torch",t)||this}return ut(t,e),t}(mt),At=function(){function e(e){this.track=e}return e.prototype.zoomFeature=function(){return new pt(this.track)},e.prototype.torchFeature=function(){return new wt(this.track)},e}(),Ct=function(){function e(e,t,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return e.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},e.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var r=e.surface.clientWidth,n=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(r,n),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,n,i){return ft(this,void 0,void 0,function(){var s,o;return gt(this,function(a){switch(a.label){case 0:return s=new e(t,r,i),n.aspectRatio?(o={aspectRatio:n.aspectRatio},[4,s.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:a.sent(),a.label=2;case 2:return s.setupSurface(),[2,s]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),0===this.mediaStream.getVideoTracks().length)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(e){this.failIfClosed();var t=this,r=function(){setTimeout(e,200),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(e){return ft(this,void 0,void 0,function(){return gt(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,r){var n=e.mediaStream.getVideoTracks().length,i=0;e.mediaStream.getVideoTracks().forEach(function(r){e.mediaStream.removeTrack(r),r.stop(),++i>=n&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},e.prototype.getCapabilities=function(){return new At(this.getFirstTrackOrFail())},e}(),yt=function(){function e(e){this.mediaStream=e}return e.prototype.render=function(e,t,r){return ft(this,void 0,void 0,function(){return gt(this,function(n){return[2,Ct.create(e,this.mediaStream,t,r)]})})},e.create=function(t){return ft(this,void 0,void 0,function(){var r;return gt(this,function(n){switch(n.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return[2,new e(n.sent())]}})})},e}(),Et=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},_t=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},St=function(){function e(){}return e.failIfNotSupported=function(){return Et(this,void 0,void 0,function(){return _t(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(e){return Et(this,void 0,void 0,function(){return _t(this,function(t){return[2,yt.create(e)]})})},e}(),It=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},Nt=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},Tt=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=qe.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=qe.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if("https:"===location.protocol)return!0;var e=location.host.split(":")[0];return"127.0.0.1"===e||"localhost"===e},e.getCamerasFromMediaDevices=function(){return It(this,void 0,void 0,function(){var e,t,r,n,i,s,o;return Nt(this,function(a){switch(a.label){case 0:return e=function(e){for(var t=0,r=e.getVideoTracks();t<r.length;t++){var n=r[t];n.enabled=!1,n.stop(),e.removeTrack(n)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=a.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=a.sent(),n=[],i=0,s=r;i<s.length;i++)"videoinput"===(o=s[i]).kind&&n.push({id:o.deviceId,label:o.label});return e(t),[2,n]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){MediaStreamTrack.getSources(function(t){for(var r=[],n=0,i=t;n<i.length;n++){var s=i[n];"video"===s.kind&&r.push({id:s.id,label:s.label})}e(r)})})},e}();(it=nt||(nt={}))[it.UNKNOWN=0]="UNKNOWN",it[it.NOT_STARTED=1]="NOT_STARTED",it[it.SCANNING=2]="SCANNING",it[it.PAUSED=3]="PAUSED";var bt,xt,Dt=function(){function e(){this.state=nt.NOT_STARTED,this.onGoingTransactionNewState=nt.UNKNOWN}return e.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},e.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===nt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=nt.UNKNOWN,this.directTransition(e)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===nt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=nt.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==nt.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(e){switch(this.state){case nt.UNKNOWN:throw"Transition from unknown is not allowed";case nt.NOT_STARTED:this.failIfNewStateIs(e,[nt.PAUSED]);case nt.SCANNING:case nt.PAUSED:}},e.prototype.failIfNewStateIs=function(e,t){for(var r=0,n=t;r<n.length;r++){if(e===n[r])throw"Cannot transition from ".concat(this.state," to ").concat(e)}},e}(),Mt=function(){function e(e){this.stateManager=e}return e.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},e.prototype.directTransition=function(e){this.stateManager.directTransition(e)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===nt.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==nt.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===nt.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===nt.PAUSED},e}(),Rt=function(){function e(){}return e.create=function(){return new Mt(new Dt)},e}(),vt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return vt(t,e),t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(Ge),Pt=function(){function e(e,t){this.logger=t,this.fps=Ot.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=!0===e.disableFlip,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Ot.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Je.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Qe(this.qrbox)},e.create=function(t,r){return new e(t,r)},e}(),Bt=function(){function e(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");var r;this.elementId=e,this.verbose=!1,"boolean"==typeof t?this.verbose=!0===t:t&&(r=t,this.verbose=!0===r.verbose,r.experimentalFeatures),this.logger=new Ze(this.verbose),this.qrcode=new ht(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=Rt.create()}return e.prototype.start=function(e,t,r,n){var i,s=this;if(!e)throw"cameraIdOrConfig is required";if(!r||"function"!=typeof r)throw"qrCodeSuccessCallback is required and should be a function.";i=n||(this.verbose?this.logger.log:function(){});var o=Pt.create(t,this.logger);this.clearElement();var a=!1;o.videoConstraints&&(o.isMediaStreamConstraintsValid()?a=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var l=a,c=document.getElementById(this.elementId);c.clientWidth?c.clientWidth:Ot.DEFAULT_WIDTH,c.style.position="relative",this.shouldScan=!0,this.element=c;var d=this,h=this.stateManagerProxy.startTransition(nt.SCANNING);return new Promise(function(t,n){var a=l?o.videoConstraints:d.createVideoConstraints(e);if(!a)return h.cancel(),void n("videoConstraints should be defined");var c={};l&&!o.aspectRatio||(c.aspectRatio=o.aspectRatio);var u={onRenderSurfaceReady:function(e,t){d.setupUi(e,t,o),d.isScanning=!0,d.foreverScan(o,r,i)}};St.failIfNotSupported().then(function(e){e.create(a).then(function(e){return e.render(s.element,c,u).then(function(e){d.renderedCamera=e,h.execute(),t(null)}).catch(function(e){h.cancel(),n(e)})}).catch(function(e){h.cancel(),n(qe.errorGettingUserMedia(e))})}).catch(function(e){h.cancel(),n(qe.cameraStreamingNotSupported())})})},e.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(nt.PAUSED),this.showPausedState(),(Qe(e)||!0!==e)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(nt.SCANNING),e.hidePausedState()};this.renderedCamera.isPaused()?this.renderedCamera.resume(function(){t()}):t()},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(nt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=this;return this.renderedCamera.close().then(function(){return r.renderedCamera=null,r.element&&(r.element.removeChild(r.canvasElement),r.canvasElement=null),function(){if(e.element){var t=document.getElementById(Ot.SHADED_REGION_ELEMENT_ID);t&&e.element.removeChild(t)}}(),r.qrRegion&&(r.qrRegion=null),r.context&&(r.context=null),t.execute(),r.hidePausedState(),r.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(e){return e.decodedText})},e.prototype.scanFileV2=function(e,t){var r=this;if(!(e&&e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Qe(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(n,i){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(e);var s=new Image;s.onload=function(){var e=s.width,o=s.height,a=document.getElementById(r.elementId),l=a.clientWidth?a.clientWidth:Ot.DEFAULT_WIDTH,c=Math.max(a.clientHeight?a.clientHeight:o,Ot.FILE_SCAN_MIN_HEIGHT),d=r.computeCanvasDrawConfig(e,o,l,c);if(t){var h=r.createCanvasElement(l,c,"qr-canvas-visible");h.style.display="inline-block",a.appendChild(h);var u=h.getContext("2d");if(!u)throw"Unable to get 2d context from canvas";u.canvas.width=l,u.canvas.height=c,u.drawImage(s,0,0,e,o,d.x,d.y,d.width,d.height)}var f=Ot.FILE_SCAN_HIDDEN_CANVAS_PADDING,g=Math.max(s.width,d.width),m=Math.max(s.height,d.height),p=g+2*f,w=m+2*f,A=r.createCanvasElement(p,w);a.appendChild(A);var C=A.getContext("2d");if(!C)throw"Unable to get 2d context from canvas";C.canvas.width=p,C.canvas.height=w,C.drawImage(s,0,0,e,o,f,f,g,m);try{r.qrcode.decodeRobustlyAsync(A).then(function(e){n(We.createFromQrcodeResult(e))}).catch(i)}catch(y){i("QR code parse error, error = ".concat(y))}},s.onerror=i,s.onabort=i,s.onstalled=i,s.onsuspend=i,s.src=URL.createObjectURL(e)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return Tt.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(e){if(!e)throw"videoConstaints is required argument.";if(!Je.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},e.prototype.getRenderedCameraOrFail=function(){if(null==this.renderedCamera)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(e){var t=[Oe.QR_CODE,Oe.AZTEC,Oe.CODABAR,Oe.CODE_39,Oe.CODE_93,Oe.CODE_128,Oe.DATA_MATRIX,Oe.MAXICODE,Oe.ITF,Oe.EAN_13,Oe.EAN_8,Oe.PDF_417,Oe.RSS_14,Oe.RSS_EXPANDED,Oe.UPC_A,Oe.UPC_E,Oe.UPC_EAN_EXTENSION];if(!e||"boolean"==typeof e)return t;if(!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(0===e.formatsToSupport.length)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],n=0,i=e.formatsToSupport;n<i.length;n++){var s=i[n];He(s)?r.push(s):this.logger.warn("Invalid format: ".concat(s," passed in config, ignoring."))}if(0===r.length)throw"None of formatsToSupport match supported values.";return r},e.prototype.getUseBarCodeDetectorIfSupported=function(e){if(Qe(e))return!0;if(!Qe(e.useBarCodeDetectorIfSupported))return!1!==e.useBarCodeDetectorIfSupported;if(Qe(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return!!Qe(t.useBarCodeDetectorIfSupported)||!1!==t.useBarCodeDetectorIfSupported},e.prototype.validateQrboxSize=function(e,t,r){var n=this,i=r.qrbox;this.validateQrboxConfig(i);var s,o=this.toQrdimensions(e,t,i),a=function(e){if(e<Ot.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ot.MIN_QR_BOX_SIZE,"px.")};a(o.width),a(o.height),o.width=((s=o.width)>e&&(n.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),s=e),s)},e.prototype.validateQrboxConfig=function(e){if("number"!=typeof e&&"function"!=typeof e&&(void 0===e.width||void 0===e.height))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(e,t,r){if("number"==typeof r)return{width:r,height:r};if("function"==typeof r)try{return r(e,t)}catch(n){throw new Error("qrbox config was passed as a function but it failed with unknown error"+n)}return r},e.prototype.setupUi=function(e,t,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,r);var n=Qe(r.qrbox)?{width:e,height:t}:r.qrbox;this.validateQrboxConfig(n);var i=this.toQrdimensions(e,t,n);i.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var s=r.isShadedBoxEnabled()&&i.height<=t,o={x:0,y:0,width:e,height:t},a=s?this.getShadedRegionBounds(e,t,i):o,l=this.createCanvasElement(a.width,a.height),c=l.getContext("2d",{willReadFrequently:!0});c.canvas.width=a.width,c.canvas.height=a.height,this.element.append(l),s&&this.possiblyInsertShadingElement(this.element,e,t,i),this.createScannerPausedUiElement(this.element),this.qrRegion=a,this.context=c,this.canvasElement=l},e.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=qe.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},e.prototype.scanContext=function(e,t){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(t){return e(t.text,We.createFromQrcodeResult(t)),r.possiblyUpdateShaders(!0),!0}).catch(function(e){r.possiblyUpdateShaders(!1);var n=qe.codeParseError(e);return t(n,Xe.createFrom(n)),!1})},e.prototype.foreverScan=function(e,t,r){var n=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),s=i.videoWidth/i.clientWidth,o=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var a=this.qrRegion.width*s,l=this.qrRegion.height*o,c=this.qrRegion.x*s,d=this.qrRegion.y*o;this.context.drawImage(i,c,d,a,l,0,0,this.qrRegion.width,this.qrRegion.height);var h=function(){n.foreverScanTimeout=setTimeout(function(){n.foreverScan(e,t,r)},n.getTimeoutFps(e.fps))};this.scanContext(t,r).then(function(i){i||!0===e.disableFlip?h():(n.context.translate(n.context.canvas.width,0),n.context.scale(-1,1),n.scanContext(t,r).finally(function(){h()}))}).catch(function(e){n.logger.logError("Error happend while scanning context",e),h()})}},e.prototype.createVideoConstraints=function(e){if("string"==typeof e)return{deviceId:{exact:e}};if("object"==typeof e){var t="facingMode",r="deviceId",n={user:!0,environment:!0},i="exact",s=function(e){if(e in n)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(e,"'")},o=Object.keys(e);if(1!==o.length)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(o.length," keys");var a=Object.keys(e)[0];if(a!==t&&a!==r)throw"Only '".concat(t,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(a!==t){var l=e.deviceId;if("string"==typeof l)return{deviceId:l};if("object"==typeof l){if(i in l)return{deviceId:{exact:l["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}throw"Invalid type of 'deviceId' = ".concat(typeof l)}var c=e.facingMode;if("string"==typeof c){if(s(c))return{facingMode:c}}else{if("object"!=typeof c)throw"Invalid type of 'facingMode' = ".concat(typeof c);if(!(i in c))throw"'facingMode' should be string or object with"+" ".concat(i," as key.");if(s(c["".concat(i)]))return{facingMode:{exact:c["".concat(i)]}}}}throw"Invalid type of 'cameraIdOrConfig' = ".concat(typeof e)},e.prototype.computeCanvasDrawConfig=function(e,t,r,n){if(e<=r&&t<=n)return{x:(r-e)/2,y:(n-t)/2,width:e,height:t};var i=e,s=t;return e>r&&(t*=r/e,e=r),t>n&&(e*=n/t,t=n),this.logger.log("Image downsampled from "+"".concat(i,"X").concat(s)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,r,n)},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},e.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?Ot.BORDER_SHADER_MATCH_COLOR:Ot.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(e,t,r){var n=e,i=t,s=document.createElement("canvas");return s.style.width="".concat(n,"px"),s.style.height="".concat(i,"px"),s.style.display="none",s.id=Qe(r)?"qr-canvas":r,s},e.prototype.getShadedRegionBounds=function(e,t,r){if(r.width>e||r.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-r.width)/2,y:(t-r.height)/2,width:r.width,height:r.height}},e.prototype.possiblyInsertShadingElement=function(e,t,r,n){if(!(t-n.width<1||r-n.height<1)){var i=document.createElement("div");i.style.position="absolute";var s=(t-n.width)/2,o=(r-n.height)/2;if(i.style.borderLeft="".concat(s,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(s,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(Ot.SHADED_REGION_ELEMENT_ID),t-n.width<11||r-n.height<11)this.hasBorderShaders=!1;else{var a=40;this.insertShaderBorders(i,a,5,-5,null,0,!0),this.insertShaderBorders(i,a,5,-5,null,0,!1),this.insertShaderBorders(i,a,5,null,-5,0,!0),this.insertShaderBorders(i,a,5,null,-5,0,!1),this.insertShaderBorders(i,5,45,-5,null,-5,!0),this.insertShaderBorders(i,5,45,null,-5,-5,!0),this.insertShaderBorders(i,5,45,-5,null,-5,!1),this.insertShaderBorders(i,5,45,null,-5,-5,!1),this.hasBorderShaders=!0}e.append(i)}},e.prototype.insertShaderBorders=function(e,t,r,n,i,s,o){var a=document.createElement("div");a.style.position="absolute",a.style.backgroundColor=Ot.BORDER_SHADER_DEFAULT_COLOR,a.style.width="".concat(t,"px"),a.style.height="".concat(r,"px"),null!==n&&(a.style.top="".concat(n,"px")),null!==i&&(a.style.bottom="".concat(i,"px")),o?a.style.left="".concat(s,"px"):a.style.right="".concat(s,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(a),e.appendChild(a)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(e){return 1e3/e},e}(),Lt="data:image/svg+xml;base64,",kt=Lt+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",jt=Lt+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",Ft=Lt+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",Ut=function(){function e(){}return e.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},e}(),Ht=function(){function e(){this.data=Ut.createDefault();var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return e.prototype.hasCameraPermissions=function(){return this.data.hasPermission},e.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},e.prototype.setHasPermission=function(e){this.data.hasPermission=e,this.flush()},e.prototype.setLastUsedCameraId=function(e){this.data.lastUsedCameraId=e,this.flush()},e.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},e.prototype.reset=function(){this.data=Ut.createDefault(),this.flush()},e.prototype.flush=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},e.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",e}(),Vt=function(){function e(){this.infoDiv=document.createElement("div")}return e.prototype.renderInto=function(e){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=$e.poweredBy();var t=document.createElement("a");t.innerText="ScanApp",t.href="https://scanapp.org",t.target="new",t.style.color="white",this.infoDiv.appendChild(t);var r=document.createElement("br"),n=document.createElement("br");this.infoDiv.appendChild(r),this.infoDiv.appendChild(n);var i=document.createElement("a");i.innerText=$e.reportIssues(),i.href="https://github.com/mebjas/html5-qrcode/issues",i.target="new",i.style.color="white",this.infoDiv.appendChild(i),e.appendChild(this.infoDiv)},e.prototype.show=function(){this.infoDiv.style.display="block"},e.prototype.hide=function(){this.infoDiv.style.display="none"},e}(),zt=function(){function e(e,t){this.isShowingInfoIcon=!0,this.onTapIn=e,this.onTapOut=t,this.infoIcon=document.createElement("img")}return e.prototype.renderInto=function(e){var t=this;this.infoIcon.alt="Info icon",this.infoIcon.src=Ft,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(e){return t.onHoverIn()},this.infoIcon.onmouseout=function(e){return t.onHoverOut()},this.infoIcon.onclick=function(e){return t.onClick()},e.appendChild(this.infoIcon)},e.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},e.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},e.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=Ft,this.infoIcon.style.opacity="0.6")},e}(),Gt=function(){function e(){var e=this;this.infoDiv=new Vt,this.infoIcon=new zt(function(){e.infoDiv.show()},function(){e.infoDiv.hide()})}return e.prototype.renderInto=function(e){this.infoDiv.renderInto(e),this.infoIcon.renderInto(e)},e}(),Yt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},Wt=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},Xt=function(){function e(){}return e.hasPermissions=function(){return Yt(this,void 0,void 0,function(){var e,t,r,n;return Wt(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(e=i.sent(),t=0,r=e;t<r.length;t++)if("videoinput"===(n=r[t]).kind&&n.label)return[2,!0];return[2,!1]}})})},e}(),Zt=function(){function e(e){this.supportedScanTypes=this.validateAndReturnScanTypes(e)}return e.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},e.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},e.prototype.isCameraScanRequired=function(){for(var t=0,r=this.supportedScanTypes;t<r.length;t++){var n=r[t];if(e.isCameraScanType(n))return!0}return!1},e.isCameraScanType=function(e){return e===je.SCAN_TYPE_CAMERA},e.isFileScanType=function(e){return e===je.SCAN_TYPE_FILE},e.prototype.validateAndReturnScanTypes=function(e){if(!e||0===e.length)return Ge.DEFAULT_SUPPORTED_SCAN_TYPE;var t=Ge.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(e.length>t)throw"Max ".concat(t," values expected for ")+"supportedScanTypes";for(var r=0,n=e;r<n.length;r++){var i=n[r];if(!Ge.DEFAULT_SUPPORTED_SCAN_TYPE.includes(i))throw"Unsupported scan type ".concat(i)}return e},e}(),Qt=function(){function e(){}return e.ALL_ELEMENT_CLASS="html5-qrcode-element",e.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",e.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",e.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",e.TORCH_BUTTON_ID="html5-qrcode-button-torch",e.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",e.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",e.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",e.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",e.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",e.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",e}(),qt=function(){function e(){}return e.createElement=function(e,t){var r=document.createElement(e);return r.id=t,r.classList.add(Qt.ALL_ELEMENT_CLASS),"button"===e&&r.setAttribute("type","button"),r},e}(),Kt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(Re){s(Re)}}function a(e){try{l(n.throw(e))}catch(Re){s(Re)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})},$t=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(Re){a=[6,Re],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},Jt=function(){function e(e,t,r){this.isTorchOn=!1,this.torchCapability=e,this.buttonController=t,this.onTorchActionFailureCallback=r}return e.prototype.isTorchEnabled=function(){return this.isTorchOn},e.prototype.flipState=function(){return Kt(this,void 0,void 0,function(){var e,t;return $t(this,function(r){switch(r.label){case 0:this.buttonController.disable(),e=!this.isTorchOn,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.torchCapability.apply(e)];case 2:return r.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),e),[3,4];case 3:return t=r.sent(),this.propagateFailure(e,t),this.buttonController.enable(),[3,4];case 4:return[2]}})})},e.prototype.updateUiBasedOnLatestSettings=function(e,t){e===t?(this.buttonController.setText(t?Ke.torchOffButton():Ke.torchOnButton()),this.isTorchOn=t):this.propagateFailure(t),this.buttonController.enable()},e.prototype.propagateFailure=function(e,t){var r=e?Ke.torchOnFailedMessage():Ke.torchOffFailedMessage();t&&(r+="; Error = "+t),this.onTorchActionFailureCallback(r)},e.prototype.reset=function(){this.isTorchOn=!1},e}(),er=function(){function e(e,t){this.onTorchActionFailureCallback=t,this.torchButton=qt.createElement("button",Qt.TORCH_BUTTON_ID),this.torchController=new Jt(e,this,t)}return e.prototype.render=function(e,t){var r=this;this.torchButton.innerText=Ke.torchOnButton(),this.torchButton.style.display=t.display,this.torchButton.style.marginLeft=t.marginLeft;var n=this;this.torchButton.addEventListener("click",function(e){return Kt(r,void 0,void 0,function(){return $t(this,function(e){switch(e.label){case 0:return[4,n.torchController.flipState()];case 1:return e.sent(),n.torchController.isTorchEnabled()?(n.torchButton.classList.remove(Qt.TORCH_BUTTON_CLASS_TORCH_OFF),n.torchButton.classList.add(Qt.TORCH_BUTTON_CLASS_TORCH_ON)):(n.torchButton.classList.remove(Qt.TORCH_BUTTON_CLASS_TORCH_ON),n.torchButton.classList.add(Qt.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),e.appendChild(this.torchButton)},e.prototype.updateTorchCapability=function(e){this.torchController=new Jt(e,this,this.onTorchActionFailureCallback)},e.prototype.getTorchButton=function(){return this.torchButton},e.prototype.hide=function(){this.torchButton.style.display="none"},e.prototype.show=function(){this.torchButton.style.display="inline-block"},e.prototype.disable=function(){this.torchButton.disabled=!0},e.prototype.enable=function(){this.torchButton.disabled=!1},e.prototype.setText=function(e){this.torchButton.innerText=e},e.prototype.reset=function(){this.torchButton.innerText=Ke.torchOnButton(),this.torchController.reset()},e.create=function(t,r,n,i){var s=new e(r,i);return s.render(t,n),s},e}(),tr=function(){function e(e,t,r){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=t?"block":"none",e.appendChild(this.fileBasedScanRegion);var n=document.createElement("label");n.setAttribute("for",this.getFileScanInputId()),n.style.display="inline-block",this.fileBasedScanRegion.appendChild(n),this.fileSelectionButton=qt.createElement("button",Qt.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(e){n.click()}),n.append(this.fileSelectionButton),this.fileScanInput=qt.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",n.appendChild(this.fileScanInput);var i=this;this.fileScanInput.addEventListener("change",function(e){if(null!=e&&null!=e.target){var t=e.target;if(!t.files||0!==t.files.length){var n=t.files[0],s=n.name;i.setImageNameToButton(s),r(n)}}});var s=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(s),this.fileBasedScanRegion.addEventListener("dragenter",function(e){i.fileBasedScanRegion.style.border=i.fileBasedScanRegionActiveBorder(),e.stopPropagation(),e.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(e){i.fileBasedScanRegion.style.border=i.fileBasedScanRegionDefaultBorder(),e.stopPropagation(),e.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(e){i.fileBasedScanRegion.style.border=i.fileBasedScanRegionActiveBorder(),e.stopPropagation(),e.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),i.fileBasedScanRegion.style.border=i.fileBasedScanRegionDefaultBorder();var t=e.dataTransfer;if(t){var n=t.files;if(!n||0===n.length)return;for(var o=!1,a=0;a<n.length;++a){var l=n.item(a);if(l){if(l.type.match(/image.*/)){o=!0;var c=l.name;i.setImageNameToButton(c),r(l),s.innerText=Ke.dragAndDropMessage();break}}}o||(s.innerText=Ke.dragAndDropMessageOnlyImages())}})}return e.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},e.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},e.prototype.isShowing=function(){return"block"===this.fileBasedScanRegion.style.display},e.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},e.prototype.createFileBasedScanRegion=function(){var e=document.createElement("div");return e.style.textAlign="center",e.style.margin="auto",e.style.width="80%",e.style.maxWidth="600px",e.style.border=this.fileBasedScanRegionDefaultBorder(),e.style.padding="10px",e.style.marginBottom="10px",e},e.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},e.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},e.prototype.createDragAndDropMessage=function(){var e=document.createElement("div");return e.innerText=Ke.dragAndDropMessage(),e.style.fontWeight="400",e},e.prototype.setImageNameToButton=function(e){if(e.length>20){var t=e.substring(0,8),r=e.length,n=e.substring(r-8,r);e="".concat(t,"....").concat(n)}var i=Ke.fileSelectionChooseAnother()+" - "+e;this.fileSelectionButton.innerText=i},e.prototype.setInitialValueToButton=function(){var e=Ke.fileSelectionChooseImage()+" - "+Ke.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=e},e.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},e.create=function(t,r,n){return new e(t,r,n)},e}(),rr=function(){function e(e){this.selectElement=qt.createElement("select",Qt.CAMERA_SELECTION_SELECT_ID),this.cameras=e,this.options=[]}return e.prototype.render=function(e){var t=document.createElement("span");t.style.marginRight="10px";var r=this.cameras.length;if(0===r)throw new Error("No cameras found");if(1===r)t.style.display="none";else{var n=Ke.selectCamera();t.innerText="".concat(n," (").concat(this.cameras.length,")  ")}for(var i=1,s=0,o=this.cameras;s<o.length;s++){var a=o[s],l=a.id,c=null==a.label?l:a.label;c&&""!==c||(c=[Ke.anonymousCameraPrefix(),i++].join(" "));var d=document.createElement("option");d.value=l,d.innerText=c,this.options.push(d),this.selectElement.appendChild(d)}t.appendChild(this.selectElement),e.appendChild(t)},e.prototype.disable=function(){this.selectElement.disabled=!0},e.prototype.isDisabled=function(){return!0===this.selectElement.disabled},e.prototype.enable=function(){this.selectElement.disabled=!1},e.prototype.getValue=function(){return this.selectElement.value},e.prototype.hasValue=function(e){for(var t=0,r=this.options;t<r.length;t++){if(r[t].value===e)return!0}return!1},e.prototype.setValue=function(e){if(!this.hasValue(e))throw new Error("".concat(e," is not present in the camera list."));this.selectElement.value=e},e.prototype.hasSingleItem=function(){return 1===this.cameras.length},e.prototype.numCameras=function(){return this.cameras.length},e.create=function(t,r){var n=new e(r);return n.render(t),n},e}(),nr=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=qt.createElement("input",Qt.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(e,t){this.zoomElementContainer.style.display=t?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",e.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var r=Ke.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(r),this.rangeText.style.marginRight="10px";var n=this;this.rangeInput.addEventListener("input",function(){return n.onValueChange()}),this.rangeInput.addEventListener("change",function(){return n.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){var e=Ke.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(e),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(e,t,r,n){this.rangeInput.min=e.toString(),this.rangeInput.max=t.toString(),this.rangeInput.step=n.toString(),this.rangeInput.value=r.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.style.display="block"},e.prototype.hide=function(){this.zoomElementContainer.style.display="none"},e.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t,r){var n=new e;return n.render(t,r),n},e}();(xt=bt||(bt={}))[xt.STATUS_DEFAULT=0]="STATUS_DEFAULT",xt[xt.STATUS_SUCCESS=1]="STATUS_SUCCESS",xt[xt.STATUS_WARNING=2]="STATUS_WARNING",xt[xt.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION";var ir=function(){function e(e,t,r){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=e,this.config=this.createConfig(t),this.verbose=!0===r,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.scanTypeSelector=new Zt(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new Ze(this.verbose),this.persistedDataManager=new Ht,!0!==t.rememberLastUsedCamera&&this.persistedDataManager.reset()}return e.prototype.render=function(e,t){var r=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(t,n){if(e)e(t,n);else{if(r.lastMatchFound===t)return;r.lastMatchFound=t,r.setHeaderMessage(Ke.lastMatch(t),bt.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(e,r){t&&t(e,r)};var n,i,s=document.getElementById(this.elementId);if(!s)throw"HTML Element with id=".concat(this.elementId," not found");s.innerHTML="",this.createBasicLayout(s),this.html5Qrcode=new Bt(this.getScanRegionId(),(n=this.config,i=this.verbose,{formatsToSupport:n.formatsToSupport,useBarCodeDetectorIfSupported:n.useBarCodeDetectorIfSupported,experimentalFeatures:n.experimentalFeatures,verbose:i}))},e.prototype.pause=function(e){(Qe(e)||!0!==e)&&(e=!1),this.getHtml5QrcodeOrFail().pause(e)},e.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},e.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},e.prototype.clear=function(){var e=this,t=function(){var t=document.getElementById(e.elementId);t&&(t.innerHTML="",e.resetBasicLayout(t))};return this.html5Qrcode?new Promise(function(r,n){e.html5Qrcode?e.html5Qrcode.isScanning?e.html5Qrcode.stop().then(function(n){e.html5Qrcode?(e.html5Qrcode.clear(),t(),r()):r()}).catch(function(t){e.verbose&&e.logger.logError("Unable to stop qrcode scanner",t),n(t)}):(e.html5Qrcode.clear(),t(),r()):r()}):Promise.resolve()},e.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},e.prototype.applyVideoConstraints=function(e){return this.getHtml5QrcodeOrFail().applyVideoConstraints(e)},e.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},e.prototype.createConfig=function(e){return e?(e.fps||(e.fps=Ge.SCAN_DEFAULT_FPS),e.rememberLastUsedCamera!==!Ge.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(e.rememberLastUsedCamera=Ge.DEFAULT_REMEMBER_LAST_CAMERA_USED),e.supportedScanTypes||(e.supportedScanTypes=Ge.DEFAULT_SUPPORTED_SCAN_TYPE),e):{fps:Ge.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Ge.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Ge.DEFAULT_SUPPORTED_SCAN_TYPE}},e.prototype.createBasicLayout=function(e){e.style.position="relative",e.style.padding="0px",e.style.border="1px solid silver",this.createHeader(e);var t=document.createElement("div"),r=this.getScanRegionId();t.id=r,t.style.width="100%",t.style.minHeight="100px",t.style.textAlign="center",e.appendChild(t),Zt.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var n=document.createElement("div"),i=this.getDashboardId();n.id=i,n.style.width="100%",e.appendChild(n),this.setupInitialDashboard(n)},e.prototype.resetBasicLayout=function(e){e.style.border="none"},e.prototype.setupInitialDashboard=function(e){this.createSection(e),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},e.prototype.createHeader=function(e){var t=document.createElement("div");t.style.textAlign="left",t.style.margin="0px",e.appendChild(t),(new Gt).renderInto(t);var r=document.createElement("div");r.id=this.getHeaderMessageContainerId(),r.style.display="none",r.style.textAlign="center",r.style.fontSize="14px",r.style.padding="2px 10px",r.style.margin="4px",r.style.borderTop="1px solid #f6f6f6",t.appendChild(r)},e.prototype.createSection=function(e){var t=document.createElement("div");t.id=this.getDashboardSectionId(),t.style.width="100%",t.style.padding="10px 0px 10px 0px",t.style.textAlign="left",e.appendChild(t)},e.prototype.createCameraListUi=function(e,t,r){var n=this;n.showHideScanTypeSwapLink(!1),n.setHeaderMessage(Ke.cameraPermissionRequesting());var i=function(){r||n.createPermissionButton(e,t)};Bt.getCameras().then(function(r){n.persistedDataManager.setHasPermission(!0),n.showHideScanTypeSwapLink(!0),n.resetHeaderMessage(),r&&r.length>0?(e.removeChild(t),n.renderCameraSelection(r)):(n.setHeaderMessage(Ke.noCameraFound(),bt.STATUS_WARNING),i())}).catch(function(e){n.persistedDataManager.setHasPermission(!1),r?r.disabled=!1:i(),n.setHeaderMessage(e,bt.STATUS_WARNING),n.showHideScanTypeSwapLink(!0)})},e.prototype.createPermissionButton=function(e,t){var r=this,n=qt.createElement("button",this.getCameraPermissionButtonId());n.innerText=Ke.cameraPermissionTitle(),n.addEventListener("click",function(){n.disabled=!0,r.createCameraListUi(e,t,n)}),t.appendChild(n)},e.prototype.createPermissionsUi=function(e,t){var r=this;Zt.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()?Xt.hasPermissions().then(function(n){n?r.createCameraListUi(e,t):(r.persistedDataManager.setHasPermission(!1),r.createPermissionButton(e,t))}).catch(function(n){r.persistedDataManager.setHasPermission(!1),r.createPermissionButton(e,t)}):this.createPermissionButton(e,t)},e.prototype.createSectionControlPanel=function(){var e=document.getElementById(this.getDashboardSectionId()),t=document.createElement("div");e.appendChild(t);var r=document.createElement("div");r.id=this.getDashboardSectionCameraScanRegionId(),r.style.display=Zt.isCameraScanType(this.currentScanType)?"block":"none",t.appendChild(r);var n=document.createElement("div");n.style.textAlign="center",r.appendChild(n),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(r,n),this.renderFileScanUi(t)},e.prototype.renderFileScanUi=function(e){var t=Zt.isFileScanType(this.currentScanType),r=this;this.fileSelectionUi=tr.create(e,t,function(e){if(!r.html5Qrcode)throw"html5Qrcode not defined";Zt.isFileScanType(r.currentScanType)&&(r.setHeaderMessage(Ke.loadingImage()),r.html5Qrcode.scanFileV2(e,!0).then(function(e){r.resetHeaderMessage(),r.qrCodeSuccessCallback(e.decodedText,e)}).catch(function(e){r.setHeaderMessage(e,bt.STATUS_WARNING),r.qrCodeErrorCallback(e,Xe.createFrom(e))}))})},e.prototype.renderCameraSelection=function(e){var t=this,r=this,n=document.getElementById(this.getDashboardSectionCameraScanRegionId());n.style.textAlign="center";var i=nr.create(n,!1),s=rr.create(n,e),o=document.createElement("span"),a=qt.createElement("button",Qt.CAMERA_START_BUTTON_ID);a.innerText=Ke.scanButtonStartScanningText(),o.appendChild(a);var l,c=qt.createElement("button",Qt.CAMERA_STOP_BUTTON_ID);c.innerText=Ke.scanButtonStopScanningText(),c.style.display="none",c.disabled=!0,o.appendChild(c);n.appendChild(o);var d=function(e){e||(a.style.display="none"),a.innerText=Ke.scanButtonStartScanningText(),a.style.opacity="1",a.disabled=!1,e&&(a.style.display="inline-block")};if(a.addEventListener("click",function(e){a.innerText=Ke.scanButtonScanningStarting(),s.disable(),a.disabled=!0,a.style.opacity="0.5",t.scanTypeSelector.hasMoreThanOneScanType()&&r.showHideScanTypeSwapLink(!1),r.resetHeaderMessage();var n,h=s.getValue();r.persistedDataManager.setLastUsedCameraId(h),r.html5Qrcode.start(h,(n=r.config,{fps:n.fps,qrbox:n.qrbox,aspectRatio:n.aspectRatio,disableFlip:n.disableFlip,videoConstraints:n.videoConstraints}),r.qrCodeSuccessCallback,r.qrCodeErrorCallback).then(function(e){c.disabled=!1,c.style.display="inline-block",d(!1);var n=r.html5Qrcode.getRunningTrackCameraCapabilities();!0===t.config.showTorchButtonIfSupported&&function(e){e.torchFeature().isSupported()?(l?l.updateTorchCapability(e.torchFeature()):l=er.create(o,e.torchFeature(),{display:"none",marginLeft:"5px"},function(e){r.setHeaderMessage(e,bt.STATUS_WARNING)}),l.show()):l&&l.hide()}(n),!0===t.config.showZoomSliderIfSupported&&function(e){var r=e.zoomFeature();if(r.isSupported()){i.setOnCameraZoomValueChangeCallback(function(e){r.apply(e)});var n,s,o,a=1;t.config.defaultZoomValueIfSupported&&(a=t.config.defaultZoomValueIfSupported),n=a,s=r.min(),a=n>(o=r.max())?o:n<s?s:n,i.setValues(r.min(),r.max(),a,r.step()),i.show()}}(n)}).catch(function(e){r.showHideScanTypeSwapLink(!0),s.enable(),d(!0),r.setHeaderMessage(e,bt.STATUS_WARNING)})}),s.hasSingleItem()&&a.click(),c.addEventListener("click",function(e){if(!r.html5Qrcode)throw"html5Qrcode not defined";c.disabled=!0,r.html5Qrcode.stop().then(function(e){t.scanTypeSelector.hasMoreThanOneScanType()&&r.showHideScanTypeSwapLink(!0),s.enable(),a.disabled=!1,c.style.display="none",a.style.display="inline-block",l&&(l.reset(),l.hide()),i.removeOnCameraZoomValueChangeCallback(),i.hide(),r.insertCameraScanImageToScanRegion()}).catch(function(e){c.disabled=!1,r.setHeaderMessage(e,bt.STATUS_WARNING)})}),r.persistedDataManager.getLastUsedCameraId()){var h=r.persistedDataManager.getLastUsedCameraId();s.hasValue(h)?(s.setValue(h),a.click()):r.persistedDataManager.resetLastUsedCameraId()}},e.prototype.createSectionSwap=function(){var e=this,t=Ke.textIfCameraScanSelected(),r=Ke.textIfFileScanSelected(),n=document.getElementById(this.getDashboardSectionId()),i=document.createElement("div");i.style.textAlign="center";var s=qt.createElement("span",this.getDashboardSectionSwapLinkId());s.style.textDecoration="underline",s.style.cursor="pointer",s.innerText=Zt.isCameraScanType(this.currentScanType)?t:r,s.addEventListener("click",function(){e.sectionSwapAllowed?(e.resetHeaderMessage(),e.fileSelectionUi.resetValue(),e.sectionSwapAllowed=!1,Zt.isCameraScanType(e.currentScanType)?(e.clearScanRegion(),e.getCameraScanRegion().style.display="none",e.fileSelectionUi.show(),s.innerText=r,e.currentScanType=je.SCAN_TYPE_FILE,e.insertFileScanImageToScanRegion()):(e.clearScanRegion(),e.getCameraScanRegion().style.display="block",e.fileSelectionUi.hide(),s.innerText=t,e.currentScanType=je.SCAN_TYPE_CAMERA,e.insertCameraScanImageToScanRegion(),e.startCameraScanIfPermissionExistsOnSwap()),e.sectionSwapAllowed=!0):e.verbose&&e.logger.logError("Section swap called when not allowed")}),i.appendChild(s),n.appendChild(i)},e.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var e=this,t=this;this.persistedDataManager.hasCameraPermissions()&&Xt.hasPermissions().then(function(r){if(r){var n=document.getElementById(t.getCameraPermissionButtonId());if(!n)throw e.logger.logError("Permission button not found, fail;"),"Permission button not found";n.click()}else t.persistedDataManager.setHasPermission(!1)}).catch(function(e){t.persistedDataManager.setHasPermission(!1)})},e.prototype.resetHeaderMessage=function(){document.getElementById(this.getHeaderMessageContainerId()).style.display="none"},e.prototype.setHeaderMessage=function(e,t){t||(t=bt.STATUS_DEFAULT);var r=this.getHeaderMessageDiv();switch(r.innerText=e,r.style.display="block",t){case bt.STATUS_SUCCESS:r.style.background="rgba(106, 175, 80, 0.26)",r.style.color="#477735";break;case bt.STATUS_WARNING:r.style.background="rgba(203, 36, 49, 0.14)",r.style.color="#cb2431";break;case bt.STATUS_DEFAULT:default:r.style.background="rgba(0, 0, 0, 0)",r.style.color="rgb(17, 17, 17)"}},e.prototype.showHideScanTypeSwapLink=function(e){this.scanTypeSelector.hasMoreThanOneScanType()&&(!0!==e&&(e=!1),this.sectionSwapAllowed=e,this.getDashboardSectionSwapLink().style.display=e?"inline-block":"none")},e.prototype.insertCameraScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.cameraScanImage)return t.innerHTML="<br>",void t.appendChild(this.cameraScanImage);this.cameraScanImage=new Image,this.cameraScanImage.onload=function(r){t.innerHTML="<br>",t.appendChild(e.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=kt,this.cameraScanImage.alt=Ke.cameraScanAltText()},e.prototype.insertFileScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.fileScanImage)return t.innerHTML="<br>",void t.appendChild(this.fileScanImage);this.fileScanImage=new Image,this.fileScanImage.onload=function(r){t.innerHTML="<br>",t.appendChild(e.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=jt,this.fileScanImage.alt=Ke.fileScanAltText()},e.prototype.clearScanRegion=function(){document.getElementById(this.getScanRegionId()).innerHTML=""},e.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},e.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},e.prototype.getDashboardSectionSwapLinkId=function(){return Qt.SCAN_TYPE_CHANGE_ANCHOR_ID},e.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},e.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},e.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},e.prototype.getCameraPermissionButtonId=function(){return Qt.CAMERA_PERMISSION_BUTTON_ID},e.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},e.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},e.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},e}();function sr({onScan:e,isActive:t,onToggle:r,className:n=""}){const i=q.useRef(null),[s,o]=q.useState(null),[C,y]=q.useState(!1),[E,_]=q.useState(null),[S,I]=q.useState(null),[N,T]=q.useState(0),[b,x]=q.useState({fps:10,qrbox:{width:250,height:250},aspectRatio:1});q.useEffect(()=>(t&&!C?D():!t&&s&&M(),()=>{s&&s.clear().catch(console.error)}),[t]);const D=()=>c(this,null,function*(){if(i.current)try{(yield navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>e.stop());const t=new ir("barcode-scanner-container",{fps:b.fps,qrbox:b.qrbox,aspectRatio:b.aspectRatio,showTorchButtonIfSupported:!0,showZoomSliderIfSupported:!0,defaultZoomValueIfSupported:2,supportedScanTypes:[0,1,2,3,4,5,6,7,8,9]},!1);t.render((t,r)=>{t!==S&&(I(t),T(e=>e+1),e(t),ee.success(`Scanned: ${t}`),R())},e=>{!e.includes("No MultiFormat Readers")&&e.includes("NotFoundException")}),o(t),y(!0),_(null)}catch(t){_(t.message||"Failed to access camera")}}),M=()=>{s&&s.clear().then(()=>{o(null),y(!1)}).catch(e=>{o(null),y(!1)})},R=()=>{try{new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT").play().catch(()=>{})}catch(e){}};return d.jsxs("div",{className:`relative ${n}`,children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:r,className:"p-3 rounded-xl transition-all duration-200 flex items-center gap-2 "+(t?"bg-success-500/20 text-success-400 border border-success-500/50":"bg-dark-700/50 text-gray-400 border border-dark-600/50 hover:border-primary-500/50"),children:[t?d.jsx(u,{className:"w-6 h-6"}):d.jsx(f,{className:"w-6 h-6"}),d.jsx("span",{className:"font-medium",children:t?"Scanner Active":"Start Scanner"})]}),t&&d.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-400",children:[d.jsx(g,{className:"w-4 h-4 text-success-400"}),d.jsx("span",{children:"Ready to scan"})]})]}),N>0&&d.jsxs("div",{className:"text-right",children:[d.jsx("div",{className:"text-primary-400 font-bold text-lg",children:N}),d.jsx("div",{className:"text-gray-400 text-xs",children:"successful scans"})]})]}),d.jsxs("div",{className:"relative rounded-xl overflow-hidden border-2 transition-all duration-300 "+(t?"border-success-500/50 bg-black":"border-dark-600/50 bg-dark-800/50"),children:[d.jsx("div",{id:"barcode-scanner-container",ref:i,className:"w-full h-64 sm:h-80 flex items-center justify-center",children:!t&&d.jsxs("div",{className:"text-center",children:[d.jsx(m,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-400 font-medium",children:"Barcode Scanner"}),d.jsx("p",{className:"text-gray-500 text-sm mt-2",children:'Click "Start Scanner" to begin scanning barcodes'}),d.jsx("div",{className:"mt-4 text-xs text-gray-600",children:d.jsx("p",{children:"Supports: UPC, EAN, Code 128, Code 39, QR codes"})})]})}),t&&C&&d.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[d.jsx(h.div,{animate:{y:[0,240,0]},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute left-0 right-0 h-0.5 bg-success-400 shadow-glow"}),d.jsx("div",{className:"absolute top-4 left-4 w-8 h-8 border-l-2 border-t-2 border-success-400"}),d.jsx("div",{className:"absolute top-4 right-4 w-8 h-8 border-r-2 border-t-2 border-success-400"}),d.jsx("div",{className:"absolute bottom-4 left-4 w-8 h-8 border-l-2 border-b-2 border-success-400"}),d.jsx("div",{className:"absolute bottom-4 right-4 w-8 h-8 border-r-2 border-b-2 border-success-400"}),d.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/80 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Position barcode within the frame"})]}),E&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-dark-900/90",children:d.jsxs("div",{className:"text-center",children:[d.jsx(p,{className:"w-12 h-12 text-error-400 mx-auto mb-3"}),d.jsx("p",{className:"text-error-400 font-medium mb-2",children:"Scanner Error"}),d.jsx("p",{className:"text-gray-400 text-sm mb-4",children:E}),d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{_(null),t&&(M(),setTimeout(D,1e3))},className:"btn-primary",children:"Retry Scanner"})]})}),S&&d.jsxs(h.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-success-500/20 border border-success-500/50 text-success-400 px-4 py-2 rounded-lg flex items-center space-x-2",children:[d.jsx(w,{className:"w-4 h-4"}),d.jsxs("span",{className:"text-sm font-medium",children:["Last: ",S]})]})]}),d.jsxs("div",{className:"mt-4 space-y-3",children:[d.jsx("div",{className:"text-center",children:d.jsx("p",{className:"text-gray-400 text-sm mb-3",children:"Scanner not working? Enter barcode manually:"})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",placeholder:"Enter barcode manually",className:"flex-1 input-dark",onKeyPress:t=>{if("Enter"===t.key){const r=t.target.value.trim();r&&(e(r),t.target.value="",ee.success(`Manual entry: ${r}`))}}}),d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{const t=document.querySelector('input[placeholder="Enter barcode manually"]'),r=null==t?void 0:t.value.trim();r&&(e(r),t.value="",ee.success(`Manual entry: ${r}`))},className:"btn-secondary px-4",children:"Add"})]})]}),d.jsx("div",{className:"mt-4 p-3 bg-dark-800/30 rounded-lg border border-dark-700/50",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(A,{className:"w-4 h-4 text-gray-400"}),d.jsx("span",{className:"text-gray-400 text-sm",children:"Scanner Quality:"})]}),d.jsxs("select",{value:b.fps,onChange:e=>{const r=parseInt(e.target.value);x(e=>l(a({},e),{fps:r})),t&&(M(),setTimeout(D,500))},className:"input-dark text-sm py-1 px-2",children:[d.jsx("option",{value:5,children:"Low (5 FPS)"}),d.jsx("option",{value:10,children:"Medium (10 FPS)"}),d.jsx("option",{value:15,children:"High (15 FPS)"})]})]})})]})}function or({items:e,onUpdateQuantity:t,onRemoveItem:r,onClearCart:n,subtotal:i,taxAmount:s,total:o,taxRate:a,className:l=""}){const[c,u]=q.useState(!0);return d.jsxs("div",{className:`card-dark ${l}`,children:[d.jsx("div",{className:"p-4 sm:p-6 border-b border-dark-700/50",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"p-2 rounded-lg bg-primary-500/20 text-primary-400",children:d.jsx(C,{className:"w-5 h-5"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-white",children:"Shopping Cart"}),d.jsxs("p",{className:"text-gray-400 text-sm",children:[e.length," ",1===e.length?"item":"items"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>u(!c),className:"btn-secondary px-3 py-2 text-sm",children:c?"Collapse":"Expand"}),e.length>0&&d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,className:"p-2 rounded-lg bg-error-500/20 text-error-400 hover:bg-error-500/30 transition-colors",children:d.jsx(y,{className:"w-4 h-4"})})]})]})}),d.jsx(E,{children:c&&d.jsx(h.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:d.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===e.length?d.jsxs("div",{className:"p-6 text-center",children:[d.jsx(_,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),d.jsx("p",{className:"text-gray-400",children:"Cart is empty"}),d.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Scan or search for products to add them"})]}):d.jsx("div",{className:"p-4 space-y-3",children:d.jsx(E,{children:e.map((e,n)=>d.jsxs(h.div,{layout:!0,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:.05*n},className:"flex items-center justify-between p-3 rounded-lg bg-dark-800/30 border border-dark-700/30 hover:border-primary-500/30 transition-all duration-200",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"text-white font-medium truncate",children:e.name}),d.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[d.jsxs("span",{className:"text-gray-400 text-sm",children:[re(e.unit_price)," each"]}),e.category&&d.jsx("span",{className:"text-gray-500 text-xs",children:e.category})]}),e.barcode&&d.jsxs("div",{className:"text-gray-500 text-xs mt-1",children:["Barcode: ",e.barcode]})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(h.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>t(e.id,Math.max(1,e.quantity-1)),className:"p-1 rounded bg-dark-600/50 text-gray-300 hover:bg-dark-600/70 hover:text-white transition-colors",children:d.jsx(S,{className:"w-4 h-4"})}),d.jsx("span",{className:"text-white font-semibold min-w-[2rem] text-center",children:e.quantity}),d.jsx(h.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>{e.quantity<e.available_stock?t(e.id,e.quantity+1):toast.warning(`Only ${e.available_stock} units available`)},disabled:e.quantity>=e.available_stock,className:"p-1 rounded transition-colors "+(e.quantity>=e.available_stock?"bg-gray-600/30 text-gray-500 cursor-not-allowed":"bg-dark-600/50 text-gray-300 hover:bg-dark-600/70 hover:text-white"),children:d.jsx(I,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"text-right min-w-[80px]",children:[d.jsx("div",{className:"text-primary-400 font-semibold",children:re(e.line_total)}),e.available_stock<=5&&d.jsxs("div",{className:"text-warning-400 text-xs",children:[e.available_stock," left"]})]}),d.jsx(h.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>r(e.id),className:"p-2 rounded-lg bg-error-500/20 text-error-400 hover:bg-error-500/30 transition-colors",children:d.jsx(y,{className:"w-4 h-4"})})]})]},e.id))})})})})}),e.length>0&&d.jsx("div",{className:"p-4 sm:p-6 border-t border-dark-700/50 bg-dark-800/30",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-gray-300",children:"Subtotal:"}),d.jsx("span",{className:"text-white font-semibold",children:re(i)})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("span",{className:"text-gray-300",children:["Tax (",(100*a).toFixed(1),"%):"]}),d.jsx("span",{className:"text-white font-semibold",children:re(s)})]}),d.jsx("div",{className:"border-t border-dark-700/50 pt-3",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-lg font-semibold text-white",children:"Total:"}),d.jsx("span",{className:"text-xl font-bold text-primary-400",children:re(o)})]})}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-dark-700/50",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-primary-400 font-semibold",children:e.reduce((e,t)=>e+t.quantity,0)}),d.jsx("div",{className:"text-gray-400 text-xs",children:"Total Items"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"text-primary-400 font-semibold",children:re(i/e.reduce((e,t)=>e+t.quantity,0)||0)}),d.jsx("div",{className:"text-gray-400 text-xs",children:"Avg. Price"})]})]})]})})]})}function ar(e){return c(this,null,function*(){const t=function(){const e=new Date,t=e.getFullYear().toString().slice(-2),r=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0"),i=e.getTime().toString().slice(-6);return`POS${t}${r}${n}${i}`}();return yield ue(ge,r=>c(this,null,function*(){for(const t of e.items){const e=ie(ge,"items",t.item_id);if(!(yield r.get(e)).exists())throw new Error(`Item ${t.name} not found`);const n=yield lr(t.item_id);if(n<t.quantity)throw new Error(`Insufficient stock for ${t.name}. Available: ${n}`)}const n=ie(se(ge,"pos_transactions")),i={transaction_number:t,items:e.items.map(e=>({id:Math.random().toString(36).substr(2,9),item_id:e.item_id,item_name:e.name,barcode:e.barcode,unit_price:e.unit_price,quantity:e.quantity,line_total:e.line_total,discount_amount:0,tax_rate:0})),subtotal:e.subtotal,tax_amount:e.tax_amount,discount_amount:e.discount_amount,total_amount:e.total_amount,payment_method:e.payment_method,payment_amount:e.payment_amount,change_amount:e.change_amount,cashier_id:e.cashier_id,customer_name:e.customer_name,customer_phone:e.customer_phone,created_at:new Date,status:"completed",receipt_printed:!1,notes:e.notes};r.set(n,l(a({},i),{created_at:he.fromDate(new Date)}));for(const s of e.items){const i=ie(se(ge,"transactions"));r.set(i,{item_id:s.item_id,type:"stock_out",quantity:s.quantity,unit_price:s.unit_price,total_value:s.line_total,transaction_date:he.fromDate(new Date),supplier_customer:e.customer_name||"Walk-in Customer",reference_number:t,notes:`POS Sale - Transaction #${t}`,created_by:e.cashier_id,created_at:he.fromDate(new Date),pos_transaction_id:n.id})}return a({id:n.id},i)}))})}function lr(e){return c(this,null,function*(){const t=se(ge,"transactions"),r=oe(t,le("item_id","==",e)),n=yield ce(r);let i=0;return n.docs.forEach(e=>{const t=e.data();"stock_in"===t.type?i+=t.quantity:"stock_out"===t.type&&(i-=t.quantity)}),Math.max(0,i)})}function cr(){return c(this,null,function*(){try{const e=yield ne(ie(ge,"pos_settings","default"));if(e.exists())return e.data();return{store_name:"StockSuite Store",store_address:"123 Business St, City, State 12345",store_phone:"(555) 123-4567",tax_rate:.08,currency:"USD",receipt_footer_message:"Thank you for your business!",auto_print_receipt:!0,barcode_scanner_enabled:!0,thermal_printer_enabled:!1}}catch(e){return{store_name:"StockSuite Store",store_address:"123 Business St, City, State 12345",store_phone:"(555) 123-4567",tax_rate:.08,currency:"USD",receipt_footer_message:"Thank you for your business!",auto_print_receipt:!0,barcode_scanner_enabled:!0,thermal_printer_enabled:!1}}})}function dr({onAddToCart:e,className:t=""}){const[r,n]=q.useState(""),[i,s]=q.useState([]),[o,a]=q.useState(!1),[l,u]=q.useState("name");q.useEffect(()=>{const e=setTimeout(()=>{r.trim()?f():s([])},300);return()=>clearTimeout(e)},[r,l]);const f=()=>c(this,null,function*(){a(!0);try{const e=yield function(e){return c(this,null,function*(){var t,r,n;const i=se(ge,"items"),s=oe(i,le("is_archived","!=",!0),ae("name")),o=yield ce(s),a=[];for(const l of o.docs){const i=l.data();if(i.name.toLowerCase().includes(e.toLowerCase())||(null==(t=i.description)?void 0:t.toLowerCase().includes(e.toLowerCase()))||(null==(r=i.barcode)?void 0:r.includes(e))){const e=yield lr(l.id);a.push({id:l.id,name:i.name,barcode:i.barcode||"",price:i.unit_price||0,stock:e,category:null==(n=i.category)?void 0:n.name})}}return a.slice(0,20)})}(r);s(e)}catch(e){s([])}finally{a(!1)}});return d.jsxs("div",{className:`card-dark ${t}`,children:[d.jsxs("div",{className:"p-4 sm:p-6 border-b border-dark-700/50",children:[d.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[d.jsx("div",{className:"p-2 rounded-lg bg-accent-500/20 text-accent-400",children:d.jsx(N,{className:"w-5 h-5"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-white",children:"Product Search"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Find and add products to cart"})]})]}),d.jsxs("div",{className:"flex gap-2 mb-4",children:[d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u("name"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+("name"===l?"bg-primary-500/20 text-primary-400 border border-primary-500/50":"bg-dark-700/30 text-gray-400 hover:text-white"),children:[d.jsx(_,{className:"w-4 h-4 inline mr-1"}),"Name"]}),d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u("id"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+("id"===l?"bg-primary-500/20 text-primary-400 border border-primary-500/50":"bg-dark-700/30 text-gray-400 hover:text-white"),children:[d.jsx(T,{className:"w-4 h-4 inline mr-1"}),"Product ID"]}),d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u("barcode"),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+("barcode"===l?"bg-primary-500/20 text-primary-400 border border-primary-500/50":"bg-dark-700/30 text-gray-400 hover:text-white"),children:[d.jsx(b,{className:"w-4 h-4 inline mr-1"}),"Barcode"]})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:d.jsx(N,{className:"h-5 w-5 text-gray-400"})}),d.jsx("input",{type:"text",placeholder:"name"===l?"Search by product name...":"id"===l?"Enter product ID...":"Enter barcode...",value:r,onChange:e=>n(e.target.value),className:"w-full pl-10 pr-4 py-3 input-dark"}),o&&d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:d.jsx(me,{size:"sm",color:"primary"})})]})]}),d.jsx("div",{className:"max-h-96 overflow-y-auto",children:d.jsx(E,{children:0===i.length&&r&&!o?d.jsxs(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-6 text-center",children:[d.jsx(_,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),d.jsx("p",{className:"text-gray-400",children:"No products found"}),d.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Try searching by ","name"===l?"product ID or barcode":"product name"]})]}):d.jsx("div",{className:"p-4 space-y-3",children:i.map((t,r)=>d.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.05*r},className:"flex items-center justify-between p-4 rounded-lg bg-dark-800/30 border border-dark-700/30 hover:border-primary-500/30 transition-all duration-200",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"text-white font-medium truncate",children:t.name}),d.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[d.jsx("span",{className:"text-primary-400 font-semibold text-lg",children:re(t.price)}),d.jsxs("span",{className:"text-sm px-2 py-1 rounded-full "+(0===t.stock?"bg-error-500/20 text-error-400":t.stock<=5?"bg-warning-500/20 text-warning-400":"bg-success-500/20 text-success-400"),children:[t.stock," in stock"]})]}),d.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[t.category&&d.jsx("span",{children:t.category}),t.barcode&&d.jsxs("span",{className:"flex items-center",children:[d.jsx(b,{className:"w-3 h-3 mr-1"}),t.barcode]})]})]}),d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>(t=>{e(t,1),n(""),s([])})(t),disabled:0===t.stock,className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 "+(0===t.stock?"bg-gray-600/30 text-gray-500 cursor-not-allowed":"bg-primary-500/20 text-primary-400 hover:bg-primary-500/30 border border-primary-500/50"),children:[d.jsx(C,{className:"w-4 h-4"}),0===t.stock?"Out of Stock":"Add to Cart"]})]},t.id))})})}),!r&&d.jsx("div",{className:"p-4 border-t border-dark-700/50",children:d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-gray-400 text-sm mb-3",children:"Search for products by name, ID, or barcode to add them to the cart"}),d.jsx("div",{className:"flex justify-center space-x-2 text-xs text-gray-500",children:d.jsx("span",{children:"💡 Tip: Use barcode scanner for faster checkout"})})]})})]})}function hr({isOpen:e,onClose:t,cartItems:r,subtotal:n,taxAmount:i,total:s,settings:o,onPaymentComplete:a}){const[l,u]=q.useState("cash"),[f,g]=q.useState(s),[m,p]=q.useState(""),[w,A]=q.useState(""),[C,y]=q.useState(!1),[_,S]=q.useState(!1),I="cash"===l?Math.max(0,f-s):0,N=f>=s;q.useEffect(()=>{"cash"!==l&&g(s)},[l,s]);const T=[{label:"Exact",amount:s},{label:"+$5",amount:s+5},{label:"+$10",amount:s+10},{label:"+$20",amount:s+20}];return e?d.jsx(E,{children:d.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",onClick:e=>e.target===e.currentTarget&&t(),children:d.jsxs(h.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-2xl bg-dark-800 rounded-2xl border border-dark-700/50 shadow-dark-lg overflow-hidden",children:[d.jsx("div",{className:"p-6 border-b border-dark-700/50",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"p-2 rounded-lg bg-success-500/20 text-success-400",children:d.jsx(x,{className:"w-6 h-6"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-white",children:"Process Payment"}),d.jsx("p",{className:"text-gray-400",children:"Complete the transaction"})]})]}),d.jsx(h.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:t,className:"p-2 rounded-lg bg-dark-700/50 text-gray-400 hover:text-white hover:bg-dark-600/50 transition-colors",children:d.jsx(D,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"bg-dark-900/50 rounded-xl p-4 border border-dark-700/50",children:[d.jsx("h4",{className:"text-white font-semibold mb-3",children:"Order Summary"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-gray-300",children:["Items (",r.reduce((e,t)=>e+t.quantity,0),"):"]}),d.jsx("span",{className:"text-white",children:re(n)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{className:"text-gray-300",children:["Tax (",(100*o.tax_rate).toFixed(1),"%):"]}),d.jsx("span",{className:"text-white",children:re(i)})]}),d.jsx("div",{className:"border-t border-dark-700/50 pt-2",children:d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{className:"text-lg font-semibold text-white",children:"Total:"}),d.jsx("span",{className:"text-xl font-bold text-primary-400",children:re(s)})]})})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-semibold mb-4",children:"Payment Method"}),d.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u("cash"),className:"p-4 rounded-xl border-2 transition-all duration-200 "+("cash"===l?"border-success-500 bg-success-500/10 text-success-400":"border-dark-600 bg-dark-700/30 text-gray-400 hover:border-success-500/50"),children:[d.jsx(M,{className:"w-6 h-6 mx-auto mb-2"}),d.jsx("div",{className:"font-semibold",children:"Cash"})]}),d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u("card"),className:"p-4 rounded-xl border-2 transition-all duration-200 "+("card"===l?"border-primary-500 bg-primary-500/10 text-primary-400":"border-dark-600 bg-dark-700/30 text-gray-400 hover:border-primary-500/50"),children:[d.jsx(R,{className:"w-6 h-6 mx-auto mb-2"}),d.jsx("div",{className:"font-semibold",children:"Card"})]}),d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u("digital"),className:"p-4 rounded-xl border-2 transition-all duration-200 "+("digital"===l?"border-accent-500 bg-accent-500/10 text-accent-400":"border-dark-600 bg-dark-700/30 text-gray-400 hover:border-accent-500/50"),children:[d.jsx(v,{className:"w-6 h-6 mx-auto mb-2"}),d.jsx("div",{className:"font-semibold",children:"Digital"})]})]})]}),"cash"===l&&d.jsxs(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Amount Received"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"number",step:"0.01",min:s,value:f,onChange:e=>g(parseFloat(e.target.value)||0),className:"w-full input-dark input-large pr-12 "+(N?"":"ring-error-500 border-error-500"),placeholder:"Enter amount received"}),d.jsx(h.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>S(!_),className:"absolute inset-y-0 right-0 flex items-center pr-3",children:d.jsx(O,{className:"w-5 h-5 text-gray-400 hover:text-white"})})]}),!N&&d.jsxs("p",{className:"mt-2 text-sm text-error-400",children:["Amount must be at least ",re(s)]})]}),d.jsx("div",{className:"grid grid-cols-4 gap-2",children:T.map(e=>d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>g(e.amount),className:"p-2 rounded-lg bg-dark-700/50 text-gray-300 hover:bg-dark-600/50 hover:text-white transition-colors text-sm",children:e.label},e.label))}),I>0&&d.jsx("div",{className:"bg-success-500/10 border border-success-500/20 rounded-xl p-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-success-300 font-medium",children:"Change Due:"}),d.jsx("span",{className:"text-2xl font-bold text-success-400",children:re(I)})]})})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Customer Name (Optional)"}),d.jsx("input",{type:"text",value:m,onChange:e=>p(e.target.value),className:"w-full input-dark",placeholder:"Enter customer name"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone Number (Optional)"}),d.jsx("input",{type:"tel",value:w,onChange:e=>A(e.target.value),className:"w-full input-dark",placeholder:"Enter phone number"})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-dark-700/50",children:[d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"btn-secondary flex-1 py-3",children:"Cancel"}),d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c(this,null,function*(){if(N){y(!0);try{yield a({payment_method:l,payment_amount:f,change_amount:I,customer_name:m.trim()||void 0,customer_phone:w.trim()||void 0})}catch(e){}finally{y(!1)}}}),disabled:!N||C,className:"btn-primary flex-1 flex items-center justify-center gap-2 py-3",children:C?d.jsxs(d.Fragment,{children:[d.jsx(me,{size:"sm",color:"white"}),"Processing..."]}):d.jsxs(d.Fragment,{children:[d.jsx(x,{className:"w-4 h-4"}),"Complete Sale"]})})]})]})]})})}):null}const ur=q.forwardRef(({transaction:e,settings:t,className:r="",variant:n="standard"},i)=>{const s="thermal"===n?{width:"80mm",fontSize:"12px",lineHeight:"1.2",fontFamily:"monospace"}:{width:"210mm",fontSize:"14px",lineHeight:"1.4",fontFamily:"Arial, sans-serif"};return d.jsxs("div",{ref:i,className:`bg-white text-black p-6 mx-auto ${r}`,style:s,children:[d.jsxs("div",{className:"text-center border-b-2 border-gray-800 pb-4 mb-4",children:[d.jsx("h1",{className:"text-2xl font-bold mb-2",children:t.store_name}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("div",{className:"font-medium",children:t.store_address}),d.jsx("div",{className:"font-medium",children:t.store_phone})]}),d.jsx("div",{className:"mt-2 text-sm text-gray-600",children:"Professional Inventory Management System"})]}),d.jsxs("div",{className:"border-b border-gray-400 pb-3 mb-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Transaction #:"})," ",e.transaction_number]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Date:"})," ",te(e.created_at,"MM/dd/yyyy")]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Time:"})," ",te(e.created_at,"HH:mm:ss")]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Cashier:"})," ",e.cashier_id]})]}),e.customer_name&&d.jsxs("div",{className:"mt-2",children:[d.jsx("strong",{children:"Customer:"})," ",e.customer_name,e.customer_phone&&` (${e.customer_phone})`]})]}),d.jsx("div",{className:"mb-4",children:d.jsxs("table",{className:"w-full border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b-2 border-gray-800",children:[d.jsx("th",{className:"text-left py-2 font-bold",children:"Item"}),d.jsx("th",{className:"text-center py-2 font-bold",children:"Qty"}),d.jsx("th",{className:"text-right py-2 font-bold",children:"Price"}),d.jsx("th",{className:"text-right py-2 font-bold",children:"Total"})]})}),d.jsx("tbody",{children:e.items.map((e,t)=>d.jsxs("tr",{className:"border-b border-gray-300",children:[d.jsxs("td",{className:"py-2",children:[d.jsx("div",{className:"font-medium",children:e.item_name}),e.barcode&&d.jsxs("div",{className:"text-xs text-gray-600",children:["#",e.barcode]})]}),d.jsx("td",{className:"text-center py-2",children:e.quantity}),d.jsx("td",{className:"text-right py-2",children:re(e.unit_price)}),d.jsx("td",{className:"text-right py-2 font-medium",children:re(e.line_total)})]},t))})]})}),d.jsx("div",{className:"border-t-2 border-gray-800 pt-3 mb-4",children:d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("span",{children:"Subtotal:"}),d.jsx("span",{className:"font-medium",children:re(e.subtotal)})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{children:["Tax (",(100*(t.tax_rate||0)).toFixed(1),"%):"]}),d.jsx("span",{className:"font-medium",children:re(e.tax_amount)})]}),e.discount_amount>0&&d.jsxs("div",{className:"flex justify-between text-red-600",children:[d.jsx("span",{children:"Discount:"}),d.jsxs("span",{className:"font-medium",children:["-",re(e.discount_amount)]})]}),d.jsxs("div",{className:"flex justify-between text-xl font-bold border-t border-gray-400 pt-2",children:[d.jsx("span",{children:"TOTAL:"}),d.jsx("span",{children:re(e.total_amount)})]})]})}),d.jsxs("div",{className:"border-b border-gray-400 pb-3 mb-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Payment Method:"}),d.jsx("div",{className:"capitalize",children:e.payment_method})]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Amount Paid:"}),d.jsx("div",{children:re(e.payment_amount)})]})]}),e.change_amount>0&&d.jsx("div",{className:"mt-2 text-lg font-bold",children:d.jsxs("strong",{children:["Change Due: ",re(e.change_amount)]})})]}),d.jsx("div",{className:"bg-gray-100 p-3 rounded mb-4",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center text-sm",children:[d.jsxs("div",{children:[d.jsx("div",{className:"font-bold text-lg",children:e.items.reduce((e,t)=>e+t.quantity,0)}),d.jsx("div",{className:"text-gray-600",children:"Total Items"})]}),d.jsxs("div",{children:[d.jsx("div",{className:"font-bold text-lg",children:e.items.length}),d.jsx("div",{className:"text-gray-600",children:"Line Items"})]}),d.jsxs("div",{children:[d.jsx("div",{className:"font-bold text-lg",children:re(e.subtotal/e.items.reduce((e,t)=>e+t.quantity,0))}),d.jsx("div",{className:"text-gray-600",children:"Avg. Price"})]})]})}),d.jsxs("div",{className:"text-center space-y-3",children:[d.jsx("div",{className:"text-lg font-medium",children:t.receipt_footer_message}),d.jsx("div",{className:"border-t border-gray-400 pt-3",children:d.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[d.jsx("div",{children:"Thank you for your business!"}),d.jsx("div",{children:"Visit us again soon"}),d.jsx("div",{className:"font-medium",children:"Powered by StockSuite POS"})]})}),d.jsxs("div",{className:"text-xs text-gray-500 border-t border-gray-300 pt-2",children:[d.jsx("div",{children:"Returns accepted within 30 days with receipt"}),d.jsx("div",{children:"Store credit issued for returns without receipt"})]}),d.jsx("div",{className:"flex justify-center mt-4",children:d.jsx("div",{className:"border-2 border-gray-400 p-2",children:d.jsx("div",{className:"w-16 h-16 bg-gray-200 flex items-center justify-center text-xs font-bold",children:"QR CODE"})})}),d.jsx("div",{className:"text-xs text-gray-500",children:"Scan for digital receipt and loyalty points"})]}),d.jsxs("div",{className:"mt-6 text-xs text-gray-400 text-center border-t border-gray-300 pt-2",children:[d.jsxs("div",{children:["Receipt #",e.transaction_number]}),d.jsxs("div",{children:["Printed on ",te(new Date,"MM/dd/yyyy HH:mm:ss")]})]})]})});function fr(e,t){for(let r=0;r<t.length;r++)e.push(t.charCodeAt(r))}function gr(e){return c(this,null,function*(){try{if(!navigator.usb)throw new Error("Web USB not supported");const t=yield navigator.usb.requestDevice({filters:[{vendorId:1208},{vendorId:1305},{vendorId:5455}]});yield t.open(),yield t.selectConfiguration(1),yield t.claimInterface(0);const r=function(e){const{transaction:t,settings:r}=e,n=[];return n.push(27,64),n.push(27,97,1),n.push(27,69,1),fr(n,r.store_name),n.push(10),n.push(27,69,0),fr(n,r.store_address),n.push(10),fr(n,r.store_phone),n.push(10,10),n.push(27,97,0),fr(n,`Transaction #: ${t.transaction_number}`),n.push(10),fr(n,`Date: ${te(t.created_at,"MM/dd/yyyy HH:mm")}`),n.push(10),fr(n,`Cashier: ${t.cashier_id}`),n.push(10),t.customer_name&&(fr(n,`Customer: ${t.customer_name}`),n.push(10)),n.push(10),t.items.forEach(e=>{fr(n,e.item_name),n.push(10),fr(n,`  ${e.quantity} x ${re(e.unit_price)} = ${re(e.line_total)}`),n.push(10)}),n.push(10),fr(n,`Subtotal: ${re(t.subtotal)}`),n.push(10),fr(n,`Tax: ${re(t.tax_amount)}`),n.push(10),n.push(27,69,1),fr(n,`TOTAL: ${re(t.total_amount)}`),n.push(27,69,0),n.push(10,10),fr(n,`Payment: ${t.payment_method.toUpperCase()}`),n.push(10),fr(n,`Paid: ${re(t.payment_amount)}`),n.push(10),t.change_amount>0&&(fr(n,`Change: ${re(t.change_amount)}`),n.push(10)),n.push(10),n.push(27,97,1),fr(n,r.receipt_footer_message),n.push(10),fr(n,"Powered by StockSuite POS"),n.push(10,10,10),n.push(29,86,65,16),new Uint8Array(n)}(e);return yield t.transferOut(1,r),yield t.close(),!0}catch(t){return!1}})}function mr({transaction:e,settings:t,onPrintComplete:r,className:n=""}){const[i,s]=q.useState([]),[o,u]=q.useState(null),[f,g]=q.useState(!1),[m,C]=q.useState(!1),[y,E]=q.useState([]);q.useEffect(()=>{_()},[]);const _=()=>c(this,null,function*(){C(!0);try{const t=[];if(navigator.usb)try{(yield navigator.usb.getDevices()).forEach((e,r)=>{var n,i,s;((null==(n=e.productName)?void 0:n.toLowerCase().includes("printer"))||(null==(i=e.manufacturerName)?void 0:i.toLowerCase().includes("epson"))||(null==(s=e.manufacturerName)?void 0:s.toLowerCase().includes("star")))&&t.push({id:`usb-${r}`,name:`${e.manufacturerName||"Unknown"} ${e.productName||"USB Printer"}`,type:"usb",connected:!0,status:"ready"})})}catch(e){}const r=[{ip:"192.168.1.100",name:"Network Printer 1"},{ip:"192.168.1.101",name:"Network Printer 2"}];for(const i of r)try{t.push({id:`network-${i.ip}`,name:i.name,type:"network",connected:Math.random()>.5,status:"ready"})}catch(e){}t.push({id:"system-default",name:"System Default Printer",type:"usb",connected:!0,status:"ready"}),s(t);const n=t.find(e=>e.connected&&"ready"===e.status);n&&u(n)}catch(e){ee.error("Failed to scan for printers")}finally{C(!1)}}),S=(n="standard")=>c(this,null,function*(){if(o){g(!0);try{if("usb"===o.type&&"thermal"===n){if(!(yield gr({transaction:e,settings:t})))throw new Error("Thermal printing failed");ee.success("Receipt printed successfully"),E(e=>[...e,`${(new Date).toLocaleTimeString()} - Thermal receipt`])}else{const r=function(e){const{transaction:t,settings:r}=e;return`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset="UTF-8">\n      <title>Receipt - ${t.transaction_number}</title>\n      <style>\n        body {\n          font-family: 'Courier New', monospace;\n          font-size: 12px;\n          line-height: 1.2;\n          margin: 0;\n          padding: 20px;\n          width: 80mm;\n          background: white;\n          color: black;\n        }\n        .center { text-align: center; }\n        .bold { font-weight: bold; }\n        .large { font-size: 14px; }\n        .separator { border-bottom: 1px solid #000; margin: 10px 0; }\n        .flex { display: flex; justify-content: space-between; }\n        .item { margin-bottom: 8px; }\n        .item-details { font-size: 10px; color: #666; }\n        @media print {\n          body { margin: 0; padding: 10px; }\n        }\n      </style>\n    </head>\n    <body>\n      <div class="center">\n        <div class="bold large">${r.store_name}</div>\n        <div>${r.store_address}</div>\n        <div>${r.store_phone}</div>\n      </div>\n      \n      <div class="separator"></div>\n      \n      <div class="flex">\n        <span>Transaction #:</span>\n        <span class="bold">${t.transaction_number}</span>\n      </div>\n      <div class="flex">\n        <span>Date:</span>\n        <span>${te(t.created_at,"MM/dd/yyyy HH:mm")}</span>\n      </div>\n      <div class="flex">\n        <span>Cashier:</span>\n        <span>${t.cashier_id}</span>\n      </div>\n      ${t.customer_name?`\n      <div class="flex">\n        <span>Customer:</span>\n        <span>${t.customer_name}</span>\n      </div>\n      `:""}\n      \n      <div class="separator"></div>\n      \n      ${t.items.map(e=>`\n        <div class="item">\n          <div class="flex">\n            <span style="flex: 1;">${e.item_name}</span>\n            <span>${re(e.line_total)}</span>\n          </div>\n          <div class="item-details">\n            ${e.quantity} x ${re(e.unit_price)}\n            ${e.barcode?` #${e.barcode}`:""}\n          </div>\n        </div>\n      `).join("")}\n      \n      <div class="separator"></div>\n      \n      <div class="flex">\n        <span>Subtotal:</span>\n        <span>${re(t.subtotal)}</span>\n      </div>\n      <div class="flex">\n        <span>Tax:</span>\n        <span>${re(t.tax_amount)}</span>\n      </div>\n      ${t.discount_amount>0?`\n      <div class="flex">\n        <span>Discount:</span>\n        <span>-${re(t.discount_amount)}</span>\n      </div>\n      `:""}\n      <div class="flex bold large">\n        <span>TOTAL:</span>\n        <span>${re(t.total_amount)}</span>\n      </div>\n      \n      <div class="separator"></div>\n      \n      <div class="flex">\n        <span>Payment Method:</span>\n        <span class="bold">${t.payment_method.toUpperCase()}</span>\n      </div>\n      <div class="flex">\n        <span>Amount Paid:</span>\n        <span>${re(t.payment_amount)}</span>\n      </div>\n      ${t.change_amount>0?`\n      <div class="flex bold">\n        <span>Change:</span>\n        <span>${re(t.change_amount)}</span>\n      </div>\n      `:""}\n      \n      <div class="separator"></div>\n      \n      <div class="center">\n        <div>${r.receipt_footer_message}</div>\n        <div style="margin-top: 10px; font-size: 10px; color: #666;">\n          Powered by StockSuite POS\n        </div>\n      </div>\n    </body>\n    </html>\n  `}({transaction:e,settings:t}),n=window.open("","_blank");if(!n)throw new Error("Failed to open print window");n.document.write(r),n.document.close(),n.focus(),n.print(),setTimeout(()=>{n.close(),ee.success("Receipt sent to printer"),E(e=>[...e,`${(new Date).toLocaleTimeString()} - Standard receipt`])},1e3)}null==r||r()}catch(i){ee.error(i.message||"Failed to print receipt")}finally{g(!1)}}else ee.error("Please select a printer first")}),I=e=>c(this,null,function*(){var t;try{if("usb"===e.type){const t=yield navigator.usb.requestDevice({filters:[{vendorId:1208},{vendorId:1305},{vendorId:5455}]});yield t.open(),yield t.selectConfiguration(1),yield t.claimInterface(0),ee.success(`Connected to ${e.name}`),u(l(a({},e),{connected:!0,status:"ready"}))}else if("bluetooth"===e.type){const r=yield navigator.bluetooth.requestDevice({filters:[{services:["000018f0-0000-1000-8000-00805f9b34fb"]}]});(yield null==(t=r.gatt)?void 0:t.connect())&&(ee.success(`Connected to ${e.name}`),u(l(a({},e),{connected:!0,status:"ready"})))}}catch(r){ee.error(`Failed to connect to ${e.name}`)}});return d.jsxs("div",{className:`card-dark p-6 ${n}`,children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"p-2 rounded-lg bg-primary-500/20 text-primary-400",children:d.jsx(P,{className:"w-6 h-6"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-white",children:"Receipt Printing"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Print professional receipts"})]})]}),d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:_,disabled:m,className:"btn-secondary flex items-center gap-2",children:[m?d.jsx(me,{size:"sm",color:"primary"}):d.jsx(A,{className:"w-4 h-4"}),m?"Scanning...":"Refresh"]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-base font-medium text-gray-300 mb-3",children:"Available Printers"}),d.jsx("div",{className:"space-y-2",children:i.map(e=>d.jsx(h.div,{whileHover:{scale:1.01},onClick:()=>u(e),className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 "+((null==o?void 0:o.id)===e.id?"border-primary-500 bg-primary-500/10":"border-dark-600 bg-dark-700/30 hover:border-primary-500/50"),children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("div",{className:"p-2 rounded-lg "+("usb"===e.type?"bg-blue-500/20 text-blue-400":"network"===e.type?"bg-green-500/20 text-green-400":"bg-purple-500/20 text-purple-400"),children:"usb"===e.type?d.jsx(B,{className:"w-4 h-4"}):"network"===e.type?d.jsx(L,{className:"w-4 h-4"}):d.jsx(k,{className:"w-4 h-4"})}),d.jsxs("div",{children:[d.jsx("div",{className:"text-white font-medium",children:e.name}),d.jsxs("div",{className:"text-gray-400 text-sm capitalize",children:[e.type," • ",e.status]})]})]}),d.jsx("div",{className:"flex items-center space-x-2",children:e.connected?d.jsx(w,{className:"w-5 h-5 text-success-400"}):d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t=>{t.stopPropagation(),I(e)},className:"btn-secondary text-xs px-3 py-1",children:"Connect"})})]})},e.id))})]}),o&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>S("standard"),disabled:f||!o.connected,className:"btn-primary flex items-center justify-center gap-2 py-3",children:[f?d.jsx(me,{size:"sm",color:"white"}):d.jsx(P,{className:"w-4 h-4"}),"Print Standard Receipt"]}),d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>S("thermal"),disabled:f||!o.connected||"usb"!==o.type,className:"btn-secondary flex items-center justify-center gap-2 py-3",children:[f?d.jsx(me,{size:"sm",color:"primary"}):d.jsx(P,{className:"w-4 h-4"}),"Print Thermal Receipt"]})]}),y.length>0&&d.jsxs("div",{className:"bg-dark-800/30 rounded-lg p-4 border border-dark-700/50",children:[d.jsx("h4",{className:"text-white font-medium mb-3",children:"Recent Prints"}),d.jsx("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:y.slice(-5).map((e,t)=>d.jsxs("div",{className:"text-sm text-gray-400 flex items-center",children:[d.jsx(w,{className:"w-3 h-3 mr-2 text-success-400"}),e]},t))})]})]}),0===i.length&&!m&&d.jsxs("div",{className:"text-center py-8",children:[d.jsx(p,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),d.jsx("h4",{className:"text-gray-400 font-medium mb-2",children:"No Printers Found"}),d.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Connect a USB thermal printer or ensure network printers are accessible"}),d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:_,className:"btn-primary",children:"Scan for Printers"})]})]})}function pr(){const e=pe(e=>e.profile),[t,r]=q.useState([]),[n,i]=q.useState(!1),[s,o]=q.useState(!1),[u,f]=q.useState(null),[g,m]=q.useState(null),[p,w]=q.useState(!0),C=q.useRef(null),y=t.reduce((e,t)=>e+t.line_total,0),E=y*((null==g?void 0:g.tax_rate)||.08),_=y+E;q.useEffect(()=>{S()},[]);const S=()=>c(this,null,function*(){try{const e=yield cr();m(e)}catch(e){m({id:"default",store_name:"StockSuite Store",store_address:"",store_phone:"",tax_rate:0,currency:"USD",receipt_footer_message:"Thank you for your business!",barcode_scanner_enabled:!0,thermal_printer_enabled:!1,auto_print_receipt:!1})}finally{w(!1)}}),I=Be.useReactToPrint({content:()=>C.current,documentTitle:`Receipt-${null==u?void 0:u.transaction_number}`,onAfterPrint:()=>{ee.success("Receipt printed successfully")},onPrintError:()=>{ee.error("Failed to print receipt")}}),N=(e,n)=>{const i=t.findIndex(t=>t.item_id===e.id);if(i>=0){const r=t[i].quantity+n;if(!(r<=e.stock))return void ee.warning(`Only ${e.stock} items available in stock`);T(t[i].id,r)}else{const t={id:D(),item_id:e.id,name:e.name,quantity:n,unit_price:e.price,line_total:e.price*n,sku:e.sku,barcode:e.barcode};r(e=>[...e,t])}},T=(e,t)=>{r(r=>r.map(r=>r.id===e?l(a({},r),{quantity:t,line_total:r.unit_price*t}):r))},b=()=>{f(null),r([])},D=()=>Math.random().toString(36).substr(2,9);return p?d.jsx("div",{className:"flex items-center justify-center h-64",children:d.jsx(me,{size:"lg",text:"Loading POS system..."})}):g?d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gradient",children:"Point of Sale"}),d.jsxs("p",{className:"text-gray-400 mt-1",children:[g.store_name," - Professional Retail System"]})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[u&&d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:I,className:"btn-secondary flex items-center gap-2",children:[d.jsx(P,{className:"w-4 h-4"}),"Print Receipt"]}),d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:b,className:"btn-primary flex items-center gap-2",children:[d.jsx(j,{className:"w-4 h-4"}),"New Transaction"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[d.jsx(sr,{onScan:e=>c(this,null,function*(){var t;try{let r=yield function(e){return c(this,null,function*(){var t;try{const r=se(ge,"items"),n=oe(r,le("barcode","==",e),le("is_archived","!=",!0)),i=yield ce(n);if(i.empty)return null;const s=i.docs[0],o=s.data(),a=yield lr(s.id);return{id:s.id,name:o.name,barcode:o.barcode,price:o.unit_price||0,stock:a,category:null==(t=o.category)?void 0:t.name}}catch(r){return null}})}(e);if(!r){const n=(yield we(e))||(yield Ae(e));if(n){const i=yield J(()=>import("./items-jQwjfGOh.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(e=>e.getItemStockLevel(n.id));r={id:n.id,name:n.name,barcode:n.barcode||e,price:n.unit_price||0,stock:(null==i?void 0:i.current_quantity)||0,category:null==(t=n.category)?void 0:t.name}}}if(!r)return void ee.error(`Product not found for barcode: ${e}`);if(0===r.stock)return void ee.error(`${r.name} is out of stock`);N(r,1),ee.success(`Added ${r.name} to cart`)}catch(r){ee.error("Failed to process barcode")}}),isActive:n,onToggle:()=>i(!n)}),d.jsx(dr,{onAddToCart:N})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx(or,{items:t,onUpdateQuantity:T,onRemoveItem:e=>{r(t=>t.filter(t=>t.id!==e))},onClearCart:()=>{t.length>0&&confirm("Are you sure you want to clear the cart?")&&(r([]),ee.info("Cart cleared"))},subtotal:y,taxAmount:E,total:_,taxRate:g.tax_rate}),t.length>0&&d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>o(!0),className:"w-full btn-primary py-4 text-lg font-semibold flex items-center justify-center gap-2",children:[d.jsx(x,{className:"w-5 h-5"}),"Proceed to Payment"]})]})]}),u&&d.jsx(mr,{transaction:u,settings:g,onPrintComplete:()=>ee.success("Receipt printed successfully")}),d.jsx(hr,{isOpen:s,onClose:()=>o(!1),cartItems:t,subtotal:y,taxAmount:E,total:_,settings:g,onPaymentComplete:n=>c(this,null,function*(){try{const i=yield ar(a({items:t,subtotal:y,tax_amount:E,discount_amount:0,total_amount:_,cashier_id:(null==e?void 0:e.id)||"unknown"},n));f(i),r([]),o(!1),ee.success("Transaction completed successfully!"),(null==g?void 0:g.auto_print_receipt)&&setTimeout(()=>{I()},500)}catch(i){throw ee.error(i.message||"Failed to process payment"),i}})}),d.jsx("div",{className:"hidden",children:u&&d.jsx(ur,{ref:C,transaction:u,settings:g,variant:"standard"})}),u&&d.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:d.jsxs(h.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-dark-800 rounded-2xl border border-dark-700/50 shadow-dark-lg p-6 max-w-md w-full text-center",children:[d.jsx("div",{className:"p-3 rounded-full bg-success-500/20 text-success-400 w-fit mx-auto mb-4",children:d.jsx(x,{className:"w-8 h-8"})}),d.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Transaction Complete!"}),d.jsxs("p",{className:"text-gray-400 mb-4",children:["Transaction #",u.transaction_number]}),d.jsxs("div",{className:"bg-dark-900/50 rounded-lg p-4 mb-6",children:[d.jsx("div",{className:"text-2xl font-bold text-success-400 mb-1",children:re(u.total_amount)}),u.change_amount>0&&d.jsxs("div",{className:"text-lg text-warning-400",children:["Change: ",re(u.change_amount)]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:I,className:"btn-secondary flex-1 flex items-center justify-center gap-2",children:[d.jsx(P,{className:"w-4 h-4"}),"Print Receipt"]}),d.jsxs(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:b,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[d.jsx(j,{className:"w-4 h-4"}),"New Sale"]})]})]})})]}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx(A,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"POS Settings Required"}),d.jsx("p",{className:"text-gray-500",children:"Please configure POS settings to continue"})]})}function wr(){const[e,t]=q.useState((new Date).toISOString().split("T")[0]),[r,n]=q.useState(null),[i,s]=q.useState([]),[o,u]=q.useState(!0),f=["#3b82f6","#d946ef","#10b981","#f59e0b","#ef4444","#8b5cf6"];q.useEffect(()=>{g()},[e]);const g=()=>c(this,null,function*(){u(!0);try{const r=yield function(e){return c(this,null,function*(){const t=se(ge,"pos_transactions");let r=oe(t,ae("created_at","desc"));return r=oe(r,de(e)),(yield ce(r)).docs.map(e=>{var t;return l(a({id:e.id},e.data()),{created_at:(null==(t=e.data().created_at)?void 0:t.toDate)?e.data().created_at.toDate():new Date(e.data().created_at)})})})}(10);s(r);try{const t=yield function(e){return c(this,null,function*(){const t=new Date(e);t.setHours(0,0,0,0);const r=new Date(e);r.setHours(23,59,59,999);try{const n=se(ge,"pos_transactions"),i=oe(n,le("status","==","completed"),le("created_at",">=",he.fromDate(t)),le("created_at","<=",he.fromDate(r)),ae("created_at","desc")),s=yield ce(i);let o=0,a=0;const l={},c={};s.docs.forEach(e=>{const t=e.data();o+=t.total_amount,a++,c[t.payment_method]||(c[t.payment_method]={count:0,amount:0}),c[t.payment_method].count++,c[t.payment_method].amount+=t.total_amount,t.items.forEach(e=>{l[e.item_name]||(l[e.item_name]={quantity:0,revenue:0}),l[e.item_name].quantity+=e.quantity,l[e.item_name].revenue+=e.line_total})});const d=Object.entries(l).map(([e,t])=>({item_name:e,quantity_sold:t.quantity,revenue:t.revenue})).sort((e,t)=>t.revenue-e.revenue).slice(0,10),h=Object.entries(c).map(([e,t])=>({method:e,count:t.count,amount:t.amount}));return{date:e,total_sales:o,total_transactions:a,average_transaction:a>0?o/a:0,top_selling_items:d,payment_methods:h}}catch(n){return{date:e,total_sales:0,total_transactions:0,average_transaction:0,top_selling_items:[],payment_methods:[]}}})}(new Date(e));n(t)}catch(t){const i=m(r,new Date(e));n(i)}}catch(r){n({date:new Date(e),total_sales:0,total_transactions:0,average_transaction:0,top_selling_items:[],payment_methods:[]}),s([])}finally{u(!1)}}),m=(e,t)=>{const r=e.filter(e=>new Date(e.created_at).toDateString()===t.toDateString()),n=r.reduce((e,t)=>e+t.total_amount,0),i=r.length;return{date:t,total_sales:n,total_transactions:i,average_transaction:i>0?n/i:0,top_selling_items:[],payment_methods:[]}},p=({active:e,payload:t,label:r})=>e&&t&&t.length?d.jsxs("div",{className:"glass-effect p-3 rounded-lg border border-dark-600/50",children:[d.jsx("p",{className:"text-gray-200 font-medium",children:r}),t.map((e,t)=>d.jsxs("p",{className:"text-primary-400",children:[e.name,": ",e.value]},t))]}):null;return o?d.jsx("div",{className:"flex items-center justify-center h-64",children:d.jsx(me,{size:"lg",text:"Loading sales reports..."})}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gradient",children:"Sales Reports"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Analyze your Point of Sale performance and trends"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx(F,{className:"w-5 h-5 text-gray-400"}),d.jsx("input",{type:"date",value:e,onChange:e=>t(e.target.value),className:"input-dark"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[d.jsx(Ce,{delay:.1,children:d.jsx("div",{className:"p-4 sm:p-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Total Sales"}),d.jsx("p",{className:"text-2xl font-bold text-white",children:re((null==r?void 0:r.total_sales)||0)})]}),d.jsx("div",{className:"p-3 rounded-xl bg-success-500/20 text-success-400",children:d.jsx(U,{className:"w-6 h-6"})})]})})}),d.jsx(Ce,{delay:.2,children:d.jsx("div",{className:"p-4 sm:p-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Transactions"}),d.jsx("p",{className:"text-2xl font-bold text-white",children:(null==r?void 0:r.total_transactions)||0})]}),d.jsx("div",{className:"p-3 rounded-xl bg-primary-500/20 text-primary-400",children:d.jsx(H,{className:"w-6 h-6"})})]})})}),d.jsx(Ce,{delay:.3,children:d.jsx("div",{className:"p-4 sm:p-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Avg. Transaction"}),d.jsx("p",{className:"text-2xl font-bold text-white",children:re((null==r?void 0:r.average_transaction)||0)})]}),d.jsx("div",{className:"p-3 rounded-xl bg-accent-500/20 text-accent-400",children:d.jsx(V,{className:"w-6 h-6"})})]})})}),d.jsx(Ce,{delay:.4,children:d.jsx("div",{className:"p-4 sm:p-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Items Sold"}),d.jsx("p",{className:"text-2xl font-bold text-white",children:(null==r?void 0:r.top_selling_items.reduce((e,t)=>e+t.quantity_sold,0))||0})]}),d.jsx("div",{className:"p-3 rounded-xl bg-warning-500/20 text-warning-400",children:d.jsx(_,{className:"w-6 h-6"})})]})})})]}),d.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[d.jsx(Ce,{delay:.5,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center",children:[d.jsx("div",{className:"w-2 h-6 bg-gradient-to-b from-primary-500 to-accent-500 rounded-full mr-3"}),"Top Selling Items"]}),d.jsx("div",{className:"h-80",children:d.jsx(ye,{width:"100%",height:"100%",children:d.jsxs(Ee,{data:(null==r?void 0:r.top_selling_items)||[],children:[d.jsx(_e,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),d.jsx(Se,{dataKey:"item_name",stroke:"#9CA3AF",fontSize:10,angle:-45,textAnchor:"end",height:80}),d.jsx(Ie,{stroke:"#9CA3AF",fontSize:10}),d.jsx(Ne,{content:d.jsx(p,{})}),d.jsx(Te,{dataKey:"quantity_sold",fill:"#3b82f6",radius:[4,4,0,0]})]})})})]})}),d.jsx(Ce,{delay:.6,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center",children:[d.jsx("div",{className:"w-2 h-6 bg-gradient-to-b from-success-500 to-warning-500 rounded-full mr-3"}),"Payment Methods"]}),d.jsx("div",{className:"h-80",children:d.jsx(ye,{width:"100%",height:"100%",children:d.jsxs(be,{children:[d.jsx(xe,{data:(null==r?void 0:r.payment_methods)||[],cx:"50%",cy:"50%",outerRadius:"80%",fill:"#8884d8",dataKey:"amount",label:({method:e,percent:t})=>`${e} ${(100*t).toFixed(0)}%`,children:((null==r?void 0:r.payment_methods)||[]).map((e,t)=>d.jsx(De,{fill:f[t%f.length]},`cell-${t}`))}),d.jsx(Ne,{content:d.jsx(p,{})})]})})})]})})]}),d.jsx(Ce,{delay:.7,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("h3",{className:"text-xl font-semibold text-white mb-6 flex items-center",children:[d.jsx("div",{className:"w-2 h-6 bg-gradient-to-b from-warning-500 to-error-500 rounded-full mr-3"}),"Recent Transactions"]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b border-dark-700/50",children:[d.jsx("th",{className:"text-left py-3 px-4 text-gray-300 font-medium",children:"Transaction #"}),d.jsx("th",{className:"text-left py-3 px-4 text-gray-300 font-medium",children:"Date"}),d.jsx("th",{className:"text-left py-3 px-4 text-gray-300 font-medium",children:"Items"}),d.jsx("th",{className:"text-left py-3 px-4 text-gray-300 font-medium",children:"Payment"}),d.jsx("th",{className:"text-right py-3 px-4 text-gray-300 font-medium",children:"Total"})]})}),d.jsx("tbody",{children:i.map((e,t)=>d.jsxs(h.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"border-b border-dark-700/30 hover:bg-dark-700/30 transition-colors",children:[d.jsx("td",{className:"py-3 px-4 text-white font-medium",children:e.transaction_number}),d.jsx("td",{className:"py-3 px-4 text-gray-300",children:new Date(e.created_at).toLocaleDateString()}),d.jsxs("td",{className:"py-3 px-4 text-gray-300",children:[e.items.reduce((e,t)=>e+t.quantity,0)," items"]}),d.jsx("td",{className:"py-3 px-4",children:d.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("cash"===e.payment_method?"bg-success-500/20 text-success-400":"card"===e.payment_method?"bg-primary-500/20 text-primary-400":"bg-accent-500/20 text-accent-400"),children:e.payment_method})}),d.jsx("td",{className:"py-3 px-4 text-right text-primary-400 font-semibold",children:re(e.total_amount)})]},e.id))})]})})]})})]})}function Ar(){const[e,t]=q.useState(null),[r,n]=q.useState(!0),[i,s]=q.useState(!1),[o,f]=q.useState(!1);q.useEffect(()=>{g()},[]);const g=()=>c(this,null,function*(){try{const e=yield cr();t(e)}catch(e){ee.error("Failed to load POS settings")}finally{n(!1)}}),m=(r,n)=>{e&&(t(e=>e?l(a({},e),{[r]:n}):null),f(!0))};return r?d.jsx("div",{className:"flex items-center justify-center h-64",children:d.jsx(me,{size:"lg",text:"Loading POS settings..."})}):e?d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gradient",children:"POS Settings"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Configure your Point of Sale system preferences"})]}),d.jsxs("form",{onSubmit:t=>c(this,null,function*(){if(t.preventDefault(),e){s(!0);try{yield function(e){return c(this,null,function*(){yield fe(ie(ge,"pos_settings","default"),l(a({},e),{updated_at:he.fromDate(new Date)}),{merge:!0})})}(e),f(!1),ee.success("POS settings saved successfully")}catch(r){ee.error("Failed to save POS settings")}finally{s(!1)}}}),className:"space-y-6",children:[d.jsx(Ce,{delay:.1,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 rounded-lg bg-primary-500/20 text-primary-400 mr-4",children:d.jsx(z,{className:"w-6 h-6"})}),d.jsx("h3",{className:"text-xl font-semibold text-white",children:"Store Information"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-base font-medium text-gray-300 mb-3",children:[d.jsx(z,{className:"w-4 h-4 inline mr-2"}),"Store Name"]}),d.jsx("input",{type:"text",value:e.store_name,onChange:e=>m("store_name",e.target.value),className:"w-full input-dark input-large",placeholder:"Enter store name",required:!0})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-base font-medium text-gray-300 mb-3",children:[d.jsx(G,{className:"w-4 h-4 inline mr-2"}),"Store Phone"]}),d.jsx("input",{type:"tel",value:e.store_phone,onChange:e=>m("store_phone",e.target.value),className:"w-full input-dark input-large",placeholder:"Enter store phone number",required:!0})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsxs("label",{className:"block text-base font-medium text-gray-300 mb-3",children:[d.jsx(Y,{className:"w-4 h-4 inline mr-2"}),"Store Address"]}),d.jsx("textarea",{value:e.store_address,onChange:e=>m("store_address",e.target.value),rows:3,className:"w-full input-dark input-large resize-none",placeholder:"Enter complete store address",required:!0})]})]})}),d.jsx(Ce,{delay:.2,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 rounded-lg bg-success-500/20 text-success-400 mr-4",children:d.jsx(U,{className:"w-6 h-6"})}),d.jsx("h3",{className:"text-xl font-semibold text-white",children:"Financial Settings"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-base font-medium text-gray-300 mb-3",children:[d.jsx(W,{className:"w-4 h-4 inline mr-2"}),"Tax Rate (%)"]}),d.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",value:100*e.tax_rate,onChange:e=>m("tax_rate",parseFloat(e.target.value)/100||0),className:"w-full input-dark input-large",placeholder:"Enter tax rate",required:!0}),d.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["Current rate: ",(100*e.tax_rate).toFixed(2),"%"]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-base font-medium text-gray-300 mb-3",children:[d.jsx(U,{className:"w-4 h-4 inline mr-2"}),"Currency"]}),d.jsxs("select",{value:e.currency,onChange:e=>m("currency",e.target.value),className:"w-full input-dark input-large",required:!0,children:[d.jsx("option",{value:"USD",children:"USD - US Dollar"}),d.jsx("option",{value:"EUR",children:"EUR - Euro"}),d.jsx("option",{value:"GBP",children:"GBP - British Pound"}),d.jsx("option",{value:"CAD",children:"CAD - Canadian Dollar"}),d.jsx("option",{value:"AUD",children:"AUD - Australian Dollar"})]})]})]})]})}),d.jsx(Ce,{delay:.3,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 rounded-lg bg-accent-500/20 text-accent-400 mr-4",children:d.jsx(P,{className:"w-6 h-6"})}),d.jsx("h3",{className:"text-xl font-semibold text-white",children:"Hardware Settings"})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-dark-700/30 border border-dark-600/50",children:[d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(u,{className:"w-5 h-5 text-primary-400"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-medium",children:"Barcode Scanner"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Enable camera-based barcode scanning"})]})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:e.barcode_scanner_enabled,onChange:e=>m("barcode_scanner_enabled",e.target.checked),className:"sr-only peer"}),d.jsx("div",{className:"w-11 h-6 bg-dark-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"})]})]}),d.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-dark-700/30 border border-dark-600/50",children:[d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(P,{className:"w-5 h-5 text-primary-400"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-medium",children:"Auto-Print Receipts"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Automatically print receipts after payment"})]})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:e.auto_print_receipt,onChange:e=>m("auto_print_receipt",e.target.checked),className:"sr-only peer"}),d.jsx("div",{className:"w-11 h-6 bg-dark-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"})]})]}),d.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-dark-700/30 border border-dark-600/50",children:[d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(P,{className:"w-5 h-5 text-primary-400"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-medium",children:"Thermal Printer"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Enable thermal receipt printer support"})]})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:e.thermal_printer_enabled,onChange:e=>m("thermal_printer_enabled",e.target.checked),className:"sr-only peer"}),d.jsx("div",{className:"w-11 h-6 bg-dark-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"})]})]})]})]})}),d.jsx(Ce,{delay:.4,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 rounded-lg bg-warning-500/20 text-warning-400 mr-4",children:d.jsx(X,{className:"w-6 h-6"})}),d.jsx("h3",{className:"text-xl font-semibold text-white",children:"Receipt Customization"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-base font-medium text-gray-300 mb-3",children:"Receipt Footer Message"}),d.jsx("textarea",{value:e.receipt_footer_message,onChange:e=>m("receipt_footer_message",e.target.value),rows:3,className:"w-full input-dark input-large resize-none",placeholder:"Enter message to appear at bottom of receipts"}),d.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"This message will appear at the bottom of all printed receipts"})]})]})}),d.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"flex justify-end",children:d.jsx(h.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:!o||i,className:"btn-primary flex items-center gap-2 px-8 py-3 "+(o?"":"opacity-50 cursor-not-allowed"),children:i?d.jsxs(d.Fragment,{children:[d.jsx(me,{size:"sm",color:"white"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Z,{className:"w-4 h-4"}),"Save Settings"]})})})]})]}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx(z,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Settings Not Available"}),d.jsx("p",{className:"text-gray-500",children:"Unable to load POS settings"})]})}function Cr(){const[e,t]=q.useState("interface"),r=[{id:"interface",label:"POS Terminal",icon:C},{id:"reports",label:"Sales Reports",icon:Q},{id:"settings",label:"POS Settings",icon:A}];return d.jsxs("div",{className:"space-y-6",children:[d.jsxs(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gradient",children:"Point of Sale"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Professional retail and billing system"})]}),d.jsx("div",{className:"flex bg-dark-700/50 rounded-xl p-1 border border-dark-600/50",children:r.map((r,n)=>d.jsxs(h.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t(r.id),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 "+(e===r.id?"bg-primary-600 text-white shadow-glow":"text-gray-300 hover:text-white hover:bg-dark-600/50"),children:[d.jsx(r.icon,{className:"w-4 h-4"}),d.jsx("span",{className:"hidden sm:inline",children:r.label})]},r.id))})]}),d.jsxs(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:["interface"===e&&d.jsx(pr,{}),"reports"===e&&d.jsx(wr,{}),"settings"===e&&d.jsx(Ar,{})]},e)]})}ur.displayName="EnhancedReceiptGenerator";export{Cr as default};
