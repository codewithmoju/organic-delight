var e=(e,a,s)=>new Promise((r,i)=>{var t=e=>{try{n(s.next(e))}catch(a){i(a)}},l=e=>{try{n(s.throw(e))}catch(a){i(a)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(t,l);n((s=s.apply(e,a)).next())});import{j as a,m as s,R as r,n as i,t,u as l,k as n}from"./ui-vendor-xs3J0kw7.js";import{r as c}from"./react-vendor-BVrHFBWf.js";import{d as o,L as d}from"./router-vendor-DDng8bu2.js";import{u}from"./utils-vendor-DglL0U6P.js";import{p as m,u as x,d as f,f as y}from"./firebase-vendor-Xl_GeJX1.js";import{c as p,d as h,L as j,b as v}from"./index-CKK7GlfE.js";import"./capacitor-vendor-Be0kW8mJ.js";function g(){const[g]=o(),[b,w]=c.useState("loading"),[N,k]=c.useState(!1),[E,V]=c.useState(!0),[P,L]=c.useState(0),S=g.get("oobCode"),T=g.get("mode");c.useEffect(()=>{"verifyEmail"===T&&S?U():w("error")},[S,T]),c.useEffect(()=>{let e;return P>0?e=setTimeout(()=>L(P-1),1e3):0!==P||E||V(!0),()=>clearTimeout(e)},[P,E]);const U=()=>e(this,null,function*(){try{yield m(p,S),p.currentUser&&(yield x(f(h,"profiles",p.currentUser.uid),{emailVerified:!0,updated_at:new Date})),w("success"),u.success("Email verified successfully!")}catch(e){"auth/expired-action-code"===e.code?w("expired"):(e.code,w("error"))}});return a.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-dark-950 via-dark-900 to-dark-950 px-4 sm:px-6 lg:px-8 relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-primary-500/10 rounded-full blur-3xl"}),a.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-accent-500/10 rounded-full blur-3xl"})]}),a.jsx(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"w-full max-w-lg relative z-10",children:a.jsx("div",{className:"glass-effect p-8 lg:p-10 rounded-2xl border border-dark-700/50 shadow-dark-lg",children:a.jsxs("div",{className:"text-center",children:[a.jsx(j,{size:"lg",animated:!0}),a.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-8 mb-6",children:(()=>{switch(b){case"loading":return a.jsx(v,{size:"lg",color:"primary"});case"success":return a.jsx(n,{className:"h-16 w-16 text-success-400"});case"error":case"expired":return a.jsx(l,{className:"h-16 w-16 text-error-400"});default:return a.jsx(t,{className:"h-16 w-16 text-primary-400"})}})()}),a.jsx(s.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-3xl lg:text-4xl font-bold text-white mb-4",children:(()=>{switch(b){case"loading":return"Verifying your email...";case"success":return"Email Verified!";case"expired":return"Verification Link Expired";case"error":return"Verification Failed";default:return"Email Verification"}})()}),a.jsx(s.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-gray-400 text-lg mb-8",children:(()=>{switch(b){case"loading":return"Please wait while we verify your email address.";case"success":return"Your email has been successfully verified. You can now access all features of your account.";case"expired":return"The verification link has expired. Please request a new verification email.";case"error":return"We couldn't verify your email address. The link may be invalid or already used.";default:return""}})()}),a.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"space-y-4",children:["success"===b&&a.jsx(d,{to:"/login",className:"btn-primary w-full flex items-center justify-center gap-2 py-4 text-lg font-semibold",children:"Continue to Login"}),("expired"===b||"error"===b)&&p.currentUser&&a.jsx(s.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e(this,null,function*(){if(p.currentUser&&E){k(!0);try{yield y(p.currentUser),u.success("Verification email sent! Please check your inbox."),V(!1),L(60)}catch(e){u.error("Failed to send verification email. Please try again.")}finally{k(!1)}}}),disabled:N||!E,className:"btn-primary w-full flex items-center justify-center gap-2 py-4 text-lg font-semibold",children:N?a.jsxs(a.Fragment,{children:[a.jsx(v,{size:"sm",color:"white"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(r,{className:"h-4 w-4"}),E?"Resend Verification Email":`Resend in ${P}s`]})}),a.jsxs(d,{to:"/login",className:"btn-secondary w-full flex items-center justify-center gap-2 py-4 text-lg font-semibold",children:[a.jsx(i,{className:"h-4 w-4"}),"Back to Login"]})]}),("expired"===b||"error"===b)&&a.jsxs(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-8 p-4 bg-dark-800/50 rounded-xl border border-dark-700/50",children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"Need Help?"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"If you continue to have issues with email verification, please contact our support team."})]})]})})})]})}export{g as default};
