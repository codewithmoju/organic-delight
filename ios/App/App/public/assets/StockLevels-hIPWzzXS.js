import{j as e,m as t,c as a,D as s,P as r}from"./ui-vendor-xs3J0kw7.js";import{r as i}from"./react-vendor-BVrHFBWf.js";import{u as l}from"./utils-vendor-DglL0U6P.js";import{b as n}from"./dashboard-D4Cue7Qt.js";import{A as o}from"./AnimatedCard-D-urSkxU.js";import{S as c}from"./SearchInput-BK77MnJj.js";import{f as d,a as m}from"./notifications-tOheaLyS.js";import{C as u}from"./ContextualLoader-DUjmIhSg.js";import"./capacitor-vendor-Be0kW8mJ.js";import"./firebase-vendor-Xl_GeJX1.js";import"./index-CKK7GlfE.js";import"./router-vendor-DDng8bu2.js";function x(){const[x,v]=i.useState([]),[h,p]=i.useState([]),[y,j]=i.useState(!0),[g,f]=i.useState(""),[N,b]=i.useState("name");return i.useEffect(()=>{!function(){return e=this,t=null,a=function*(){try{const e=yield n();v(e)}catch(e){l.error("Failed to load stock levels")}finally{j(!1)}},new Promise((s,r)=>{var i=e=>{try{n(a.next(e))}catch(t){r(t)}},l=e=>{try{n(a.throw(e))}catch(t){r(t)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,l);n((a=a.apply(e,t)).next())});var e,t,a}()},[]),i.useEffect(()=>{!function(){let e=x;g&&(e=e.filter(e=>{var t,a,s;return(null==(t=e.item)?void 0:t.name.toLowerCase().includes(g.toLowerCase()))||(null==(s=null==(a=e.item)?void 0:a.category)?void 0:s.name.toLowerCase().includes(g.toLowerCase()))}));e.sort((e,t)=>{var a,s;switch(N){case"name":return((null==(a=e.item)?void 0:a.name)||"").localeCompare((null==(s=t.item)?void 0:s.name)||"");case"quantity":return t.current_quantity-e.current_quantity;case"value":return t.total_value-e.total_value;case"date":const r=new Date(e.last_transaction_date.toDate?e.last_transaction_date.toDate():e.last_transaction_date);return new Date(t.last_transaction_date.toDate?t.last_transaction_date.toDate():t.last_transaction_date).getTime()-r.getTime();default:return 0}}),p(e)}()},[x,g,N]),e.jsxs("div",{className:"relative",children:[e.jsx(u,{isLoading:y,context:"dashboard",variant:"overlay"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gradient",children:"Stock Levels"}),e.jsx("p",{className:"text-gray-400 mt-1 text-sm sm:text-base",children:"Real-time inventory levels calculated from transaction history"})]})}),e.jsx(o,{delay:.1,children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(c,{placeholder:"Search items by name or category...",value:g,onChange:f,className:"w-full"})}),e.jsx("div",{children:e.jsxs("select",{value:N,onChange:e=>b(e.target.value),className:"w-full input-dark",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"quantity",children:"Sort by Quantity"}),e.jsx("option",{value:"value",children:"Sort by Total Value"}),e.jsx("option",{value:"date",children:"Sort by Last Transaction"})]})})]})})}),e.jsx(t.div,{layout:!0,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:e.jsx(a,{children:h.map((a,r)=>{var i,l,n;return e.jsxs(t.div,{layout:!0,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{delay:.05*r},whileHover:{y:-8,scale:1.03},className:"card-dark p-4 sm:p-6 group cursor-pointer relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-500/5 to-accent-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute top-4 right-4 w-3 h-3 rounded-full "+(0===a.current_quantity?"bg-error-500":a.current_quantity<10?"bg-warning-500":"bg-success-500")}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white group-hover:text-primary-300 transition-colors duration-200 truncate",children:null==(i=a.item)?void 0:i.name}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mt-1 truncate",children:(null==(n=null==(l=a.item)?void 0:l.category)?void 0:n.name)||"Uncategorized"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Current Stock"}),e.jsx("span",{className:"font-semibold text-lg "+(0===a.current_quantity?"text-error-400":a.current_quantity<10?"text-warning-400":"text-success-400"),children:a.current_quantity})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Avg. Unit Cost"}),e.jsx("span",{className:"text-white font-semibold",children:d(a.average_unit_cost)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Value"}),e.jsx("span",{className:"text-primary-400 font-semibold",children:d(a.total_value)})]}),e.jsx("div",{className:"pt-2 border-t border-dark-700/50",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(s,{className:"w-3 h-3 mr-1"}),"Last updated: ",m(a.last_transaction_date)]})})]})]})]},a.item_id)})})}),0===h.length&&!y&&e.jsxs(t.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center py-12 sm:py-16 px-4",children:[e.jsx(r,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-400 mb-2",children:"No stock data found"}),e.jsx("p",{className:"text-gray-500 mb-6 text-sm sm:text-base",children:g?"Try adjusting your search criteria":"Stock levels will appear here after recording transactions"})]})]})]})}function v(){return e.jsx(x,{})}export{v as default};
